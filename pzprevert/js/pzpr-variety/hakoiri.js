/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["hakoiri","tontonbeya","alter"],{MouseEvent:{inputModes:{edit:["mark-circle","mark-triangle","mark-rect","clear","border"],play:["mark-circle","mark-triangle","mark-rect","objblank","clear"]},mouseinput_other:function(){if("tontonbeya"===this.pid||this.mousestart)switch(this.inputMode){case"copysymbol":this.dragnumber_tontonbeya();break;case"mark-circle":this.inputFixedNumber(1);break;case"mark-triangle":this.inputFixedNumber(2);break;case"mark-rect":this.inputFixedNumber(3)}},mouseinput_auto:function(){this.puzzle.playmode?"left"===this.btn?(this.mousestart||this.mousemove)&&this.dragDots():"right"===this.btn&&this.mousemove&&this.inputDot():this.puzzle.editmode&&(this.mousestart||this.mousemove)&&this.inputborder(),this.mouseend&&this.notInputted()&&(this.mouseCell=null,this.inputqnum())},dragDots:function(){var e=this.getcell();if(!e.isnull&&e!==this.mouseCell&&-1===e.qnum){if(this.mouseCell.isnull)return-1!==e.anum?void 0:(this.inputData=1===e.qsub?-2:10,void(this.mouseCell=e));-2===this.inputData?(e.setAnum(-1),e.setQsub(1)):10===this.inputData&&(e.setAnum(-1),e.setQsub(0)),(this.mouseCell=e).draw()}},inputDot:function(){var e=this.getcell();e.isnull||e===this.mouseCell||-1!==e.qnum||(null===this.inputData&&(this.inputData=1===e.qsub?0:1),e.setAnum(-1),e.setQsub(1===this.inputData?1:0),(this.mouseCell=e).draw())}},"MouseEvent@tontonbeya":{inputModes:{edit:["mark-circle","mark-triangle","mark-rect","clear","border"],play:["mark-circle","mark-triangle","mark-rect","copysymbol","clear"]},mouseinput_auto:function(){this.puzzle.playmode&&(this.mousestart||this.mousemove)&&"left"===this.btn&&this.dragnumber_tontonbeya(),this.puzzle.editmode&&this.mousemove&&this.inputborder(),this.mouseend&&this.notInputted()&&(this.mouseCell=this.board.emptycell,this.inputqnum())},dragnumber_tontonbeya:function(){var e=this.getcell();if(!e.isnull&&e!==this.mouseCell)if(null===this.inputData){if(this.inputData=e.getNum(),-1===this.inputData)for(var t=0;t<4;t++)-1!==e.snum[t]&&(this.inputData=e.snum);this.mouseCell=e}else{if(null!==this.inputData&&"object"==typeof this.inputData&&-1===e.qnum){for(t=0;t<4;t++)e.setSnum(t,this.inputData[t]);e.draw()}else-1<=this.inputData&&-1===e.qnum&&(e.clrSnum(),e.setAnum(this.inputData),e.draw());this.mouseCell=e}}},KeyEvent:{enablemake:!0,enableplay:!0,keyinput:function(e){this.key_hakoiri(e)},key_hakoiri:function(e){"1"===e||"q"===e||"a"===e||"z"===e?e="1":"2"===e||"w"===e||"s"===e||"x"===e?e="2":"3"===e||"e"===e||"d"===e||"c"===e?e="3":"4"===e||"r"===e||"f"===e||"v"===e?e="tontonbeya"===this.pid?" ":"s1":"5"!==e&&"t"!==e&&"g"!==e&&"b"!==e||(e=" "),this.key_inputqnum(e)}},Cell:{numberAsObject:!0,enableSubNumberArray:!0,maxnum:3},"Cell@tontonbeya":{numberAsObject:!1},Board:{hasborder:1},"AreaNumberGraph@hakoiri,tontonbeya":{enabled:!0},"AreaNumberGraph@tontonbeya#1":{relation:{"cell.qnum":"node","cell.anum":"node","border.ques":"separator"},isedgevalidbylinkobj:function(e){return!e.isBorder()},isedgevalidbynodeobj:function(e,t){return e.getNum()===t.getNum()&&this.isedgevalidbylinkobj(this.board.getb(e.bx+t.bx>>1,e.by+t.by>>1))}},AreaRoomGraph:{enabled:!0},Graphic:{enablebcolor:!0,paint:function(){this.drawBGCells(),this.drawTargetSubNumber(),this.drawGrid(),this.drawBorders(),this.drawDotCells(),this.drawQnumMarks(),this.drawHatenas(),this.drawSubNumbers(),this.drawChassis(),this.drawCursor()},getNumberTextCore:function(e){return 0<e?"○△◻"[e-1]:null},drawQnumMarks:function(){for(var e=this.vinc("cell_mark","auto"),t=(e.lineWidth=Math.max(this.cw/18,2),.3*this.cw),n=.26*this.cw,i=this.range.cells,s=0;s<i.length;s++){var r=i[s],o=(e.vid="c_mk_"+r.id,e.strokeStyle=-1!==r.qnum?this.getQuesNumberColor(r):1===this.isSameSymbol(r.getNum(),[1,2,3],r.qansBySolver,[1,2,3])?this.solverqanscolor:this.getAnsNumberColor(r),r.bx*this.bw),a=r.by*this.bh;switch(r.getNum()){case 1:e.strokeCircle(o,a,t);break;case 2:e.beginPath(),e.setOffsetLinePath(o,a,0,-n,-t,n,t,n,!0),e.stroke();break;case 3:e.strokeRectCenter(o,a,t,t);break;default:e.vhide()}switch(e.vid="c_mk_solver"+r.id,e.strokeStyle=1===this.isSameSymbol(r.getNum(),[1,2,3],r.qansBySolver,[1,2,3])?this.solverqanscolor:this.solvercolor,r.qansBySolver){case 1:e.strokeCircle(o,a,t);break;case 2:e.beginPath(),e.setOffsetLinePath(o,a,0,-n,-t,n,t,n,!0),e.stroke();break;case 3:e.strokeRectCenter(o,a,t,t);break;default:e.vhide()}}}},"Graphic@tontonbeya":{enablebcolor:!1},Encode:{decodePzpr:function(e){this.decodeBorder(),this.decodeNumber10()},encodePzpr:function(e){this.encodeBorder(),this.encodeNumber10()}},FileIO:{decodeData:function(){this.decodeAreaRoom(),this.decodeCellQnum(),this.decodeCellAnumsub()},encodeData:function(){this.encodeAreaRoom(),this.encodeCellQnum(),this.encodeCellAnumsub()}},AnsCheck:{checklist:["checkAroundMarks@hakoiri","checkThreeTypesInLine@alter","checkOverFourMarksInBox","checkDifferentNumberInRoom","checkAlternatingLines@alter","checkConnectNumber@hakoiri","checkAllMarkInBox","checkNoTypesInLine@alter"],checkOverFourMarksInBox:function(){this.checkAllBlock(this.board.roommgr,function(e){return e.isNum()},function(e,t,n,i){return n<=3},"bkNumGt3")},checkAllMarkInBox:function(){this.checkAllBlock(this.board.roommgr,function(e){return e.isNum()},function(e,t,n,i){return 3<=n},"bkNumLt3")},checkAroundMarks:function(){this.checkAroundCell(function(e,t){return 0<=e.getNum()&&e.getNum()===t.getNum()},"nmAround")},checkAlternatingLines:function(){var s=this.board,r=!1;this.checkRowsCols(function(e){for(var t=null,n=0;n<e.length;n++){var i=e[n];if(i.isNum()){if(t&&t.getNum()===i.getNum()){if(this.checkOnly)return!1;r=!0,s.cellinside(t.bx,t.by,i.bx,i.by).seterr(1)}t=i}}return!0},"nmDupRow"),r&&this.failcode.add("nmDupRow")},checkThreeTypesInLine:function(){this.checkRowsCols(function(e){var t=[!1,!1,!1];return e.each(function(e){e=e.getNum();1<=e&&e<=3&&(t[e-1]=!0)}),!(t[0]&&t[1]&&t[2])||(e.seterr(1),!1)},"nmTripRow")},checkNoTypesInLine:function(){this.checkRowsCols(function(e){return!(e.filter(function(e){return e.isNum()}).length<2)||(e.seterr(1),!1)},"nmMissRow")}},"AnsCheck@tontonbeya":{checklist:["checkMultiAdjacent","checkDividedSymbol","checkEqualSize","checkNoAdjacent","checkNoNumCell+"],checkMultiAdjacent:function(){this.createAdjacent();for(var e=this.board.nblkmgr.components,t=0;t<e.length;t++)if(!1===e[t].adjacent){if(this.failcode.add("nmAdjacentGt2"),this.checkOnly)return;e[t].clist.seterr(1)}},checkNoAdjacent:function(){this.createAdjacent();for(var e=this.board.nblkmgr.components,t=0;t<e.length;t++)if(null===e[t].adjacent){if(this.failcode.add("nmAdjacentLt2"),this.checkOnly)return;e[t].clist.seterr(1)}},checkDividedSymbol:function(){this.createUnits();for(var e=this.board.roommgr.components,t=0;t<e.length;t++)for(var n=e[t],i=1;i<=3;i++)if(!1===n.units[i]){if(this.failcode.add("nmDivide"),this.checkOnly)return;n.clist.filter(function(e){return e.getNum()===i}).seterr(1)}},checkEqualSize:function(){this.createUnits();for(var e=this.board.roommgr.components,t=0;t<e.length;t++){for(var n=e[t],i=0,s=1;s<=3;s++){var r=n.units[s];r&&(0===i?i=r.clist.length:i!==r.clist.length&&(i=-1))}if(-1===i){if(this.failcode.add("nmSizeNe"),this.checkOnly)return;n.clist.seterr(1)}}},createUnits:function(){if(!this._info.hasUnits){for(var e=this.board.roommgr.components,t=0;t<e.length;t++)e[t].units={};var n=new Set;this.board.cell.each(function(e){e.nblk&&n.add(e.nblk)}),n.forEach(function(e){var t=e.clist[0],n=t.room,t=t.getNum()+"";t in n.units?n.units[t]=!1:n.units[t]=e}),this._info.hasUnits=!0}},createAdjacent:function(){if(!this._info.hasAdjacent){for(var e=this.board.nblkmgr.components,t=0;t<e.length;t++)e[t].adjacent=null;this.board.border.each(function(e){var t=e.sidecell[0],e=e.sidecell[1],n=t.nblk,i=e.nblk,s=t.room,r=e.room;n&&i&&s!==r&&t.getNum()===e.getNum()&&(null===n.adjacent?n.adjacent=r:n.adjacent!==r&&(n.adjacent=!1),null===i.adjacent?i.adjacent=s:i.adjacent!==s&&(i.adjacent=!1))}),this._info.hasAdjacent=!0}}}});
//# sourceMappingURL=hakoiri.js.map