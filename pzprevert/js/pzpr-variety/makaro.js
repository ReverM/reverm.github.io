/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["makaro"],{MouseEvent:{inputModes:{edit:["border","arrow","number","clear"],play:["number","clear"]},mouseinput_auto:function(){this.puzzle.playmode?this.mousestart&&this.inputqnum():this.puzzle.editmode&&(this.mousestart||this.mousemove?this.isBorderMode()?this.inputborder():this.inputarrow_cell():this.mouseend&&this.notInputted()&&this.inputqnum())},inputarrow_cell_main:function(e,t){e.setQnum(-1),e.setAnum(-1),e.qdir!==t?(e.setQdir(t),e.setQues(1)):(e.setQdir(e.NDIR),e.setQues(0))},inputqnum_main:function(e){this.puzzle.editmode&&this.inputshade_preqnum(e)||1!==e.ques&&this.common.inputqnum_main.call(this,e)},inputshade_preqnum:function(e){var t=null;return 1===e.ques&&e.qdir!==e.NDIR?t=-3:1===e.ques&&e.qdir===e.NDIR?"left"===this.btn?t=-2:"right"===this.btn&&(t=-1):0===e.ques&&-1===e.qnum?"left"===this.btn&&(t=-3):-2===e.qnum&&"right"===this.btn&&(t=-3),-3===t?(e.setQues(1),e.setQdir(e.NDIR),e.setQnum(-1),e.setAnum(-1),e.draw()):-1===t?(e.setQues(0),e.setQdir(e.NDIR),e.setQnum(-1),e.setAnum(-1),e.draw()):-2===t&&(e.setQues(0),e.setQdir(e.NDIR),e.setQnum(-2),e.setAnum(-1),e.draw()),null!==t}},KeyEvent:{enablemake:!0,enableplay:!0,moveTarget:function(e){return!e.match(/shift/)&&this.moveTCell(e)},keyinput:function(e){var t=this.cursor.getc();this.puzzle.editmode&&this.key_inputcell_makaro_edit(t,e)||1!==t.ques&&this.key_inputqnum(e)},key_inputcell_makaro_edit:function(e,t){var r=!1;return" "===t?(e.setQues(0),e.setQdir(e.NDIR),e.setQnum(-1),e.setAnum(-1),r=!0):"BS"===t&&1===e.ques?(e.qdir!==e.NDIR?e.setQdir(e.NDIR):(e.setQues(0),e.setQnum(-1),e.setAnum(-1)),r=!0):"-"===t?(e.setQues(0===e.ques?1:0),e.setQdir(e.NDIR),e.setQnum(-1),e.setAnum(-1),r=!0):this.key_inputarrow(t)&&(e.setQues(1),e.setQnum(-1),e.setAnum(-1),r=!0),r&&e.draw(),r}},Cell:{enableSubNumberArray:!0,maxnum:function(){return Math.min(99,this.room.clist.length)}},Border:{isBorder:function(){return this.isnull||0<this.ques||!(1!==this.sidecell[0].ques&&1!==this.sidecell[1].ques)}},Board:{hasborder:1},BoardExec:{adjustBoardData:function(e,t){this.adjustCellArrow(e,t)}},AreaRoomGraph:{enabled:!0,isnodevalid:function(e){return 0===e.ques}},Graphic:{gridcolor_type:"LIGHT",paint:function(){this.drawBGCells(),this.drawTargetSubNumber(),this.drawGrid(),this.drawQuesCells(),this.drawCellArrows(),this.drawSubNumbers(),this.drawAnsNumbers(),this.drawQuesNumbers(),this.drawBorders(),this.drawChassis(),this.drawCursor()},getCellArrowColor:function(e){return 0!==e.qdir?"white":null}},Encode:{decodePzpr:function(e){this.decodeBorder(),this.decodeMakaro()},encodePzpr:function(e){this.encodeBorder_makaro(),this.encodeMakaro()},decodeMakaro:function(){for(var e=0,t=0,r=this.outbstr,s=this.board,t=0;t<r.length;t++){var i=r.charAt(t),n=s.cell[e];if(this.include(i,"0","9")?n.qnum=parseInt(i,10)+1:"-"===i?(n.qnum=parseInt(r.substr(t+1,2),10)+1,t+=2):"a"<=i&&i<="e"?(n.ques=1,n.qdir=parseInt(i,36)-10):"g"<=i&&i<="z"&&(e+=parseInt(i,36)-16),e++,!s.cell[e])break}this.outbstr=r.substr(t+1)},encodeMakaro:function(){for(var e="",t=0,r=this.board,s=0;s<r.cell.length;s++){var i="",n=r.cell[s],u=n.qnum;1<=u&&u<11?i=(u-1).toString(10):11<=u&&u<100?i="-"+(u-1).toString(10):1===n.ques?i=(n.qdir+10).toString(36):t++,0===t?e+=i:!i&&20!==t||(e+=(t+15).toString(36)+i,t=0)}0<t&&(e+=(t+15).toString(36)),this.outbstr+=e},encodeBorder_makaro:function(){for(var e=this.board,t=[],r=0;r<e.border.length;r++)t[r]=e.border[r].ques,e.border[r].ques=e.border[r].isBorder()?1:0;this.encodeBorder();for(r=0;r<e.border.length;r++)e.border[r].ques=t[r]}},FileIO:{decodeData:function(){this.decodeAreaRoom(),this.decodeCellQuesData_makaro(),this.decodeCellAnumsub()},encodeData:function(){this.encodeAreaRoom(),this.encodeCellQuesData_makaro(),this.encodeCellAnumsub()},decodeCellQuesData_makaro:function(){this.decodeCell(function(e,t){"t"===t?(e.ques=1,e.qdir=1):"b"===t?(e.ques=1,e.qdir=2):"l"===t?(e.ques=1,e.qdir=3):"r"===t?(e.ques=1,e.qdir=4):"#"===t?(e.ques=1,e.qdir=0):"-"===t?e.qnum=-2:"."!==t&&(e.qnum=+t)})},encodeCellQuesData_makaro:function(){this.encodeCell(function(e){return 1===e.ques?1===e.qdir?"t ":2===e.qdir?"b ":3===e.qdir?"l ":4===e.qdir?"r ":"# ":0<=e.qnum?e.qnum+" ":-2===e.qnum?"- ":". "})}},AnsCheck:{checklist:["checkDifferentNumberInRoom","checkAdjacentDiffNumber","checkPointAtBiggestNumber","checkNoNumCell+"],checkPointAtBiggestNumber:function(){for(var e=0;e<this.board.cell.length;e++){var t=this.board.cell[e];if(1===t.ques&&t.qdir!==t.NDIR){for(var r=t.getdir4clist(),s=-1,i=t.NDIR,n=!1,u=!1,o=!0,d=0;d<r.length;d++){var a=r[d][0].getNum();-1!==a&&(s<a?(s=a,i=r[d][1],n=!1):a===s&&(i=t.NDIR,n=!0)),r[d][1]===t.qdir&&(0===r[d][0].ques&&(o=!1),-1===a&&(u=!0))}if(o||!u&&(n||t.qdir!==i)){if(this.failcode.add("arNotMax"),this.checkOnly)break;t.seterr(1);for(d=0;d<r.length;d++)-1!==r[d][0].getNum()&&r[d][0].seterr(1)}}}}}});
//# sourceMappingURL=makaro.js.map