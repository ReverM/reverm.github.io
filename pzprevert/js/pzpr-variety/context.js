/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["context","smullyan"],{MouseEvent:{RBShadeCell:!0,use:!0,inputModes:{edit:["number","clear"],play:["shade","unshade","peke","info-blk"]},autoedit_func:"qnum",autoplay_func:"cellpeke"},KeyEvent:{enablemake:!0},Cell:{minnum:0,maxnum:4},"Cell@smullyan":{maxnum:9},Board:{hasborder:1},AreaUnshadeGraph:{enabled:!0},Graphic:{enablebcolor:!0,bgcellcolor_func:"qsub1",fontsizeratio:.75,fontShadecolor:"rgb(192,192,192)",paint:function(){this.drawBGCells(),this.drawDashedGrid(),this.drawShadedCells(),this.drawQuesNumbers(),"context"===this.pid&&(this.drawShadeTicks(),this.drawUnshadeTicks()),this.drawChassis(),this.drawPekes(),this.drawTarget()},drawShadeTicks:function(){var e=this.vinc("cell_ticks","auto"),t=(e.lineWidth=1+this.cw/40|0,.15*this.cw);t<3&&(t=3);for(var i=0;i<this.board.cell.length;i++){var n=this.board.cell[i];if(!this.puzzle.getConfig("context_marks")||n.qnum<0||!n.isShade())for(var h=0;h<4;h++)e.vid="st_cell"+h+"_"+n.id,e.vhide();else for(var s=n.bx,l=n.by,a=s*this.bw,c=l*this.bh,s=this.fontShadecolor,d=(e.strokeStyle=s,[[1,1],[-1,1],[1,-1],[-1,-1]]),o=0;o<d.length;o++){e.vid="st_cell"+o+"_"+n.id;var r=d[o][0],u=d[o][1],b=[a+r*this.bw-1.5*r*t,c+u*this.bh-.5*u*t],m=[a+r*this.bw-.5*r*t,c+u*this.bh-.5*u*t],r=[a+r*this.bw-.5*r*t,c+u*this.bh-1.5*u*t];e.beginPath(),e.moveTo(b[0],b[1]),e.lineTo(m[0],m[1]),e.lineTo(r[0],r[1]),e.moveTo(m[0],m[1]),e.closePath(),e.stroke()}}},drawUnshadeTicks:function(){var e=this.vinc("cell_ticks","auto"),t=(e.lineWidth=1+this.cw/40|0,.15*this.cw);t<3&&(t=3);for(var i=0;i<this.board.cell.length;i++){var n=this.board.cell[i];if(!this.puzzle.getConfig("context_marks")||n.qnum<0||n.isShade()||n.qsub<=0)for(var h=0;h<4;h++)e.vid="ut_cell"+h+"_"+n.id,e.vhide();else for(var s=n.bx,l=n.by,a=s*this.bw,c=l*this.bh,d=(e.strokeStyle="rgb(96,96,96)",[[1,0],[-1,0],[1,1],[-1,1]]),o=0;o<d.length;o++){e.vid="ut_cell"+o+"_"+n.id;var r=d[o][0],u=d[o][1],b=u?c:a,m=u?a:c,f=[b+r*this.bw-+r*t,m+t],k=[b+r*this.bw-.5*r*t,m],b=[b+r*this.bw-+r*t,m-t];e.beginPath(),e.moveTo(f[+!!u],f[+!u]),e.lineTo(k[+!!u],k[+!u]),e.lineTo(b[+!!u],b[+!u]),e.moveTo(k[+!!u],k[+!u]),e.closePath(),e.stroke()}}}},Encode:{decodePzpr:function(e){this.decodeNumber16()},encodePzpr:function(e){this.encodeNumber16()}},FileIO:{decodeData:function(){this.decodeCellQnum(),this.decodeCellAns(),this.decodeBorderLine()},encodeData:function(){this.encodeCellQnum(),this.encodeCellAns(),this.encodeBorderLineIfPresent()}},AnsCheck:{checklist:["checkShadeCellExist","checkAdjacentShadeCell","checkConnectUnshadeRB","checkShadeCountDiag@context","checkUnshadeCountAdj@context","checkShadeAdjacent@smullyan","checkUnshadeAdjacent@smullyan","doneShadingDecided"],checkShadeCountDiag:function(){this.checkAllCell(function(e){return 0<=e.qnum&&e.isShade()&&e.relobj(-2,-2).isShade()+e.relobj(-2,2).isShade()+e.relobj(2,-2).isShade()+e.relobj(2,2).isShade()!==e.qnum},"nmShadeDiagNe")},checkUnshadeCountAdj:function(){this.checkAllCell(function(e){return 0<=e.qnum&&!e.isShade()&&e.relobj(-2,0).isShade()+e.relobj(2,0).isShade()+e.relobj(0,-2).isShade()+e.relobj(0,2).isShade()!==e.qnum},"nmUnshadeAdjNe")}},"AnsCheck@smullyan":{checkUnshadeAdjacent:function(){this.checkAllCounts(!1,"nmShadeGt")},checkShadeAdjacent:function(){this.checkAllCounts(!0,"nmShadeEq")},checkAllCounts:function(i,e){this.checkAllCell(function(e){if(!e.isValidNum())return!1;if(i!==e.isShade())return!1;var t=e.board.cellinside(e.bx-2,e.by-2,e.bx+2,e.by+2).filter(function(e){return e.isShade()}).length;return i===(t===e.getNum())},e)}}});
//# sourceMappingURL=context.js.map