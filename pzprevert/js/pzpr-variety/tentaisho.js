/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["tentaisho","nuriuzu"],{MouseEvent:{inputModes:{edit:["circle-unshade","circle-shade","bgpaint","empty"],play:["border","subline"]},mouseinput_other:function(){"bgpaint"===this.inputMode&&this.inputBGcolor1()},mouseinput_auto:function(){this.puzzle.playmode?this.mousestart||this.mousemove?"left"===this.btn&&this.isBorderMode()?this.inputborder_tentaisho():this.inputQsubLine():this.mouseend&&this.notInputted()&&this.inputBGcolor3():this.puzzle.editmode&&(this.mousestart&&"left"===this.btn?this.inputdot():(this.mousestart||this.mousemove)&&"right"===this.btn&&this.inputBGcolor1())},inputBGcolor1:function(){var e=this.getcell();e.isnull||e===this.mouseCell||(null===this.inputData&&(this.inputData=0===e.qsub?3:0),e.setQsub(this.inputData),(this.mouseCell=e).draw())},inputBGcolor3:function(){var e;!this.puzzle.playeronly&&this.puzzle.getConfig("discolor")||null!==(e=this.getpos(.34).getDot())&&0!==e.getDot()&&null!==(e=e.validcell())&&(e=e.room.clist).encolor()&&e.draw()},inputborder_tentaisho:function(){var e,t=this.getpos(.34);this.prevPos.equals(t)||((e=this.prevPos.getborderobj(t)).isnull||(null===this.inputData&&(this.inputData=0===e.qans?1:0),e.setQans(this.inputData),e.draw()),this.prevPos=t)},inputFixedNumber:function(){this.inputdot()},inputdot:function(){var e=this.getpos(.25);if(!this.prevPos.equals(e)){var t=e.getDot();if(null!==t){if("circle-unshade"===this.inputMode||1===t.maxnum)t.setDot(1!==t.getDot()?1:0);else if("circle-shade"===this.inputMode)t.setDot(2!==t.getDot()?2:0);else if("left"===this.btn)t.setDot({0:1,1:2,2:0}[t.getDot()]);else{if("right"!==this.btn)return void(this.prevPos=e);t.setDot({0:2,1:0,2:1}[t.getDot()])}t.draw()}this.prevPos=e}}},"MouseEvent@nuriuzu":{use:!0,inputModes:{edit:["circle-unshade"],play:["shade","unshade"]},mouseinput_auto:function(){this.puzzle.playmode?(this.mousestart||this.mousemove)&&this.inputcell():this.puzzle.editmode&&this.mousestart&&this.inputdot()}},KeyEvent:{enablemake:!0,moveTarget:function(e){return this.moveTBorder(e)},keyinput:function(e){this.key_inputdot(e)},key_inputdot:function(e){var t=this.cursor.getDot();if(null!==t){if("1"===e)t.setDot(1);else if("2"===e&&2===t.maxnum)t.setDot(2);else{if(" "!==e&&"-"!==e&&"0"!==e&&"3"!==e)return;t.setDot(0)}t.draw()}}},Cell:{qnum:0,minnum:0,disInputHatena:!0,isEmpty:function(){return 7===this.ques||this.isShade()},setValid:function(e){this.setQues(e),this.qnum=0;for(var t=[this.adjborder.top,this.adjborder.bottom,this.adjborder.right,this.adjborder.left],i=0;i<t.length;i++){var o=t[i];o.inside&&(o.qnum=0,o.sidecross[0].qnum=0,o.sidecross[1].qnum=0,o.qans=0)}this.drawaround(),this.board.roommgr.rebuild()}},"Cell@nuriuzu":{allowShade:function(){if(this.qnum)return!1;for(var e in this.adjborder)if(this.adjborder[e].qnum)return!1;return!0}},Cross:{qnum:0,minnum:0},Border:{qnum:0,minnum:0,isGrid:function(){return this.sidecell[0].isValid()&&this.sidecell[1].isValid()},isBorder:function(){return 0<this.qans||this.isQuesBorder()},isQuesBorder:function(){return!!(this.sidecell[0].isEmpty()^this.sidecell[1].isEmpty())},isBlack:function(){return this.sidecell[0].isEmpty()||this.sidecell[1].isEmpty()},prehook:{qans:function(){return!this.isGrid()},qsub:function(){return!this.isGrid()}}},Dot:{maxnum:2,setDot:function(e){this.puzzle.opemgr.disCombine=!0,this.piece.setQnum(e),this.puzzle.opemgr.disCombine=!1;e=this.validcell();e&&this.puzzle.board.roommgr.setExtraData(e.room)},validcell:function(){var e=this.piece,t=null;return"cell"===e.group?t=e:"cross"===e.group&&0===e.lcnt?t=e.relcell(-1,-1):"border"===e.group&&0===e.qans&&(t=e.sidecell[0]),t}},"Dot@nuriuzu":{maxnum:1,setDot:function(e){"cross"===this.piece.group&&e||(this.puzzle.opemgr.disCombine=!0,this.piece.setQnum(e),this.puzzle.opemgr.disCombine=!1,(e=this.validcell())&&this.puzzle.board.ublkmgr.setExtraData(e.ublk))},validcell:function(){var e=this.piece,t=null;return"cell"===e.group&&e.isUnshade()?t=e:"border"===e.group&&e.sidecell[0].isUnshade()&&e.sidecell[1].isUnshade()&&(t=e.sidecell[0]),t}},CellList:{encolor:function(){for(var e=this.getAreaDotInfo().dot,t=!1,i=null!==e?e.getDot():0,o=0;o<this.length;o++){var s=this[o];!this.puzzle.playeronly&&3===s.qsub&&2!==i||s.qsub===(0<i?i:0)||(s.setQsub(0<i?i:0),t=!0)}return t},getAreaDotInfo:function(){for(var e={dot:null,err:-1},t=0;t<this.length;t++)for(var i=this[t],o=this.board.dotinside(i.bx,i.by,i.bx+1,i.by+1),s=0;s<o.length;s++){var r=o[s];if(0<r.getDot()&&null!==r.validcell()){if(0===e.err)return{dot:null,err:-2};e={dot:r,err:0}}}return e},subclear:function(){var e=[],t={};0<this.length&&(e=this[0].getproplist(["sub","info"]),t=this[0].propnorec);for(var i=0;i<this.length;i++)for(var o=this[i],s=0;s<e.length;s++){var r=e[s],n=o.constructor.prototype[r];o[r]===n||"qsub"===r&&3===o.qsub||(t[r]||o.addOpe(r,o[r],n),o[r]=n)}}},Board:{hascross:1,hasborder:1,hasdots:1,encolorall:function(){for(var e=this.board.roommgr.components,t=0;t<e.length;t++)e[t].clist.encolor();this.puzzle.redraw()}},"AreaRoomGraph@tentaisho":{enabled:!0,setExtraData:function(e){e.clist=new this.klass.CellList(e.getnodeobjs());var t=e.clist.getAreaDotInfo();e.dot=t.dot,e.error=t.err}},"AreaShadeGraph@nuriuzu":{enabled:!0},"AreaUnshadeGraph@nuriuzu":{enabled:!0,setExtraData:function(e){e.clist=new this.klass.CellList(e.getnodeobjs());var t=e.clist.getAreaDotInfo();e.dot=t.dot,e.error=t.err}},Graphic:{gridcolor_type:"LIGHT",qsubcolor1:"rgb(176,255,176)",qsubcolor2:"rgb(108,108,108)",qanscolor:"rgb(72, 72, 72)",getQuesBorderColor:function(e){return e.isBlack()?this.quescolor:null},getBGCellColor:function(e){return 7===e.ques?"black":this.getBGCellColor_qsub3(e)},paint:function(){this.drawBGCells(),this.drawDashedGrid(),"nuriuzu"===this.pid?this.drawShadedCells():(this.drawQansBorders(),this.drawBorderQsubs()),this.drawQuesBorders(),this.drawDots(),this.drawChassis(),this.drawTarget_tentaisho()},getDotRadius:function(e){return 1===e.getDot()?.16:.18},drawTarget_tentaisho:function(){this.drawCursor(!1,this.puzzle.editmode)}},"Graphic@nuriuzu":{shadecolor:"rgb(108,108,108)",getQuesBorderColor:function(e){return e.isQuesBorder()?this.quescolor:null}},Encode:{decodePzpr:function(e){this.decodeDot(),this.decodeEmpty()},encodePzpr:function(e){this.encodeDot(),this.encodeEmpty()},decodeKanpen:function(){this.fio.decodeStarFile()}},"Encode@nuriuzu":{decodePzpr:function(e){this.puzzle.setConfig("nuriuzu_connect",this.checkpflag("c")),this.decodeDot()},encodePzpr:function(e){this.outpflag=this.puzzle.getConfig("nuriuzu_connect")?"c":null,this.encodeDot()}},FileIO:{decodeData:function(){this.decodeDotFile(),this.decodeBorderAns(),this.decodeCellQsub()},encodeData:function(){this.encodeDotFile(),this.encodeBorderAns(),this.encodeCellQsub()},kanpenOpen:function(){this.decodeDotFile(),this.decodeAnsAreaRoom()},decodeAnsAreaRoom:function(){this.decodeAreaRoom_com(!1)},encodeAnsAreaRoom:function(){this.encodeAreaRoom_com(!1)},kanpenOpenXML:function(){this.decodeStar_XMLBoard(),this.decodeAnsAreaRoom_XMLAnswer()},decodeStar_XMLBoard:function(){for(var e=this.xmldoc.querySelectorAll("board number"),t=0;t<e.length;t++){var i=e[t],o=this.board.getDot(+i.getAttribute("c"),+i.getAttribute("r"));null!==o&&o.setDot(+i.getAttribute("n"))}},decodeAnsAreaRoom_XMLAnswer:function(){var i=[];this.decodeCellXMLArow(function(e,t){"u"===t?i.push(-1):i.push(+t.substr(1))}),this.rdata2Border(!1,i),this.board.roommgr.rebuild()}},"FileIO@nuriuzu":{decodeData:function(){this.decodeConfig(),this.decodeDotFile(),this.decodeCellAns()},encodeData:function(){this.encodeConfig(),this.encodeDotFile(),this.encodeCellAns()},decodeConfig:function(){this.decodeConfigFlag("c","nuriuzu_connect")},encodeConfig:function(){this.encodeConfigFlag("c","nuriuzu_connect")}},AnsCheck:{checklist:["checkStarOnLine","check2x2ShadeCell@nuriuzu","checkAvoidStar","checkFractal","check2x2UnshadeCell@nuriuzu","checkStarRegion","checkConnectShade_nuriuzu@nuriuzu","doneShadingDecided@nuriuzu"],checkStarOnLine:function(){for(var e=this.board,t=0;t<e.dotsmax;t++){var i=e.dots[t];if(!(i.getDot()<=0||null!==i.validcell())){if(this.failcode.add("bdPassStar"),this.checkOnly)break;switch(i.piece.group){case"cross":i.piece.setCrossBorderError();break;case"border":i.piece.seterr(1),new this.klass.CellList(i.piece.sidecell).filter(function(e){return e.isShade()}).seterr(1);break;case"cell":i.piece.seterr(1)}}}},checkFractal:function(){this.checkFractalBase(this.board.roommgr)},checkFractalBase:function(e){var t=e.components;e:for(var i=0;i<t.length;i++){var o=t[i].clist,s=t[i].dot;if(null!==s)for(var r=0;r<o.length;r++){var n=o[r],u=this.board.getc(2*s.bx-n.bx,2*s.by-n.by);if(u.isnull||e.getComponentRefs(n)!==e.getComponentRefs(u)){if(this.failcode.add("bkNotSymSt"),this.checkOnly)break e;o.seterr(1)}}}},checkAvoidStar:function(){this.checkErrorFlag(this.board.roommgr.components,-1,"bkNoStar")},checkStarRegion:function(){this.checkErrorFlag(this.board.roommgr.components,-2,"bkPlStar")},checkErrorFlag:function(e,t,i){for(var o=0;o<e.length;o++)if(e[o].error===t){if(this.failcode.add(i),this.checkOnly)break;e[o].clist.seterr(1)}}},"AnsCheck@nuriuzu":{checkFractal:function(){this.checkFractalBase(this.board.ublkmgr)},checkAvoidStar:function(){this.checkErrorFlag(this.board.ublkmgr.components,-1,"bkNoStar")},checkStarRegion:function(){this.checkErrorFlag(this.board.ublkmgr.components,-2,"bkPlStar")},check2x2UnshadeCell:function(){this.check2x2Block(function(e){return e.isUnshade()&&e.ublk.dot},"cu2x2")},checkConnectShade_nuriuzu:function(){this.puzzle.getConfig("nuriuzu_connect")&&this.checkConnectShade()}}});
//# sourceMappingURL=tentaisho.js.map