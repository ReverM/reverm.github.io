/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(t,e){"object"==typeof module&&module.exports?module.exports=[t,e]:pzpr.classmgr.makeCustom(t,e)}(["guidearrow"],{MouseEvent:{RBShadeCell:!0,use:!0,inputModes:{edit:["info-blk","arrow","clear"],play:["shade","unshade","peke","info-blk"]},autoplay_func:"cellpeke",mouseinputAutoEdit:function(){this.mousestart||this.mousemove?this.inputEdit():this.mouseend&&this.inputEdit_end()},inputEdit:function(){var t=this.getcell();t.isnull||(this.mousestart?this.inputEdit_first():this.draggingSG&&11===this.inputData?(this.board.goalpos.input(t),this.board.isStale=!0):this.inputarrow_cell())},inputEdit_first:function(){var t=this.getcell();this.board.goalpos.equals(t)?(this.inputData=11,this.draggingSG=!0):this.inputarrow_cell()},inputEdit_end:function(){var t=this.getcell();t.isnull||(this.notInputted()&&(t!==this.cursor.getc()?this.setcursor(t):this.draggingSG||this.inputqnum()),this.draggingSG&&(this.draggingSG=!1,t.draw()))},inputarrow_cell_main:function(t,e){t.setQnum(t.qnum!==e?e:-1)},mouseinput_clear:function(){var t=this.getcell();t.isnull||t===this.mouseCell||(this.puzzle.editmode&&t.setQnum(-1),t.setQans(0),t.setQsub(0),t.draw())}},KeyEvent:{enablemake:!0,moveTarget:function(t){return!t.match(/shift/)&&this.moveTCell(t)},keyinput:function(t){var e;if("g"===t)return e=this.cursor.getc(),this.board.goalpos.input(e),e.setQnum(-1),e.draw(),this.prev=e,void(this.cancelDefault=!0);"1"===t||"w"===t||"shift+up"===t?t="1":"2"===t||"s"===t||"shift+right"===t?t="4":"3"===t||"z"===t||"shift+down"===t?t="2":"4"===t||"a"===t||"shift+left"===t?t="3":"5"!==t&&"q"!==t&&" "!==t||(t=" "),this.key_inputqnum(t)}},AreaUnshadeGraph:{enabled:!0},Board:{cols:8,rows:8,hasborder:1,isStale:!0,goalpos:null,createExtraObject:function(){this.goalpos=new this.klass.GoalAddress(1,1)},initExtraObject:function(t,e){this.disableInfo(),this.goalpos.init(1,1),this.enableInfo()},ansclear:function(){return this.isStale=!0,this.common.ansclear.call(this)},buildGoalDirections:function(){if(this.isStale){this.isStale=!1,this.cell.each(function(t){t.actualdir=0});var t,e,i,s=this.goalpos.getc(),o=(s.actualdir=-1,this.cell.filter(function(t){return!t.isShade()}));do{for(e=new this.klass.CellList;t=o.pop();)t.actualdir||1===(i=t.getdir4clist().filter(function(t){t=t[0];return!t.actualdir&&!t.isShade()||t.equals(s)})).length&&(i=i[0][0],e.add(i),t.actualdir=t.getdir(i,2))}while(0<(o=e).length);this.puzzle.redraw()}}},Cell:{maxnum:4,numberAsObject:!0,allowShade:function(){return-1===this.qnum&&!this.board.goalpos.equals(this)},posthook:{qans:function(){this.board.isStale=!0}}},BoardExec:{posinfo:{},adjustBoardData:function(t,e){var i=this.board;i.isStale=!0,this.adjustCellArrow(t,e),this.posinfo_goal=this.getAfterPos(t,e,i.goalpos.getc())},adjustBoardData2:function(t,e){var i=this.board,s=this.puzzle.opemgr,o=this.posinfo_goal,t=t&this.REDUCE&&o.isdel&&!s.undoExec&&!s.redoExec;t&&(s.forceRecord=!0),i.goalpos.set(o.pos.getc()),t&&(s.forceRecord=!1)}},OperationManager:{addExtraOperation:function(){this.operationlist.push(this.klass.StartGoalOperation)}},Graphic:{gridcolor_type:"LIGHT",shadecolor:"#222222",enablebcolor:!0,bgcellcolor_func:"qsub1",paint:function(){this.drawBGCells(),this.drawGrid(),this.drawShadedCells(),this.drawGoalStar(),this.drawCellArrows(!0),this.drawHatenas(),this.drawChassis(),this.drawPekes(),this.drawTarget()},getCellArrowColor:null,getCellArrowOutline:function(t){return-1!==t.qnum?this.quescolor:null},drawGoalStar:function(){var t=this.vinc("cell_sg","auto"),e=this.board,i=this.range,e=e.goalpos.getc();e.bx>=i.x1&&i.x2>=e.bx&&e.by>=i.y1&&i.y2>=e.by&&(t.vid="text_glpos",e.isnull?t.vhide():(t.fillStyle=this.puzzle.mouse.draggingSG?"red":this.quescolor,this.fillStar(t,e.bx*this.bw,e.by*this.bh,.75*this.bw,.75*this.bh)))}},Encode:{decodePzpr:function(t){this.board.goalpos.bx=2*this.decodeOneNumber16()-1,this.board.goalpos.by=2*this.decodeOneNumber16()-1,this.decode4Cell(),this.board.isStale=!0},encodePzpr:function(t){this.outbstr+=this.writeNumber16((this.board.goalpos.bx+1)/2),this.outbstr+=this.writeNumber16((this.board.goalpos.by+1)/2),this.encode4Cell()}},FileIO:{decodeData:function(){this.decodeG(),this.decodeCellQnum(),this.decodeCellAns(),this.decodeBorderLine(),this.board.isStale=!0},encodeData:function(){this.encodeG(),this.encodeCellQnum(),this.encodeCellAns(),this.encodeBorderLineIfPresent()},decodeG:function(){var t=this.readLine().split(" ");this.board.goalpos.bx=parseInt(t[0]),this.board.goalpos.by=parseInt(t[1])},encodeG:function(){this.writeLine(this.board.goalpos.bx+" "+this.board.goalpos.by)}},AnsCheck:{checklist:["checkAdjacentShadeCell","checkShadedClue","checkConnectUnshadeRB","checkActualDirection","checkLoop","doneShadingDecided"],checkShadedClue:function(){this.checkAllCell(function(t){return t.isShade()&&!t.allowShade()},"csOnArrow")},checkActualDirection:function(){this.board.buildGoalDirections(),this.checkAllCell(function(t){return 0<t.qnum&&0<t.actualdir&&t.qnum!==t.actualdir},"ceDirection")},checkLoop:function(){for(var t=this.board,e=t.ublkmgr.components,i=0;i<e.length;i++)if(0!==e[i].circuits){if(this.failcode.add("cuLoop"),this.checkOnly)return;this.searchloop(e[i],t.ublkmgr).seterr(1)}}}});
//# sourceMappingURL=guidearrow.js.map