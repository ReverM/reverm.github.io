/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(t,e){"object"==typeof module&&module.exports?module.exports=[t,e]:pzpr.classmgr.makeCustom(t,e)}(["slashpack"],{MouseEvent:{use:!0,inputModes:{edit:["number","clear"],play:["line","subcircle","peke"]},mouseinput_auto:function(){var t=this.puzzle;t.playmode?this.mousestart||this.mousemove?this.inputslash("right"===this.btn):this.mouseend&&this.notInputted()&&(this.mouseCell=this.board.emptycell,this.inputFixedQsub(1)):t.editmode&&this.inputqnum()},inputLine:function(){this.mousestart||this.mousemove?this.inputslash():this.mouseend&&this.notInputted()&&this.clickslash()},inputFixedQsub:function(t){var e=this.getcell();e.isnull||e===this.mouseCell||(null===this.inputData&&(this.inputData=!(e.qsub&t)),this.inputData?e.setQsub(e.qsub|t):e.setQsub(e.qsub&~t),e.draw(),this.mouseCell=e)},inputpeke:function(){this.inputslash(!0)},inputslash:function(t){var e,i,s,n,r=this.getcell();r.isnull||(this.mouseCell!==r?this.firstPoint.set(this.inputPoint):null!==this.firstPoint.bx&&(e=null,0<(i=this.inputPoint.bx-this.firstPoint.bx)*(s=this.inputPoint.by-this.firstPoint.by)&&.5<=Math.abs(i)&&.5<=Math.abs(s)?e=!0:i*s<0&&.5<=Math.abs(i)&&.5<=Math.abs(s)&&(e=!1),null!==e&&(t?(n=e?2:4,null===this.inputData&&(this.inputData=r.qsub&n?0:1),0<this.inputData?r.setQsub(r.qsub|n):r.setQsub(r.qsub&~n)):(n=e?31:32,null===this.inputData?(n===r.qans&&(n=0),this.inputData=+(0<n)):0===this.inputData&&(n=n===r.qans?0:null),null!==n&&r.setQans(n)),r.draw(),this.firstPoint.reset())),this.mouseCell=r)},clickslash:function(){var t,e,i,s=this.getcell();s.isnull||(t=this.puzzle.getConfig("use"),e="left"===this.btn?31:32,i=s.qans,1===t?s.setQans(i!==e?e:0):2===t&&s.setQans(("left"===this.btn?{0:31,31:32,32:0}:{0:32,31:0,32:31})[i]),s.drawaround())}},KeyEvent:{enablemake:!0},Cell:{maxnum:function(){return this.board.rows*this.board.cols},prehook:{qans:function(t){return t&&-1!==this.qnum}},posthook:{qnum:function(t){-1!==t&&this.setQans(0),this.board.maxFoundNumber=-1}},actualerror:function(){if(this.error)return this.error;if(1===this.adjborder.left.error){if(1===this.adjborder.right.error)return 1;if(1===this.adjborder.bottom.error)return 2;if(1===this.adjborder.top.error)return 5}else if(1===this.adjborder.right.error){if(1===this.adjborder.top.error)return 4;if(1===this.adjborder.bottom.error)return 3}return 0}},Board:{maxFoundNumber:-1,hasborder:2,initBoardSize:function(t,e){this.common.initBoardSize.call(this,t,e),this.maxFoundNumber=-1},addExtraInfo:function(){this.bordergraph=this.addInfoList(this.klass.BorderGraph)},getMaxFoundNumber:function(){if(-1!==this.maxFoundNumber)return this.maxFoundNumber;for(var t=-1,e=0;e<this.cell.length;e++){var i=this.cell[e];i.isNum()&&(t=Math.max(t,i.getNum()))}return this.maxFoundNumber=t}},BoardExec:{adjustBoardData:function(t,e){if(t&this.TURNFLIP)for(var i=this.board.cell,s=0;s<i.length;s++){var n=i[s];n.qans={0:0,31:32,32:31}[n.qans]}}},"BorderGraph:AreaGraphBase":{enabled:!0,pointgroup:"border",relation:{"cell.qans":"link"},setComponentRefs:function(t,e){t.bdarea=e},getObjNodeList:function(t){return t.bdareanodes},resetObjNodeList:function(t){t.bdareanodes=[]},isnodevalid:function(t){return!0},isedgevalidbynodeobj:function(t,e){var i=Math.min(t.bx,e.bx),s=Math.max(t.bx,e.bx),n=Math.min(t.by,e.by),t=Math.max(t.by,e.by),e=this.board.cellinside(i,n,s,t)[0];return!(e&&!e.isnull&&e.qans)||(s-e.bx==t-e.by?31!==e.qans:32!==e.qans)},setEdgeByLinkObj:function(t){var e=this;this.getSideObjByLinkObj(t).each(function(t){t.isnull||e.setEdgeByNodeObj(t)}),this.remakeComponent()},getSideObjByLinkObj:function(t){return this.board.borderinside(t.bx-1,t.by-1,t.bx+1,t.by+1)},getSideObjByNodeObj:function(t){return[t.relbd(-1,-1),t.relbd(-1,1),t.relbd(1,-1),t.relbd(1,1)].filter(function(t){return!t.isnull})}},Graphic:{mb2color:"rgb(127,127,255)",enablebcolor:!0,paint:function(){this.drawBGCells_slashpack(),this.drawGrid(),this.drawMBs(),this.drawQuesNumbers(),this.drawSlashes(),this.drawChassis(),this.drawTarget()},drawMBs:function(){for(var t=this.vinc("cell_mb","auto",!0),e=.35*this.cw,i=.8*e,s=this.range.cells,n=.5*Math.PI,r=Math.PI,o=1.5*Math.PI,a=0;a<s.length;a++){var h,u,l,b,d,c,f=s[a];1&f.qsub||1&f.qsubBySolver?(h=f.bx*this.bw,u=f.by*this.bh,t.vid="c_MB_"+f.id,t.lineWidth=1,t.strokeStyle=f.trial?"rgb(192, 192, 192)":this.getColorSolverAware(1&f.qsub,1&f.qsubBySolver,this.mbcolor),t.strokeCircle(h,u,e)):(t.vid="c_MB_"+f.id,t.vhide()),2&f.qsub?(l=(f.bx-1)*this.bw,b=(f.by-1)*this.bh,d=(f.bx+1)*this.bw,c=(f.by+1)*this.bh,t.vid="c_ca_"+f.id,t.lineWidth=1.5,t.strokeStyle=f.trial?"rgb(192, 192, 192)":this.mb2color,t.beginPath(),t.arc(l,b,i,0,n,!1),t.stroke(),t.vid="c_cc_"+f.id,t.beginPath(),t.arc(d,c,i,o,r,!0),t.stroke()):(t.vid="c_ca_"+f.id,t.vhide(),t.vid="c_cc_"+f.id,t.vhide()),4&f.qsub?(l=(f.bx+1)*this.bw,b=(f.by-1)*this.bh,d=(f.bx-1)*this.bw,c=(f.by+1)*this.bh,t.vid="c_cb_"+f.id,t.lineWidth=1.5,t.strokeStyle=f.trial?"rgb(192, 192, 192)":this.mb2color,t.beginPath(),t.arc(l,b,i,r,n,!0),t.stroke(),t.vid="c_cd_"+f.id,t.beginPath(),t.arc(d,c,i,o,0,!1),t.stroke()):(t.vid="c_cb_"+f.id,t.vhide(),t.vid="c_cd_"+f.id,t.vhide())}},drawBGCells_slashpack:function(){for(var t=this.vinc("cell_back","crispEdges"),e=(t.fillStyle=this.errbcolor1,this.range.cells),i=0;i<e.length;i++){var s=e[i],n=s.actualerror(),r=s.bx*this.bw,o=s.by*this.bh;t.vid="c_bglight_"+s.id,1===n?t.fillRectCenter(r,o,this.bw+.5,this.bh+.5):0!==n?this.drawTriangle1(r,o,n):t.vhide()}}},Encode:{decodePzpr:function(t){this.decodeNumber16()},encodePzpr:function(t){this.encodeNumber16()}},FileIO:{decodeData:function(){this.decodeCellQnum(),this.decodeCell(function(t,e){110<e.charCodeAt(0)&&e.charCodeAt(0)<=117&&(t.qsub=e.charCodeAt(0)-110,e=e.substr(1)),+e&&(t.qans=+e+30)})},encodeData:function(){this.encodeCellQnum(),this.encodeCell(function(t){var e="";return 0<t.qsub&&(e+=String.fromCharCode(110+t.qsub)),30<t.qans?e+=""+t.qans-30:""===e&&(e+="."),e+" "})}},AnsCheck:{checklist:["checkLineOnNumber","checkAllNumbersPresent","checkDifferentNumberInRoom","checkOverNumberCount","checkDeadEndDiagonal+"],checkLineOnNumber:function(){this.checkAllCell(function(t){return-1!==t.qnum&&30<t.qans},"lnOverlap")},checkDifferentNumberInRoom:function(){this.checkDifferentNumberInRoom_main(this.board.bordergraph,this.isDifferentNumberInBlist)},isDifferentNumberInBlist:function(t){return this.isIndividualObject(t,function(t){return t.isvert?t.sidecell[0].getNum():0})},checkAllNumbersPresent:function(){this.checkNumberCount(-1,"bkMissingNum")},checkOverNumberCount:function(){this.checkNumberCount(1,"bkOverNum")},checkNumberCount:function(t,e){for(var i=this.board.getMaxFoundNumber(),s=this.board.bordergraph.components,n=0;n<s.length;n++){var r=s[n].getnodeobjs(),o=r.filter(function(t){return t.isvert&&t.sidecell[0].isNum()}).length;if(!(t<0&&i<=o)&&!(0<t&&o<=i)){if(this.failcode.add(e),this.checkOnly)break;r.seterr(1)}}},checkDeadEndDiagonal:function(){for(var t=this.board,e=0;e<t.cell.length;e++){var i=t.cell[e];if(!(i.bx>=t.maxbx-1||i.by>=t.maxby-1)){var s=i.bx,n=i.by,i=t.cellinside(s,n,s+2,n+2).filter(function(t){return t.bx-s+(t.by-n)==2?32===t.qans:31===t.qans});if(1===i.length){if(this.failcode.add("lnDeadEnd"),this.checkOnly)break;i.seterr(1)}}}}},FailCode:{lnOverlap:"lnOverlap.tontti"}});
//# sourceMappingURL=slashpack.js.map