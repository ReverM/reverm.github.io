/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["doppelblock"],{MouseEvent:{inputModes:{edit:["number"],play:["number","objblank","shade"]},mouseinput_number:function(){!this.mousestart||this.puzzle.editmode&&this.inputqnum_excell()||this.inputqnum()},mouseinput_auto:function(){var e;this.puzzle.playmode?this.mousestart&&!(e=this.getcell_excell()).isnull&&"cell"===e.group&&this.inputqnum():this.puzzle.editmode&&this.mouseinput_number()},inputqnum_excell:function(){var e=this.getpos(0).getex();e.isnull||(e!==this.cursor.getex()?this.setcursor(this.getpos(0)):this.inputqnum_main(e))},getNewNumber:function(e,t){var s,u=this.puzzle.editmode?-1:-3;return"left"===this.btn?(t+=1)>e.getmaxnum()?u:(s=e.getminnum(),0<=t&&t<s?s:t):"right"===this.btn?(t-=1)<u?e.getmaxnum():0<=t&&t<e.getminnum()?-1:t:t+1},inputDot:function(){this.inputFixedNumber(-2)},inputShade:function(){this.inputFixedNumber(-3)},inputFixedNumber:function(e){var t=this.getcell();t.isnull||(null===this.inputData&&(this.inputData=t.getNum()===e?-1:e),t.setNum(this.inputData),(this.mouseCell=t).draw())}},KeyEvent:{enablemake:!0,enableplay:!0,keyinput:function(e){var t;this.puzzle.playmode?((t=0!==this.cursor.targetdir)||("q"===e||"a"===e||"z"===e?e="s1":"w"===e||"s"===e||"x"===e?e="s2":"e"!==e&&"d"!==e&&"c"!==e&&"-"!==e||(e=" ")),this.key_inputqnum(e),t||" "!==e||this.cursor.getc().clrSnum()):(t=this.cursor.getex()).isnull?this.key_inputqnum(e):this.key_inputqnum_main(t,e)}},Cell:{disInputHatena:!0,enableSubNumberArray:!0,numberWithMB:!0,maxnum:function(){return this.board.cols-2},noNum:function(){return this.qnum<0&&this.anum<0&&1!==this.qans},getNum:function(){return-1!==this.qnum?this.qnum:0<this.anum?this.anum:0<this.qans?-3:0<this.qsub?-2:-1},setNum:function(e){if(this.puzzle.editmode)return this.setQnum(e),this.setAnum(-1),this.setQsub(0),this.setQans(0),void this.clrSnum();if(-1===this.qnum){if(0<e)this.setAnum(e),this.setQsub(0),this.setQans(0);else switch(this.setAnum(-1),e){case-1:this.setQsub(0),this.setQans(0);break;case-2:this.setQsub(1),this.setQans(0);break;case-3:this.setQsub(0),this.setQans(1)}this.clrSnum()}}},ExCell:{disInputHatena:!0,minnum:0,maxnum:function(){var e=this.board.cols-2;return e*(1+e)/2}},Board:{cols:5,rows:5,hasexcell:1},BoardExec:{adjustBoardData:function(e,t){this.adjustExCellTopLeft_1(e,t)},adjustBoardData2:function(e,t){this.adjustExCellTopLeft_2(e,t)}},Graphic:{gridcolor_type:"LIGHT",paint:function(){this.drawBGCells(),this.drawBGExCells(),this.drawShadedCells(),this.drawDotCells(),this.drawTargetSubNumber(),this.drawGrid(),this.drawBorders(),this.drawSubNumbers(),this.drawAnsNumbers(),this.drawQuesNumbers(),this.drawNumbersExCell(),this.drawChassis(),this.drawCursor(!0)}},Encode:{decodePzpr:function(e){this.decodeNumber16ExCell(),this.decodeNumber16()},encodePzpr:function(e){this.encodeNumber16ExCell(),this.board.cell.some(function(e){return-1!==e.qnum})&&this.encodeNumber16()}},FileIO:{decodeData:function(){this.decodeCellExCellQnumAnumsub()},encodeData:function(){this.encodeCellExCellQnumAnumsub()},decodeCellExCellQnumAnumsub:function(){this.decodeCellExCell(function(e,t){"."!==t&&("excell"===e.group?e.qnum=+t:"cell"===e.group&&("q"===t[0]?e.qnum=+t.substr(1):"+"===(t=0<=t.indexOf("[")?this.setCellSnum(e,t):t)?e.qsub=1:"-"===t?e.qans=1:"."!==t&&(e.anum=+t)))})},encodeCellExCellQnumAnumsub:function(){this.encodeCellExCell(function(e){if("excell"===e.group){if(-1!==e.qnum)return e.qnum+" "}else if("cell"===e.group){if(-1!==e.qnum)return"q"+e.qnum+" ";var t=".";return-1!==e.anum?t=""+e.anum:1===e.qsub?t="+":1===e.qans&&(t="-"),-1===e.anum&&(t+=this.getCellSnum(e)),t+" "}return". "})}},AnsCheck:{checklist:["checkDifferentNumberInLine","checkTwoBlocks","checkBlockSum","checkNoNumCell+"],checkTwoBlocks:function(){this.checkRowsCols(function(e){e=e.filter(function(e){return e.isShade()});return e.length<=2||(e.seterr(1),!1)},"ceTooManyBlocks")},checkBlockSum:function(){this.checkRowsCols(this.isExCellSum,"nmSum")},isExCellSum:function(e){var t=e.getRectSize(),s=null,u=this.board;if(t.x1===t.x2&&(s=u.getex(t.x1,-1)),!(s=t.y1===t.y2?u.getex(-1,t.y1):s)||-1===s.qnum)return!0;for(var n=-1,i=0,l=new this.klass.CellList,r=0;r<e.length;r++){var o=e[r];o.isShade()?(1===++i&&(n=0),i<=2&&l.add(o)):1===i&&(l.add(o),0<(o=o.getNum())&&(n+=o))}return i<2||(n===s.qnum||(s.seterr(1),l.seterr(1),!1))}}});
//# sourceMappingURL=doppelblock.js.map