/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(t,i){"object"==typeof module&&module.exports?module.exports=[t,i]:pzpr.classmgr.makeCustom(t,i)}(["easyasabc"],{MouseEvent:{inputModes:{edit:["number"],play:["number","numexist","numblank","clear"]},mouseinput_number:function(){!this.mousestart||this.puzzle.editmode&&this.inputqnum_excell()||this.inputqnum()},mouseinput_auto:function(){var t;this.puzzle.playmode?this.mousestart&&!(t=this.getcell_excell()).isnull&&"cell"===t.group&&this.inputqnum():this.puzzle.editmode&&this.mouseinput_number()},inputqnum_excell:function(){var t,i=this.getpos(0).getex();i.isnull||(i!==this.cursor.getex()?this.setcursor(this.getpos(0)):"excell"===i.group?this.inputqnum_main(i):(i=this.board.indicator,null!==(t=this.getNewNumber(i,i.count))&&(t<=0&&(t="left"===this.btn?i.getminnum():i.getmaxnum()),i.set(t))))}},KeyEvent:{enablemake:!0,enableplay:!0,keyinput:function(t){var i;this.puzzle.playmode?((i=0!==this.cursor.targetdir)||("1"===t?t="s1":"2"===t?t="s2":"3"===t&&(t="BS")),this.key_inputqnum(t),i||" "!==t||this.cursor.getc().clrSnum()):this.cursor.by>=this.board.minby?(i=this.cursor.getex()).isnull?this.key_inputqnum(t):this.key_inputqnum_main(i,t):this.key_inputqnum_indicator(t)},key_inputqnum_indicator:function(t){var i=this.puzzle.board,t=this.getNewNumber(i.indicator,t,i.indicator.count);null!==t&&(i.indicator.set(t),this.prev=i.indicator)}},TargetCursor:{draw:function(){this.by>=this.board.minby?this.common.draw.call(this):this.board.indicator.draw()},initCursor:function(){this.init(-1,-1),this.adjust_init()},setminmax_customize:function(){this.puzzle.editmode||(this.minx+=2,this.miny+=2,this.maxx-=2,this.maxy-=2)}},Cell:{enableSubNumberArray:!0,numberWithMB:!0,numberAsLetter:!0,maxnum:function(){return this.board.indicator.count}},ExCell:{disInputHatena:!0,numberAsLetter:!0,maxnum:function(){return this.board.indicator.count}},Board:{cols:5,rows:5,hasexcell:2,indicator:null,createExtraObject:function(){this.indicator=new this.klass.Indicator},initExtraObject:function(t,i){this.indicator.init(),this.indicator.count=this.klass.Indicator.prototype.count},getex:function(t,i){return i>this.minby?this.common.getex.call(this,t,i):-3===i?this.indicator:this.emptyexcell},searchSight:function(t,i){var e=t.getaddr(),n=0,r=this.emptycell;for(e.by===this.minby+1?n=2:e.by===this.maxby-1?n=1:e.bx===this.minbx+1?n=4:e.bx===this.maxbx-1&&(n=3);0!==n;){e.movedir(n,2);var s=e.getc();if(s.isnull)break;if(s.isNumberObj()){r=s;break}}return i&&(t.error=1,r.error=1),{dest:r}}},BoardExec:{adjustBoardData2:function(t,i){this.board.indicator.init()}},Indicator:{count:3,rect:null,numberAsLetter:!0,qnum:-1,initialize:function(t){t&&(this.count=t),this.rect={bx1:-1,by1:-1,bx2:-1,by2:-1}},init:function(){var t=this.puzzle.board;this.rect={bx1:t.maxbx-3.15,by1:-3.8,bx2:t.maxbx-.15,by2:-2.2}},set:function(t){this.count!==(t=t<=0?1:t)&&(this.addOpe(this.count,t),this.count=t,this.draw())},getmaxnum:function(){var t=this.board;return Math.max(t.rows,t.cols)},getminnum:function(){return 1},addOpe:function(t,i){this.puzzle.opemgr.add(new this.klass.IndicatorOperation(t,i))},draw:function(){this.puzzle.painter.paintRange(this.board.minbx,-1,this.board.maxbx,-1)}},"IndicatorOperation:Operation":{type:"indicator",setData:function(t,i){this.old=t,this.num=i},decode:function(t){return"AS"===t[0]&&(this.old=+t[1],this.num=+t[2],!0)},toString:function(){return["AS",this.old,this.num].join(",")},undo:function(){this.exec(this.old)},redo:function(){this.exec(this.num)},exec:function(t){this.board.indicator.set(t)}},OperationManager:{addExtraOperation:function(){this.operationlist.push(this.klass.IndicatorOperation)}},Graphic:{gridcolor_type:"LIGHT",paint:function(){this.drawBGCells(),this.drawBGExCells(),this.drawTargetSubNumber(),this.drawGrid(),this.drawBorders(),this.drawMBs(),this.drawSubNumbers(),this.drawAnsNumbers(),this.drawQuesNumbers(),this.drawNumbersExCell(),this.drawChassis(),this.drawIndicator(),this.drawCursor_easyasbac()},getCanvasRows:function(){return this.getBoardRows()+2*this.margin+.8},getOffsetRows:function(){return 1.45},setRangeObject:function(t,i,e,n){this.common.setRangeObject.call(this,t,i,e,n),this.range.indicator=i<0},copyBufferData:function(t,i,e,n,r,s){this.common.copyBufferData.call(this,t,i,e,n,r,s),t.use.canvas&&this.range.indicator&&(e=this.board,n=i.child.width,r=e.minby*this.bh+this.y0,t.context.clearRect(0,0-this.y0,n,r),t.drawImage(i.child,0,0,+n,+r,0-this.x0,0-this.y0,+n,+r))},drawIndicator:function(){var t=this.vinc("indicator","auto",!0),i=this.board;this.range.indicator&&(t.use.canvas&&t.context.clearRect(0,-this.y0,t.child.width,i.minby*this.bh+this.y0),t.fillStyle=this.quescolor,t.vid="bd_indicator",t.font=(.66*this.ch|0)+"px "+this.fontfamily,t.textAlign="right",t.textBaseline="middle",t.fillText("(A-"+this.getNumberTextCore_letter(i.indicator.count)+")",(i.maxbx-.2)*this.bw,-3*this.bh))},drawCursor_easyasbac:function(){var t=this.puzzle.board.minby<=this.puzzle.cursor.by,i=!t;this.drawCursor(!0,t),this.drawCursorOnIndicator(i)},drawCursorOnIndicator:function(t){var i=this.vinc("target_cursor_indicator","crispEdges",!0),e=this.board;this.range.indicator&&(t=t&&this.puzzle.editmode&&this.puzzle.getConfig("cursor")&&!this.outputImage,i.vid="ti",t?(t=e.indicator.rect,i.strokeStyle=this.targetColorEdit,i.lineWidth=0|Math.max(this.cw/16,2),i.strokeRect(t.bx1*this.bw,t.by1*this.bh,(t.bx2-t.bx1)*this.bw,(t.by2-t.by1)*this.bh)):i.vhide())}},Encode:{decodePzpr:function(t){this.decodeIndicator(),this.decodeNumber16ExCell(),this.decodeNumber16()},encodePzpr:function(t){this.encodeIndicator(),this.encodeNumber16ExCell(),this.board.cell.some(function(t){return-1!==t.qnum})&&this.encodeNumber16()},decodeIndicator:function(){var t=this.outbstr.split("/");this.board.indicator.count=+t[0],this.outbstr=t[1]||""},encodeIndicator:function(){this.outbstr=this.board.indicator.count+"/"}},FileIO:{decodeData:function(){this.decodeIndicator(),this.decodeCellExCellQnumAnumsub()},encodeData:function(){this.encodeIndicator(),this.encodeCellExCellQnumAnumsub()},decodeIndicator:function(){this.board.indicator.count=+this.readLine()},encodeIndicator:function(){this.writeLine(this.board.indicator.count)},decodeCellExCellQnumAnumsub:function(){this.decodeCellExCell(function(t,i){"."!==i&&("excell"===t.group?t.qnum=+i:"cell"===t.group&&("q"===i[0]?t.qnum=+i.substr(1):"+"===(i=0<=i.indexOf("[")?this.setCellSnum(t,i):i)?t.qsub=1:"-"===i?t.qsub=2:"."!==i&&(t.anum=+i)))})},encodeCellExCellQnumAnumsub:function(){this.encodeCellExCell(function(t){if("excell"===t.group){if(-1!==t.qnum)return t.qnum+" "}else if("cell"===t.group){if(-1!==t.qnum)return"q"+t.qnum+" ";var i=".";return-1!==t.anum?i=""+t.anum:1===t.qsub?i="+":2===t.qsub&&(i="-"),-1===t.anum&&(i+=this.getCellSnum(t)),i+" "}return". "})}},AnsCheck:{checklist:["checkDifferentNumberInLine","checkSight+","checkNumberSaturatedInLine"],checkNumberSaturatedInLine:function(){this.checkRowsCols(this.isNumberSaturatedInClist,"nmMissRow")},isNumberSaturatedInClist:function(t){if(t.length<=0)return!0;for(var i=!0,e=[],n=this.board.indicator.count,r=1;r<=n;r++)e[r]=0;for(var s=0;s<t.length;s++){var o=t[s].getNum();1<=o&&e[o]++}for(r=1;r<=n;r++)if(0===e[r]){i=!1;break}return i||t.seterr(1),i},checkSight:function(){for(var t=this.board,i=!0,e=0;e<t.excell.length;e++){var n=t.excell[e];if(-1!==n.qnum){var r=t.searchSight(n,!1).dest;if(!r.isnull&&n.qnum!==r.getNum()&&1!==r.qsub){if(i=!1,this.checkOnly)break;n.seterr(1),t.searchSight(n,!0)}}}i||this.failcode.add("nmSightNe")}}});
//# sourceMappingURL=easyasabc.js.map