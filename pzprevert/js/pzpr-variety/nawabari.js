/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,i){"object"==typeof module&&module.exports?module.exports=[e,i]:pzpr.classmgr.makeCustom(e,i)}(["nawabari","fourcells","fivecells","heteromino","subomino"],{MouseEvent:{autoedit_func:"qnum",autoplay_func:"border"},"MouseEvent@nawabari":{inputModes:{edit:["number","clear"],play:["border","subline"]}},"MouseEvent@fourcells,fivecells":{inputModes:{edit:["empty","number","clear"],play:["border","subline"]}},"MouseEvent@heteromino":{inputModes:{edit:["empty","clear"],play:["border","subline"]},mouseinputAutoEdit:function(){this.inputempty()}},"MouseEvent@fourcells,fivecells,subomino":{inputModes:{edit:["empty","number","clear"],play:["border","subline"]},mouseinput_clear:function(){this.inputFixedNumber(-1)}},KeyEvent:{enablemake:!0},"KeyEvent@fourcells,fivecells,subomino,heteromino":{keyinput:function(e){"w"===e?this.key_inputvalid(e):"heteromino"!==this.pid&&this.key_inputqnum(e)},key_inputvalid:function(e){"w"!==e||(e=this.cursor.getc()).isnull||e.setValid(7!==e.ques?7:0)}},Cell:{getdir4BorderCount:function(){for(var e=0,i=this.getdir4cblist(),r=0;r<i.length;r++){var t=i[r][0],s=i[r][1];(t.isnull||t.isEmpty()||s.isBorder())&&e++}return e}},"Cell@nawabari":{maxnum:4,minnum:0},"Cell@fourcells":{maxnum:3},"Cell@fivecells":{maxnum:3,minnum:0},"Cell@subomino":{maxnum:function(){return this.board.cols*this.board.rows},minnum:2,posthook:{qnum:function(e){this.room&&this.board.roommgr.setExtraData(this.room)}}},"CellList@heteromino":{triminoShape:function(){if(3!==this.length)return-1;for(var e=this.getRectSize(),i=0,r=0;r<this.length;r++){var t=this[r],s=t.bx-e.x1>>1,t=t.by-e.y1>>1;2<=s||2<=t||(i+=1<<s+2*t)}return i}},"CellList@subomino":{seterr:function(i){this.each(function(e){i>e.error&&(e.error=i)})}},Border:{isGrid:function(){return this.sidecell[0].isValid()&&this.sidecell[1].isValid()},isBorder:function(){return 0<this.qans||this.isQuesBorder()},isQuesBorder:function(){return!!(this.sidecell[0].isEmpty()^this.sidecell[1].isEmpty())},prehook:{qans:function(){return!this.isGrid()},qsub:function(){return!this.isGrid()}}},Board:{hasborder:2},"Board@fourcells,fivecells":{initBoardSize:function(e,i){this.common.initBoardSize.call(this,e,i);e=e*i%("fivecells"===this.pid?5:4);1<=e&&(this.getc(this.minbx+1,this.minby+1).ques=7),2<=e&&(this.getc(this.maxbx-1,this.minby+1).ques=7),3<=e&&(this.getc(this.minbx+1,this.maxby-1).ques=7),4<=e&&(this.getc(this.maxbx-1,this.maxby-1).ques=7)}},AreaRoomGraph:{enabled:!0},"AreaRoomGraph@subomino":{setExtraData:function(i){i.clist=new this.klass.CellList(i.getnodeobjs()),i.valid=!i.clist.some(function(e){return 0<e.qnum&&e.qnum!==i.clist.length})}},Graphic:{gridcolor_type:"DLIGHT",numbercolor_func:"qnum",paint:function(){this.drawBGCells(),this.drawValidDashedGrid(),this.drawQansBorders(),this.drawQuesBorders(),"heteromino"!==this.pid&&"subomino"!==this.pid||(this.drawCircles(),this.drawChassis()),this.drawQuesNumbers(),this.drawBorderQsubs(),this.drawTarget()},getQuesBorderColor:function(e){return e.isQuesBorder()?this.quescolor:null},drawValidDashedGrid:function(){for(var e=this.vinc("grid_waritai","crispEdges",!0),i=this.getDashArray(),r=(e.lineWidth=1,e.strokeStyle=this.gridcolor,this.range.borders),t=0;t<r.length;t++){var s,o,n=r[t];e.vid="b_grid_wari_"+n.id,n.isGrid()?(s=n.bx*this.bw,o=n.by*this.bh,n.isVert()?e.strokeDashedLine(s,o-this.bh,s,o+this.bh,i):e.strokeDashedLine(s-this.bw,o,s+this.bw,o,i)):e.vhide()}}},"Graphic@heteromino,subomino":{errbcolor2:"rgb(255, 216, 216)",circlestrokecolor_func:"null",circleratio:[.35,.35],getBGCellColor:function(e){if(!e.isValid())return"black";e=e.error||e.qinfo;return 1===e||3===e?this.errbcolor1:2===e?this.errbcolor2:null},getCircleFillColor:function(e){return 3===e.error?this.errbcolor2:null}},Encode:{decodePzpr:function(e){this.decodeFivecells()},encodePzpr:function(e){this.encodeFivecells()},decodeFivecells:function(){for(var e=0;e<this.board.cell.length;e++)this.board.cell[e].setQues(0);for(var e=0,i=0,r=this.outbstr,t=this.board,i=0;i<r.length;i++){var s=t.cell[e],o=r.charAt(i);if(s.ques=0,"7"===o?s.ques=7:"."===o?s.qnum=-2:this.include(o,"0","9")?s.qnum=parseInt(o,10):this.include(o,"a","z")&&(e+=parseInt(o,36)-10),++e>=t.cell.length)break}this.outbstr=r.substr(i)},encodeFivecells:function(){for(var e="",i=0,r=this.board,t=0;t<r.cell.length;t++){var s="",o=r.cell[t].qnum;7===r.cell[t].ques?s="7":-2===o?s=".":-1!==o?s=o.toString(10):i++,0===i?e+=s:!s&&26!==i||(e+=(9+i).toString(36)+s,i=0)}0<i&&(e+=(9+i).toString(36)),this.outbstr+=e}},"Encode@subomino":{decodePzpr:function(e){this.decodeNumber16(),this.decodeEmpty()},encodePzpr:function(e){this.encodeNumber16(),this.encodeEmpty()}},FileIO:{decodeData:function(){this.decodeCell(function(e,i){e.ques=0,"*"===i?e.ques=7:"-"===i?e.qnum=-2:"."!==i&&(e.qnum=+i)}),this.decodeBorderAns("fourcells"===this.pid&&0===this.filever?1:null)},encodeData:function(){"fourcells"===this.pid&&(this.filever=1),this.encodeCell(function(e){return 7===e.ques?"* ":-2===e.qnum?"- ":0<=e.qnum?e.qnum+" ":". "}),this.encodeBorderAns()}},AnsCheck:{checklist:["checkOverThreeCells@heteromino","checkTouchDifferent@heteromino","checkLessThreeCells@heteromino","checkRoomRect@nawabari","checkNoNumber@nawabari","checkDoubleNumber@nawabari","checkOverFourCells@fourcells","checkOverFiveCells@fivecells","checkdir4BorderAns@!heteromino","checkBorderDeadend+","checkLessFourCells@fourcells","checkLessFiveCells@fivecells"],checkOverThreeCells:function(){this.checkAllArea(this.board.roommgr,function(e,i,r,t){return 3<=r},"bkSizeLt3")},checkLessThreeCells:function(){this.checkAllArea(this.board.roommgr,function(e,i,r,t){return r<=3},"bkSizeGt3")},checkOverFourCells:function(){this.checkAllArea(this.board.roommgr,function(e,i,r,t){return 4<=r},"bkSizeLt4")},checkLessFourCells:function(){this.checkAllArea(this.board.roommgr,function(e,i,r,t){return r<=4},"bkSizeGt4")},checkOverFiveCells:function(){this.checkAllArea(this.board.roommgr,function(e,i,r,t){return 5<=r},"bkSizeLt5")},checkLessFiveCells:function(){this.checkAllArea(this.board.roommgr,function(e,i,r,t){return r<=5},"bkSizeGt5")},checkdir4BorderAns:function(){this.checkAllCell(function(e){return e.isValidNum()&&e.getdir4BorderCount()!==e.qnum},"nmBorderNe")},checkTouchDifferent:function(){for(var e=this.board,i=0;i<e.border.length;i++){var r=e.border[i];if(r.isBorder()){var t=r.sidecell[0],r=r.sidecell[1];if(t.isValid()&&r.isValid()){t=t.room.clist,r=r.room.clist;if(3===t.length&&3===r.length&&t.triminoShape()===r.triminoShape()){if(this.failcode.add("bkSameTouch"),this.checkOnly)return;t.seterr(1),r.seterr(1)}}}}}},"AnsCheck@subomino":{checklist:["checkAreaOverlap","checkNumberValid","checkBorderDeadend+"],checkAreaOverlap:function(){for(var e=this.board.roommgr.getSideAreaInfo(),i=0;i<e.length;i++){var r=e[i][0],t=e[i][1];if(r.valid&&t.valid){r.clist.length>t.clist.length&&(t=e[i][0],r=e[i][1]);for(var s=r.clist.getRectSize(),o=t.clist.getRectSize(),n=new this.klass.CellList,l=!1,c=0;!l&&c<=o.cols-s.cols;c++)for(var h=0;!l&&h<=o.rows-s.rows;h++){for(var u=0;u<r.clist.length;u++){var a=r.clist[u],a=this.board.getc(2*c+o.x1+a.bx-s.x1,2*h+o.y1+a.by-s.y1);if(a.isnull||a.room!==t)break;n.add(a)}u===r.clist.length?l=!0:n=new this.klass.CellList}if(l){if(this.failcode.add("bkOverlap"),this.checkOnly)break;n.seterr(3),r.clist.seterr(2),t.clist.seterr(1)}}}},checkNumberValid:function(){for(var e=this.board,i=0;i<e.roommgr.components.length;i++){var r=e.roommgr.components[i];if(!r.valid){if(this.failcode.add("bkSizeNe"),this.checkOnly)break;r.clist.seterr(1)}}}}});
//# sourceMappingURL=nawabari.js.map