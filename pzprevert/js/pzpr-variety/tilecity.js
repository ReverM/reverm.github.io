/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["tilecity"],{MouseEvent:{use:!0,inputModes:{edit:["border","number"],play:["shade","unshade"]},mouseinput:function(){"shade"===this.inputMode||"unshade"===this.inputMode?this.inputtile_tilecity():this.common.mouseinput.call(this)},mouseinput_auto:function(){this.puzzle.playmode?(this.mousestart||this.mousemove)&&this.inputtile_tilecity():this.puzzle.editmode&&(this.mousestart||this.mousemove?this.inputborder():this.mouseend&&this.notInputted()&&this.inputqnum())},inputtile_tilecity:function(){var e=this.getcell();if(!e.isnull&&e!==this.mouseCell){null===this.inputData&&this.decIC(e);var t=e.room.clist;if(1===this.inputData)for(var i=0;i<t.length;i++)if(t[i].isNum()){if(this.mousestart){this.inputData=1!==e.qsub?2:0;break}return}this.mouseCell=e;for(i=0;i<t.length;i++){var s=t[i];(1===this.inputData?s.setShade:s.clrShade).call(s),s.setQsub(2===this.inputData?1:0)}t.draw()}}},KeyEvent:{enablemake:!0},Cell:{maxnum:function(){var e=this.board.cols*this.board.rows;return Math.floor((Math.sqrt(8*e+1)-1)/2)}},Board:{hasborder:1},AreaUnshadeGraph:{enabled:!0,setExtraData:function(e){this.common.setExtraData.call(this,e);var t=new Set;e.clist.each(function(e){t.add(e.room)}),e.blockset=Array.from(t)}},AreaRoomGraph:{enabled:!0},Graphic:{enablebcolor:!0,bgcellcolor_func:"qsub1",errbcolor2:"rgb(192, 192, 255)",bbcolor:"rgb(96, 96, 96)",paint:function(){this.drawBGCells(),this.drawShadedCells(),this.drawDashedGrid(),this.drawQuesNumbers(),this.drawBorders(),this.drawChassis(),this.drawBoxBorders(!0),this.drawTarget()}},Encode:{decodePzpr:function(e){this.decodeBorder(),this.decodeNumber10()},encodePzpr:function(e){this.encodeBorder(),this.encodeNumber10()}},FileIO:{decodeData:function(){this.decodeAreaRoom(),this.decodeCellQnum(),this.decodeCellAns()},encodeData:function(){this.encodeAreaRoom(),this.encodeCellQnum(),this.encodeCellAns()}},AnsCheck:{checklist:["checkSameColorTile","checkShadedObject","check2x2ShadeCell","checkSequence","checkNumberMatch","checkUniqueShapes","doneShadingDecided"],checkShadedObject:function(){this.checkAllCell(function(e){return 1===e.qans&&-1!==e.qnum},"objShaded")},checkNumberMatch:function(){this.checkAllCell(function(e){return 0<e.qnum&&e.ublk&&e.qnum!==e.ublk.blockset.length},"bkMaxSizeNe")},checkSequence:function(){for(var e=this.board.ublkmgr.components,t=0;t<e.length;t++){for(var i=e[t],s=i.blockset.length,o=0,n=0;n<i.blockset.length;n++)o=Math.max(o,i.blockset[n].clist.length);if(s<o){if(this.failcode.add("bsNoSequence"),this.checkOnly)return;i.clist.seterr(1)}}},checkUniqueShapes:function(){for(var e=this.board.ublkmgr.components,t=!0,i=0;i<e.length;i++)for(var s=e[i],o=s.blockset,n={},r=0;r<o.length;r++){var c=o[r].clist,h=c.length;if(""+h in n){if(this.failcode.add("bsSameNum"),this.checkOnly)return;t&&(this.board.cell.setnoerr(),t=!1),s.clist.each(function(e){-1===e.error&&e.seterr(0)}),c.seterr(1),n[h].seterr(1)}else n[h]=c}}}});
//# sourceMappingURL=tilecity.js.map