/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,i){"object"==typeof module&&module.exports?module.exports=[e,i]:pzpr.classmgr.makeCustom(e,i)}(["balloon"],{MouseEvent:{inputModes:{edit:["shade","number","clear"],play:["line","border","peke"]},inputShade:function(){this.inputIcebarn()},initialize:function(){this.prevBorderPos=new this.klass.Address,this.prevLinePos=new this.klass.Address,this.common.initialize.call(this)},mousereset:function(){this.prevBorderPos.reset(),this.prevLinePos.reset(),this.common.mousereset.call(this)},mouseinputAutoPlay:function(){var e;"right"===this.btn?this.inputpeke():(this.mousestart&&(e=this.getpos(.16).getb(),this.getpos(.16).getx().isnull&&(e.isnull||e.isBorderNG())?this.isDividing=null:this.isDividing=!0),!1!==this.isDividing&&(this.prevPos=this.prevBorderPos,this.inputborder(),this.prevBorderPos=this.prevPos,this.notInputted()?this.inputData=null:this.isDividing=!0),!0!==this.isDividing&&(this.prevPos=this.prevLinePos,this.inputLine(),this.prevLinePos=this.prevPos,this.notInputted()?this.inputData=null:this.isDividing=!1),this.mouseend&&this.notInputted()&&this.inputpeke())},mouseinputAutoEdit:function(){var e=this.getcell();"right"!==this.btn||e.isNum()||!this.mousestart&&!this.mousemove?this.mouseend&&this.notInputted()&&this.inputqnum():this.inputIcebarn()}},KeyEvent:{enablemake:!0,keyinput:function(e){var i;"q"===e?((i=this.cursor.getc()).setQues(6!==i.ques?6:0),(this.prev=i).draw()):this.key_inputqnum(e)}},Border:{enableLineNG:!0,isLineNG:function(){var e=this.sidecell[0],i=this.sidecell[1];return e&&e.ice()&&i&&i.ice()},isBorderNG:function(){var e=this.sidecell[0],i=this.sidecell[1];return e&&!e.ice()&&i&&!i.ice()},prehook:{qans:function(e){return 0!==e&&this.isBorderNG()}},rebuildRooms:function(){for(var e=0;e<=1;e++){var i=this.sidecell[e];i&&i.room&&this.board.roommgr.setExtraData(i.room)}},posthook:{line:function(e){this.rebuildRooms()},qans:function(e){this.rebuildRooms()}}},Cell:{isLineShapeEndpoint:function(){return this.isNum()||this.ice()},posthook:{qnum:function(e){-1!==e&&6===this.ques&&this.setQues(0)},ques:function(e){if(6===e)for(var i in this.setQnum(-1),this.adjborder)(t=this.adjborder[i]).isLineNG()&&t.removeLine();else for(var i in this.adjborder){var t;(t=this.adjborder[i]).isBorderNG()&&t.setQans(0)}}},maxnum:function(){var e=this.board.cols,i=this.board.rows;return e*i-Math.min(e,i)}},Board:{hasborder:1},Graphic:{bordercolor_func:"qans",icecolor:"rgb(204,204,204)",trialcolor:"rgb(80, 0, 80)",linetrialcolor:"rgb(80, 0, 80)",paint:function(){this.drawBGCells(),this.drawLines(),this.drawIceCells(),this.drawDashedGrid(),this.drawBorders(),this.drawPekes(),this.drawQuesNumbers(),this.drawChassis(),this.drawTarget()},getBGCellColor:function(e){return 6===e.ques||1!==e.error&&1!==e.qinfo?null:this.errbcolor1},drawIceCells:function(){this.vinc("cell_ice","crispEdges",!0),this.drawCells_common("c_fullice_",this.getIceCellColor)},getIceCellColor:function(e){return 6!==e.ques?null:1===e.error||1===e.qinfo?this.erricecolor:this.icecolor}},LineGraph:{enabled:!0,makeClist:!0},AreaRoomGraph:{VALID:0,NO_LINE:1,MULTI_LINE:2,NOT_RECT:3,NOT_CLOSED:4,enabled:!0,isnodevalid:function(e){return 6===e.ques},setExtraData:function(e){this.common.setExtraData.call(this,e),e.valid=this.VALID;for(var i=e.clist.getRectSize(),t=(i.cols*i.rows!==i.cnt&&(e.valid=this.NOT_RECT),0),n=0;n<e.clist.length;n++){var s,o=e.clist[n];for(s in o.adjborder){var r=o.adjborder[s];if(r&&!r.isnull){var c=r.sidecell[0].room!==r.sidecell[1].room;if(r.isLine()&&t++,c&&!r.isBorder())return void(e.valid=this.NOT_CLOSED);!c&&r.isBorder()&&(e.valid=this.NOT_RECT)}}}e.valid===this.VALID&&1!==t&&(e.valid=0===t?this.NO_LINE:this.MULTI_LINE)}},Encode:{decodePzpr:function(){this.decodeIce(),this.decodeNumber16()},encodePzpr:function(){this.encodeIce(),this.encodeNumber16()}},FileIO:{decodeData:function(){this.decodeCell(function(e,i){"#"===i?e.ques=6:"-"===i?e.qnum=-2:"."!==i&&(e.qnum=+i)}),this.decodeBorderAns(),this.decodeBorderLine()},encodeData:function(){this.encodeCell(function(e){return 6===e.ques?"# ":-2===e.qnum?"- ":0<=e.qnum?e.qnum+" ":". "}),this.encodeBorderAns(),this.encodeBorderLine()}},AnsCheck:{checklist:["checkBranchLine","checkCrossLine","checkLineOverLetter","checkAdjacency","checkEndpointIce","checkDisconnectLine","checkNumberMatch","checkRegionShape","checkRegionMultiLine","checkRegionNoLine","checkRegionEnclosed","checkDeadendLine","checkNoLine"],checkEndpointIce:function(){this.checkLineShape(function(e){var i=e.cells[0],e=e.cells[1];return i.isNum()&&e.isNum()},"lnNoIce")},checkAdjacency:function(){this.checkSideCell(function(e,i){return!(e.ice()||i.ice()||!e.path||e.path!==i.path)&&((e.by!==i.by||!e.adjborder.right.line)&&(e.bx!==i.bx||!e.adjborder.bottom.line))},"lnAdjacent")},checkDeadendLine:function(){return this.checkAllCell(function(e){return 1===e.lcnt&&-1===e.qnum&&!e.ice()},"lnDeadEnd")},checkDisconnectLine:function(){this.checkLineShape(function(e){var i=e.cells[0],e=e.cells[1];return i.ice()&&e.ice()},"lcIsolate")},checkNoLine:function(){this.checkAllCell(function(e){return!e.ice()&&0===e.lcnt},"ceNoLine")},checkNumberMatch:function(){var n=this.board;this.checkLineShape(function(e){var i=e.cells[0],e=e.cells[1],t=(i.isNum()?i:e).qnum;if(t<0)return!1;i=i.room||e.room||null;return!(!i||0!==i.valid)&&(t!==i.clist.length&&(this.checkOnly||(e=i.clist.getRectSize(),n.borderinside(e.x1-1,e.y1-1,e.x2+1,e.y2+1).seterr(1),i.clist.seterr(1)),!0))},"bkSizeNe")},checkRegionShape:function(){this.checkRegionValue(this.board.roommgr.NOT_RECT,"bkNotRect")},checkRegionEnclosed:function(){this.checkRegionValue(this.board.roommgr.NOT_CLOSED,"bkNotClosed")},checkRegionMultiLine:function(){this.checkRegionValue(this.board.roommgr.MULTI_LINE,"bkLineGt1")},checkRegionNoLine:function(){this.checkRegionValue(this.board.roommgr.NO_LINE,"bkLineLt1")},checkRegionValue:function(e,i){for(var t=this.board.roommgr.components,n=0;n<t.length;n++){var s=t[n];if(s.valid===e){if(this.failcode.add(i),this.checkOnly)break;s.clist.seterr(1)}}}}});
//# sourceMappingURL=balloon.js.map