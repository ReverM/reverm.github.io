/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["nagenawa","ringring","orbital"],{"MouseEvent@nagenawa":{inputModes:{edit:["border","number","clear","info-line"],play:["line","subcircle","subcross","clear","info-line"]}},"MouseEvent@ringring":{inputModes:{edit:["info-line"],play:["line","peke","info-line"]}},"MouseEvent@orbital":{inputModes:{edit:["number","circle-unshade","info-line"],play:["line","peke","info-line"]},mouseinput:function(){"circle-unshade"===this.inputMode?this.inputIcebarn():this.common.mouseinput.call(this)},getNewNumber:function(e,t){return"left"===this.btn&&-1===t?-3:"left"===this.btn&&-2===t?0:"left"===this.btn&&t===e.getmaxnum()?-1:"right"===this.btn&&0===t?-2:"right"===this.btn&&-1===t?e.getmaxnum():(t+="left"===this.btn?1:-1)<-3?-1:t}},MouseEvent:{mouseinput_auto:function(){this.puzzle.playmode?this.mousestart||this.mousemove?"left"===this.btn?this.inputLine():"right"===this.btn&&this.inputpeke():this.mouseend&&this.notInputted()&&(this.inputpeke_ifborder()||this.inputMB()):this.puzzle.editmode&&("nagenawa"===this.pid?this.mousestart||this.mousemove?this.inputborder():this.mouseend&&this.notInputted()&&this.inputqnum():"ringring"===this.pid?this.mousestart&&this.inputblock():"orbital"===this.pid&&this.inputqnum())},inputblock:function(){var e=this.getcell();e.isnull||(e.setQues(0===e.ques?1:0),e.draw())}},"KeyEvent@nagenawa,orbital":{enablemake:!0},"KeyEvent@orbital#1":{keyinput:function(e){var t;if("q"===e)return(t=this.cursor.getc()).setQues(6!==t.ques?6:0),void(this.prev=t).draw();this.key_inputqnum(e="w"===e?"s1":e)}},Cell:{maxnum:function(){return Math.min(999,this.room.clist.length)},minnum:0},"Cell@orbital":{maxnum:function(){return this.board.rows+this.board.cols-2<<1},noLP:function(e){return this.isNum()},getNum:function(){return this.ice()?-3:this.qnum},setNum:function(e){-3===e?this.setQues(6):(this.setQues(0),this.setQnum(e))},posthook:{qnum:function(e){-1!==e&&6===this.ques&&this.setQues(0)},ques:function(e){6===e&&this.setQnum(-1)}}},"Border@ringring,orbital":{enableLineNG:!0},Board:{cols:8,rows:8,hasborder:1},LineGraph:{enabled:!0,isLineCross:!0,setExtraData:function(e){this.common.setExtraData.call(this,e),e.bounds=null}},"LineGraph@orbital":{makeClist:!0},"AreaRoomGraph@nagenawa":{enabled:!0,hastop:!0},Graphic:{irowake:!0,gridcolor_type:"SLIGHT",numbercolor_func:"fixed",fontsizeratio:.45,textoption:{position:5},paint:function(){var e=this.pid;this.drawBGCells(),this.drawDashedGrid(),"nagenawa"===e?(this.drawQuesNumbers(),this.drawMBs(),this.drawBorders()):"ringring"===e?this.drawQuesCells():"orbital"===this.pid&&this.drawCircledNumbers(),this.drawLines(),this.drawPekes(),this.drawChassis(),this.drawTarget()}},"Graphic@ringring":{drawTarget:function(){}},"Graphic@orbital":{hideHatena:!0,fontShadecolor:"white",numbercolor_func:"fixed_shaded",getCircleStrokeColor:function(e){if(!e.ice())return null;e=e.error||e.qinfo;return 1===e||4===e?this.errcolor1:this.quescolor},getCircleFillColor:function(e){if(!e.isNum())return null;e=e.error||e.qinfo;return 1===e||4===e?this.errcolor1:this.quescolor}},"Encode@nagenawa":{decodePzpr:function(e){this.decodeBorder(),this.decodeRoomNumber16()},encodePzpr:function(e){this.encodeBorder(),this.encodeRoomNumber16()}},"Encode@ringring":{decodePzpr:function(e){this.decodeBlockCell()},encodePzpr:function(e){this.encodeBlockCell()},decodeBlockCell:function(){for(var e=0,t=0,i=this.outbstr,n=this.board,t=0;t<i.length;t++){var r=i.charAt(t);if(this.include(r,"0","9")||this.include(r,"a","z")?(e+=parseInt(r,36),n.cell[e]&&(n.cell[e].ques=1)):"."===r&&(e+=35),e++,!n.cell[e]){t++;break}}this.outbstr=i.substr(t)},encodeBlockCell:function(){for(var e="",t=0,i=this.board,n=0;n<i.cell.length;n++){var r="";1===i.cell[n].ques?r=".":t++,r?(e+=t.toString(36),t=0):36===t&&(e+=".",t=0)}this.outbstr+=e}},"Encode@orbital":{decodePzpr:function(){this.decodeIce(),this.decodeNumber16()},encodePzpr:function(){this.encodeIce(),this.encodeNumber16()}},"FileIO@nagenawa":{decodeData:function(){this.decodeAreaRoom(),this.decodeCellQnum(),this.decodeBorderLine(),this.decodeCellQsub()},encodeData:function(){this.encodeAreaRoom(),this.encodeCellQnum(),this.encodeBorderLine(),this.encodeCellQsub()}},"FileIO@ringring":{decodeData:function(){this.decodeCellBlock(),this.decodeBorderLine()},encodeData:function(){this.encodeCellBlock(),this.encodeBorderLine()},decodeCellBlock:function(){this.decodeCell(function(e,t){"1"===t&&(e.ques=1)})},encodeCellBlock:function(){this.encodeCell(function(e){return 1===e.ques?"1 ":"0 "})}},"FileIO@orbital":{decodeData:function(){this.decodeCell(function(e,t){"#"===t?e.ques=6:"-"===t?e.qnum=-2:"."!==t&&(e.qnum=+t)}),this.decodeBorderLine()},encodeData:function(){this.encodeCell(function(e){return 6===e.ques?"# ":-2===e.qnum?"- ":0<=e.qnum?e.qnum+" ":". "}),this.encodeBorderLine()}},AnsCheck:{checklist:["checkLineExist","checkLineOnShadeCell@ringring,orbital","checkOverLineCount@nagenawa","checkBranchLine","checkDeadendLine+","checkLessLineCount@nagenawa","checkAllLoopRect","checkMultipleOrbit@orbital","checkMultiplePlanets@orbital","checkOrbitNumber@orbital","checkOrbitExists@orbital","checkAllCirclePassed@orbital","checkUnreachedUnshadeCell+@ringring"],checkOverLineCount:function(){this.checkLinesInArea(this.board.roommgr,function(e,t,i,n){return n<0||i<=n},"bkLineGt")},checkLessLineCount:function(){this.checkLinesInArea(this.board.roommgr,function(e,t,i,n){return n<0||n<=i},"bkLineLt")},checkUnreachedUnshadeCell:function(){this.checkAllCell(function(e){return 0===e.ques&&0===e.lcnt},"cuNoLine")},checkAllLoopRect:function(){for(var e=!0,t=this.board,i=t.linegraph.components,n=0;n<i.length;n++){var r=i[n];if(!this.getComponentBounds(r)){if(e=!1,this.checkOnly)break;r.setedgeerr(1)}}e||(this.failcode.add("lnNotRect"),t.border.setnoerr())},getComponentBounds:function(e){var t,i=e.bounds;return null===i?(t=e.getedgeobjs(),e.bounds=this.calculateComponentBounds(t),e.bounds):i},calculateComponentBounds:function(e){for(var t=this.board,i=t.maxbx,n=t.minbx,r=t.maxby,o=t.minby,s=0;s<e.length;s++)i>e[s].bx&&(i=e[s].bx),n<e[s].bx&&(n=e[s].bx),r>e[s].by&&(r=e[s].by),o<e[s].by&&(o=e[s].by);if(0==(i&n&r&o&1))return!1;if(e.length!==n-i+(o-r))return!1;for(s=0;s<e.length;s++){var c=e[s];if(c.bx!==i&&c.bx!==n&&c.by!==r&&c.by!==o)return!1}return{x1:i,x2:n,y1:r,y2:o}}},"AnsCheck@orbital":{checkOrbitExists:function(){var t=this.getOrbitData();this.checkAllCell(function(e){return e.isNum()&&!t[e.id]},"nmNoOrbit")},checkLineOnShadeCell:function(){this.checkAllCell(function(e){return e.isNum()&&0<e.lcnt},"lnOnShade")},checkMultiplePlanets:function(){for(var e=this.board,t=e.linegraph.components,i=0;i<t.length;i++)t[i]._id=i;var n,r=this.getOrbitData(),o={},s=!0;for(n in r){var c=r[n].length;if(1===c){var c=e.cell[+n],l=r[n][0],a=l._id+"";if(a in o){if(s=!1,this.checkOnly)break;l.setedgeerr(1),c.seterr(1),o[a].seterr(1)}else o[a]=c}}s||(this.failcode.add("lpNumGt2"),this.board.border.setnoerr())},checkMultipleOrbit:function(){var e,t=this.getOrbitData(),i=!0;for(e in t){var n=t[e].length;if(1!==n){if(i=!1,this.checkOnly)break;this.board.cell[+e].seterr(1);for(var r=0;r<n;r++)t[e][r].setedgeerr(1)}}i||(this.failcode.add("nmPlOrbit"),this.board.border.setnoerr())},checkOrbitNumber:function(){var e,t=this.getOrbitData(),i=!0;for(e in t)if(1===t[e].length){var n=this.board.cell[+e];if(n.isValidNum()){var r=t[e][0].clist.filter(function(e){return e.ice()});if(r.length!==n.getNum()){if(i=!1,this.checkOnly)break;this.board.cell[+e].seterr(1),t[e][0].setedgeerr(1)}}}i||(this.failcode.add("nmOrbitNe"),this.board.border.setnoerr())},getOrbitData:function(){if(this._info.orbits)return this._info.orbits;for(var t={},e=this.board,i=e.linegraph.components,n=0;n<i.length;n++){var r=i[n],o=this.getComponentBounds(r);o&&e.cellinside(o.x1,o.y1,o.x2,o.y2).each(function(e){e.isNum()&&((e=e.id+"")in t||(t[e]=[]),t[e].push(r))})}return this._info.orbits=t},checkAllCirclePassed:function(){this.checkAllCell(function(e){return 0===e.lcnt&&e.ice()},"lnIsolate")}},"FailCode@orbital":{lnIsolate:"lnIsolate.dotchi"}});
//# sourceMappingURL=nagenawa.js.map