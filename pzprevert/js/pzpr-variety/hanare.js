/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["hanare","putteria","twinarea"],{MouseEvent:{inputModes:{edit:["border","number"],play:["objblank"]},mouseinput_number:function(){this.mousestart&&this.inputqnum_hanare()},mouseinput_auto:function(){this.puzzle.playmode?"left"===this.btn?this.mousestart?this.inputqnum_hanare():this.mousemove&&this.inputDot():"right"===this.btn&&(this.mousestart||this.mousemove)&&this.inputDot():this.puzzle.editmode&&("twinarea"===this.pid&&"right"===this.btn?this.inputIcebarn():this.mousestart||this.mousemove?this.inputborder():this.mouseend&&this.notInputted()&&this.inputqnum_hanare())},inputqnum_hanare:function(){var e,t=this.getcell();t.isnull||t===this.mouseCell||null!==(e=t.setNum_hanare(t.room.clist.length))&&(this.inputData=-1===e?0:1,(this.mouseCell=t).draw())},inputDot:function(){var e=this.getcell();e.isnull||e===this.mouseCell||-1!==e.qnum||(null===this.inputData&&(this.inputData=1===e.qsub?0:1),e.setAnum(-1),e.setQsub(1===this.inputData?1:0),(this.mouseCell=e).draw())}},"MouseEvent@putteria":{inputModes:{edit:["border","number","empty"],play:["objblank"]},inputempty:function(){var e=this.getcell();e.isnull||e===this.mouseCell||(null===this.inputData&&(this.inputData=e.isEmpty()?-1:-2),e.setQnum(this.inputData),e.setAnum(-1),e.setQsub(0),(this.mouseCell=e).draw())}},"MouseEvent@twinarea":{inputModes:{edit:["border","number","shade"],play:["objblank"]},inputShade:function(){this.inputIcebarn()}},Cell:{posthook:{qnum:function(e){this.room.checkAutoCmp()},anum:function(e){this.room.checkAutoCmp()}},setNum_hanare:function(e){if(0<=e){if(e>this.getmaxnum())return null;for(var t=this.puzzle,i=t.execConfig("singlenum"),n=this.room.clist,s=null,u=0;u<n.length;u++){if(0<n[u].qnum){s=n[u];break}if(-1!==n[u].anum&&i){s=n[u];break}}if(this===s)e=t.playmode?-2:-1;else if(null!==s){if(t.playmode&&0<s.qnum)return null;(t.editmode||i)&&(s.setNum(t.playmode?-2:-1),s.draw())}else 1===this.qsub?e=-1:-1===this.anum||i||(e=-2)}return this.setNum(e),e}},"Cell@putteria":{isNum:function(){return 0<this.qnum||0<this.anum},isEmpty:function(){return-2===this.qnum}},CellList:{checkCmp:function(){return 1===this.filter(function(e){return e.isNum()}).length}},Board:{cols:8,rows:8,hasborder:1},"Board@twinarea":{addExtraInfo:function(){this.icegraph=this.addInfoList(this.klass.AreaIcebarnGraph)}},AreaRoomGraph:{enabled:!0},"AreaIcebarnGraph:AreaGraphBase@twinarea":{enabled:!0,relation:{"cell.ques":"node"},setComponentRefs:function(e,t){e.icebarn=t},getObjNodeList:function(e){return e.icebarnnodes},resetObjNodeList:function(e){e.icebarnnodes=[]},isnodevalid:function(e){return e.ice()}},Graphic:{gridcolor_type:"DLIGHT",autocmp:"room",bgcellcolor_func:"qcmp",paint:function(){this.drawBGCells(),this.drawGrid(),this.drawDotCells(),"putteria"===this.pid&&this.drawXCells(),this.drawAnsNumbers(),this.drawQuesNumbers(),this.drawBorders(),this.drawChassis()}},"Graphic@twinarea":{autocmp:null,icecolor:"rgb(204,204,204)",qanscolor:"rgb(0, 127, 0)",trialcolor:"rgb(127, 80, 0)",bgcellcolor_func:"icebarn"},"Graphic@putteria":{getQuesNumberText:function(e){return-2===e.qnum?"":this.getNumberText(e,e.qnum)},drawXCells:function(){for(var e=this.vinc("cell_x","auto",!0),t=.2*this.cw,i=this.range.cells,n=0;n<i.length;n++){var s=i[n],u=(e.vid="c_x_"+s.id,s.bx*this.bw),r=s.by*this.bh;s.isEmpty()?(e.strokeStyle=this.quescolor,e.lineWidth=2,e.strokeCross(u,r,t)):e.vhide()}}},Encode:{decodePzpr:function(e){this.decodeBorder(),this.decodeNumber16(),"twinarea"===this.pid&&this.decodeIce()},encodePzpr:function(e){this.encodeBorder(),this.encodeNumber16(),"twinarea"===this.pid&&this.encodeIce()}},FileIO:{decodeData:function(){this.decodeBorderQues(),this.decodeCellQnum(),this.decodeCellAnumsub()},encodeData:function(){this.encodeBorderQues(),this.encodeCellQnum(),this.encodeCellAnumsub()}},"FileIO@twinarea":{decodeCellQnum:function(){this.decodeCell(function(e,t){"-"===t.charAt(0)&&(e.ques=6,t=t.substr(1)),"."!==t&&0<+t&&(e.qnum=+t)})},encodeCellQnum:function(){this.encodeCell(function(e){var t="";return 6===e.ques&&(t+="-"),-1!==e.qnum&&(t+=e.qnum.toString()),(t=""===t?".":t)+" "})}},AnsCheck:{checklist:["checkDoubleNumber","checkAnsNumberAndSize","checkDiffNumber@hanare","checkAdjacentNumber@putteria,twinarea","checkTwinAreaSums@twinarea","checkDifferentNumberInLine@putteria","checkNoNumber"],checkDiffNumber:function(){var t,i,n=!0,e=this.board;function s(e){i++,e.isNum()&&(e.isValidNum(e)?(null!==r&&Math.abs(t-e.getNum())!==i&&(this.failcode.add("nmDiffDistNe"),n=!1,r.seterr(1),e.seterr(1)),t=(r=e).getNum(),i=-1):r=null)}for(var u=e.minbx+1;u<=e.maxbx-1;u+=2)for(var r=null,o=e.minby+1;o<=e.maxby-1;o+=2)if(s.call(this,e.getc(u,o)),!n&&this.checkOnly)return;for(o=e.minby+1;o<=e.maxby-1;o+=2){r=null;for(u=e.minbx+1;u<=e.maxbx-1;u+=2)if(s.call(this,e.getc(u,o)),!n&&this.checkOnly)return}},checkAnsNumberAndSize:function(){for(var e=this.board.roommgr.components,t=0;t<e.length;t++){for(var i=e[t].clist,n=-1,s=0;s<i.length;s++)if(i[s].isNum()){n=i[s].getNum();break}if(-1!==n&&n!==i.length){if(this.failcode.add("bkSizeNe"),this.checkOnly)break;i.seterr(1)}}},checkAdjacentNumber:function(){this.checkSideCell(function(e,t){return e.isNum()&&t.isNum()},"nmAdjacent")},checkTwinAreaSums:function(){for(var e=this.board.icegraph.components,t=0;t<e.length;t++){var i=e[t].clist,n=0;if(i.each(function(e){e.isNum()&&(n+=e.getNum())}),n!==i.length){if(this.failcode.add("bkSumNe"),this.checkOnly)break;i.seterr(1)}}}}});
//# sourceMappingURL=hanare.js.map