/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(t,i){"object"==typeof module&&module.exports?module.exports=[t,i]:pzpr.classmgr.makeCustom(t,i)}(["lightup"],{MouseEvent:{use:!0,inputModes:{edit:["number","clear"],play:["akari","unshade","completion"]},mouseinput_other:function(){"akari"===this.inputMode&&this.mousestart&&this.inputcell()},mouseinput_auto:function(){this.puzzle.playmode?this.mousestart||this.mousemove&&1!==this.inputData?this.inputcell():this.mouseend&&this.notInputted()&&this.inputqcmp():this.puzzle.editmode&&this.mousestart&&this.inputqnum()},inputqcmp:function(){var t=this.getcell();t.isnull||t.noNum()||(t.setQcmp(+!t.qcmp),t.draw(),this.mousereset())}},KeyEvent:{enablemake:!0},Cell:{akariinfo:0,qlight:0,numberRemainsUnshaded:!0,maxnum:4,minnum:0,posthook:{qnum:function(t){this.setAkariInfo(t)},qans:function(t){this.setAkariInfo(t)}},isAkari:function(){return 1===this.qans},setAkariInfo:function(t){var i=0,e=this.akariinfo;-1!==this.qnum?i=2:1===this.qans&&(i=1),e!==i&&(this.akariinfo=i,this.setQlight(e,i))},setQlight:function(t,i){var e=this.akariRangeClist();if(0===t&&1===i)for(var n=0;n<e.length;n++)e[n].qlight=1;else{for(n=0;n<e.length;n++){var o=e[n],l=o.qlight;0===l&&(1===t&&0===i||0===t&&2===i)||1===l&&2===t&&0===i||(o.qlight=o.akariRangeClist().some(function(t){return t.isAkari()})?1:0)}2===i&&(this.qlight=0)}var r=this.viewRange();this.puzzle.painter.paintRange(r.x1-1,this.by-1,r.x2+1,this.by+1),this.puzzle.painter.paintRange(this.bx-1,r.y1-1,this.bx+1,r.y2+1)},akariRangeClist:function(){var t,i=new this.klass.CellList,e=this.adjacent;for(i.add(this),t=e.left;!t.isnull&&-1===t.qnum;)i.add(t),t=t.adjacent.left;for(t=e.right;!t.isnull&&-1===t.qnum;)i.add(t),t=t.adjacent.right;for(t=e.top;!t.isnull&&-1===t.qnum;)i.add(t),t=t.adjacent.top;for(t=e.bottom;!t.isnull&&-1===t.qnum;)i.add(t),t=t.adjacent.bottom;return i},viewRange:function(){for(var t={},i=this.adjacent,e=this,n=i.left;!n.isnull&&-1===n.qnum;)n=(e=n).adjacent.left;for(t.x1=e.bx,e=this,n=i.right;!n.isnull&&-1===n.qnum;)n=(e=n).adjacent.right;for(t.x2=e.bx,e=this,n=i.top;!n.isnull&&-1===n.qnum;)n=(e=n).adjacent.top;for(t.y1=e.by,e=this,n=i.bottom;!n.isnull&&-1===n.qnum;)n=(e=n).adjacent.bottom;return t.y2=e.by,t}},Board:{rebuildInfo:function(){this.initQlight()},initQlight:function(){for(var t=0;t<this.cell.length;t++)(i=this.cell[t]).qlight=0,i.akariinfo=0,-1!==i.qnum?i.akariinfo=2:1===i.qans&&(i.akariinfo=1);for(t=0;t<this.cell.length;t++){var i=this.cell[t];if(1===i.akariinfo)for(var e=i.akariRangeClist(),n=0;n<e.length;n++)e[n].qlight=1}}},Graphic:{hideHatena:!0,autocmp:"akari",gridcolor_type:"LIGHT",fgcellcolor_func:"qnum",fontShadecolor:"white",qcmpcolor:"rgb(127,127,127)",bgcellcolor_func:"light",lightcolor:"rgb(192, 255, 127)",paint:function(){this.drawBGCells(),this.drawGrid(),this.drawQuesCells(),this.drawQuesNumbers(),this.drawAkari(),this.drawDotCells(),this.drawChassis(),this.drawTarget()},getBGCellColor:function(t){if(-1===t.qnum){if(1===t.error)return this.errbcolor1;if(1===t.qlight&&this.puzzle.execConfig("autocmp"))return this.lightcolor}return null},drawAkari:function(){for(var t=this.vinc("cell_akari","auto"),i=.4*this.cw,e=this.range.cells,n=0;n<e.length;n++){var o=e[n];t.vid="c_AK_"+o.id,o.isAkari()||1===o.qansBySolver?(t.fillStyle=4===o.error?this.errcolor1:o.trial?this.trialcolor:this.getColorSolverAware(o.isAkari(),1===o.qansBySolver,"rgb(0, 127, 96)"),t.fillCircle(o.bx*this.bw,o.by*this.bh,i)):t.vhide()}},getQuesNumberColor:function(t){return 1===t.qcmp?this.qcmpcolor:this.fontShadecolor}},Encode:{decodePzpr:function(t){this.decode4Cell()},encodePzpr:function(t){this.encode4Cell()},decodeKanpen:function(){this.fio.decodeCellQnumb()},encodeKanpen:function(){this.fio.encodeCellQnumb()}},FileIO:{decodeData:function(){this.decodeCellQnumAns(),this.decodeCellQcmp()},encodeData:function(){this.encodeCellQnumAns(),this.encodeCellQcmp()},decodeCellQcmp:function(){this.decodeCell(function(t,i){"-"===i&&(t.qcmp=1)})},encodeCellQcmp:function(){this.puzzle.board.cell.some(function(t){return 1===t.qcmp})&&this.encodeCell(function(t){return 1===t.qcmp?"- ":". "})},kanpenOpen:function(){this.decodeCell(function(t,i){"+"===i?t.qans=1:"*"===i?t.qsub=1:"5"===i?t.qnum=-2:"."!==i&&(t.qnum=+i)})},kanpenSave:function(){this.encodeCell(function(t){return 1===t.qans?"+ ":1===t.qsub?"* ":0<=t.qnum?t.qnum+" ":-2===t.qnum?"5 ":". "})},kanpenOpenXML:function(){this.decodeCellQnum_XMLBoard(),this.decodeCellAns_XMLAnswer()},kanpenSaveXML:function(){this.encodeCellQnum_XMLBoard(),this.encodeCellAns_XMLAnswer()},UNDECIDED_NUM_XML:5},AnsCheck:{checklist:["checkNotDuplicateAkari","checkDir4Akari","checkShinedCell"],checkDir4Akari:function(){this.checkDir4Cell(function(t){return t.isAkari()},0,"nmAkariNe")},checkShinedCell:function(){this.checkAllCell(function(t){return t.noNum()&&1!==t.qlight},"ceDark")},checkNotDuplicateAkari:function(){this.checkRowsColsPartly(this.isPluralAkari,function(t){return t.isNum()},"akariDup")},isPluralAkari:function(t){var t=t.filter(function(t){return t.isAkari()}),i=t.length<=1;return i||t.seterr(4),i}}});
//# sourceMappingURL=lightup.js.map