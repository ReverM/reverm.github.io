/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(t,e){"object"==typeof module&&module.exports?module.exports=[t,e]:pzpr.classmgr.makeCustom(t,e)}(["hebi"],{MouseEvent:{use:!0,inputModes:{edit:["number","direc","clear"],play:["number","dragnum+","dragnum-","objblank","clear"]},mouseinput:function(){"objblank"===this.inputMode?this.inputDot_snakes():0===this.inputMode.indexOf("dragnum")?this.dragnumber_snakes():this.common.mouseinput.call(this)},mouseinput_auto:function(){this.puzzle.playmode?!this.mousestart&&!this.mousemove||this.inputDot_snakes()||this.dragnumber_snakes():this.puzzle.editmode&&(this.mousestart||this.mousemove&&this.notInputted())&&this.inputdirec(),this.mouseend&&this.notInputted()&&this.inputqnum_snakes()},dragnumber_snakes:function(){var t=this.getcell();if(!t.isnull&&t!==this.mouseCell){if(this.mouseCell.isnull)return-1!==t.qnum?this.inputData=-3:-1!==t.anum?this.inputData=t.anum:1===t.qsub?this.inputData=-2:this.inputData=10,void(this.mouseCell=t);if(-3===this.inputData&&-1===t.qnum&&(-1===t.anum&&1===t.qsub?this.inputData=10:this.inputData=-2),-1===t.qnum){if(1<=this.inputData&&this.inputData<=5){if("dragnum+"===this.inputMode||"auto"===this.inputMode&&"left"===this.btn?this.inputData++:this.inputData--,!(1<=this.inputData&&this.inputData<=5))return;t.setQdir(0),t.setAnum(this.inputData),t.setQsub(0)}else if(-2===this.inputData)t.setAnum(-1),t.setQsub(1);else{if(10!==this.inputData)return;t.setAnum(-1),t.setQsub(0)}(this.mouseCell=t).draw()}}},inputDot_snakes:function(){if("auto"===this.inputMode&&("right"!==this.btn||null!==this.inputData&&0<=this.inputData))return!1;var t=this.getcell();if(t.isnull||t===this.mouseCell)return this.inputData<0;if(null===this.inputData){var e=!1;if(-1===t.anum&&(this.inputData=1!==t.qsub?-2:-3,e=!0),"auto"===this.inputMode)return e}return t.setAnum(-1),t.setQsub(-2===this.inputData?1:0),t.draw(),this.mouseCell=t,!0},inputqnum_snakes:function(){this.getcell().isnull||(this.mouseCell=this.board.emptycell,this.inputqnum())},mouseinput_clear:function(){this.inputFixedNumber(-1)}},KeyEvent:{enablemake:!0,enableplay:!0,moveTarget:function(t){return!t.match(/shift/)&&this.moveTCell(t)},keyinput:function(t){this.puzzle.editmode&&this.key_inputdirec(t)||(!this.puzzle.playmode||"q"!==t&&"-"!==t||(t="s1"),this.key_inputqnum(t))}},Cell:{maxnum:5,minnum:function(){return this.puzzle.playmode?1:0},draw:function(){this.puzzle.getConfig("snakebd")?this.puzzle.painter.paintRange(this.bx-2,this.by-2,this.bx+2,this.by+2):this.getaddr().draw()}},Board:{hasborder:1,addExtraInfo:function(){this.snakemgr=this.addInfoList(this.klass.AreaSnakeGraph)}},BoardExec:{adjustBoardData:function(t,e){this.adjustNumberArrow(t,e)}},"AreaSnakeGraph:AreaGraphBase":{enabled:!0,relation:{"cell.anum":"node"},setComponentRefs:function(t,e){t.snake=e},getObjNodeList:function(t){return t.snakenodes},resetObjNodeList:function(t){t.snakenodes=[]},isnodevalid:function(t){return 0<t.anum},isedgevalidbynodeobj:function(t,e){return-1===t.anum==(-1===e.anum)&&1===Math.abs(t.anum-e.anum)}},Graphic:{hideHatena:!0,gridcolor_type:"LIGHT",fgcellcolor_func:"qnum",fontShadecolor:"white",numbercolor_func:"fixed_shaded",paint:function(){this.drawBGCells(),this.drawDotCells_hebiichigo(),this.drawDashedGrid(),this.drawBorders(),this.drawQuesCells(),this.drawArrowNumbers(),this.drawAnsNumbers(),this.drawChassis(),this.drawCursor()},getBorderColor:function(t){if(!this.puzzle.getConfig("snakebd"))return!1;var e=t.sidecell[0],t=t.sidecell[1];return e.isnull||t.isnull||-1!==e.qnum||-1!==t.qnum||-1===e.anum&&-1===t.anum||-1===e.anum==(-1===t.anum)&&1===Math.abs(e.anum-t.anum)?null:!e.trial&&-1!==e.anum||!t.trial&&-1!==t.anum?this.qanscolor:this.trialcolor},drawDotCells_hebiichigo:function(){for(var t=this.vinc("cell_dot","crispEdges",!0),e=Math.max(.075*this.cw,2),n=this.range.cells,i=0;i<n.length;i++){var s=n[i];t.vid="c_dot_"+s.id,1===s.qsub?(t.fillStyle=s.trial?this.trialcolor:"rgb(255, 96, 191)",t.fillRectCenter(s.bx*this.bw,s.by*this.bh,e,e)):t.vhide()}}},Encode:{decodePzpr:function(t){this.decodeArrowNumber16()},encodePzpr:function(t){this.encodeArrowNumber16()}},FileIO:{decodeData:function(){this.decodeCellDirecQnum(),this.decodeCellAnumsub()},encodeData:function(){this.encodeCellDirecQnum(),this.encodeCellAnumsub()}},AnsCheck:{checklist:["checkNumberExist","checkSnakeSize","checkOtherAnsNumberInRoom","checkSideCell_snakes","checkArrowNumber","checkSnakesView"],checkSnakeSize:function(){this.checkAllArea(this.board.snakemgr,function(t,e,n,i){return 5===n},"bkSizeNe5")},checkOtherAnsNumberInRoom:function(){this.checkDifferentNumberInRoom_main(this.board.snakemgr,this.isDifferentAnsNumberInClist)},checkSideCell_snakes:function(){for(var t=!0,e=this.board,n=0;n<e.cell.length;n++){var i=e.cell[n],s=null,a=i.adjacent.right,u=i.adjacent.bottom;if(i.snake&&(!a.isnull&&a.snake&&i.snake!==a.snake?s=a:!u.isnull&&u.snake&&i.snake!==u.snake&&(s=u),s)){if(t=!1,this.checkOnly)break;i.snake.clist.seterr(1),s.snake.clist.seterr(1)}}t||this.failcode.add("bsSnake")},checkArrowNumber:function(){var t,e,n=!0,i=this.board;function s(t){return!t.isnull&&-1===t.qnum&&-1!==t.anum}for(var a=0;a<i.cell.length;a++){var u=i.cell[a],r=u.qnum,l=u.qdir;if(!(r<0||0===l)){for((e=u.getaddr()).movedir(l,2);!(t=e.getc()).isnull&&-1===t.qnum&&-1===t.anum;)e.movedir(l,2);if(0===r&&s(t)){if(n=!1,this.checkOnly)break;u.seterr(1),t.seterr(1)}else if(0<r&&(!s(t)||t.anum!==r)){if(n=!1,this.checkOnly)break;u.seterr(1),s(t)&&t.seterr(1)}}}n||this.failcode.add("anNumberNe")},checkSnakesView:function(){for(var t=this.board.snakemgr.components,e=0;e<t.length;e++){var n=t[e].clist,i=n.filter(function(t){return 1===t.anum})[0];if(i){var s=i.NDIR,a=i.adjacent,u=a.bottom;if(u.isnull||2!==u.anum||(s=i.UP),(u=a.top).isnull||2!==u.anum||(s=i.DN),(u=a.right).isnull||2!==u.anum||(s=i.LT),(s=(u=a.left).isnull||2!==u.anum?s:i.RT)!==i.NDIR){var r=i.getaddr(),l=new this.klass.CellList;for(l.add(i);!i.isnull&&(r.movedir(s,2),(i=r.getc()).isnull||l.add(i),!i.isnull&&-1===i.qnum&&-1===i.anum););if(!(i.isnull||i.anum<=0||-1!==i.qnum||null===i.snake||i.snake===t[e])){if(this.failcode.add("snakeAttack"),this.checkOnly)break;l.seterr(1),n.seterr(1),i.snake.clist.seterr(1)}}}}}}});
//# sourceMappingURL=hebi.js.map