/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["kaero","armyants","oyakodori"],{MouseEvent:{inputModes:{edit:["border","number","clear"],play:["line","peke","bgcolor","bgcolor1","bgcolor2","clear"]},mouseinput_auto:function(){this.puzzle.playmode?this.mousestart||this.mousemove?"left"===this.btn?this.inputLine():"right"===this.btn&&this.inputpeke():this.mouseend&&this.notInputted()&&this.inputlight():this.puzzle.editmode&&(this.mousestart||this.mousemove?this.inputborder():this.mouseend&&this.notInputted()&&this.inputqnum())},inputlight:function(){var e=this.getcell();e.isnull||(0===e.qsub?e.setQsub("left"===this.btn?1:2):1===e.qsub?e.setQsub("left"===this.btn?2:0):2===e.qsub&&e.setQsub("left"===this.btn?0:1),e.draw())}},"MouseEvent@oyakodori":{inputModes:{edit:["border","circle-shade","circle-unshade","shade","clear"],play:["line","peke","clear"]},mouseinput_auto:function(){var e;this.puzzle.playmode?this.mousestart||this.mousemove?"left"===this.btn?this.inputLine():"right"===this.btn&&this.inputpeke():this.mouseend&&this.notInputted()&&this.inputlight():this.puzzle.editmode&&!(e=this.getcell()).isnull&&("left"===this.btn&&(this.mousestart||this.mousemove)?this.inputborder():(!this.mousestart||"right"===this.btn&&e!==this.cursor.getc()||(this.inputData=-1),this.mousestart&&e!==this.cursor.getc()&&"right"===this.btn||this.mousemove&&0<=this.inputData?this.inputShade():this.mouseend&&this.notInputted()&&(e!==this.cursor.getc()&&"auto"===this.inputMode&&"left"===this.btn?this.setcursor(e):this.inputqnum(e))))},inputShade:function(){this.inputIcebarn()}},KeyEvent:{enablemake:!0},"KeyEvent@oyakodori":{keyinput:function(e){var t;"q"===e?((t=this.cursor.getc()).setQues(6!==t.ques?6:0),(this.prev=t).draw()):this.key_inputqnum(e)}},"Cell@kaero":{numberAsLetter:!0,maxnum:52},"Cell@armyants":{maxnum:function(){var e=this.board.cell.length;return e<=999?e:999},getNextStepCell:function(e){for(var t=this.antnodes[0].nodes,n=[],i=0;i<t.length;++i){var r=t[i].obj;r.base.qnum!==e+1&&-2!==r.base.qnum||n.push({dir:this.getdir(r,2),cell:r})}return n}},"Cell@oyakodori":{maxnum:2,disInputHatena:!0},CellList:{getDeparture:function(){return this.map(function(e){return e.base}).notnull()}},"CellList@armyants":{isCmp:function(){if(1===this.length&&(1===this[0].base.qnum||-2===this[0].base.qnum))return!0;var e=this.filter(function(e){return 1===e.base.qnum})[0];if(e)return this.traceNumber(e);for(var t=this.filter(function(e){return-2===e.base.qnum}),n=0;n<t.length;++n)if(this.traceNumber(t[n]))return!0;return!1},traceNumber:function(e){for(var t=[{prev:null,cell:e,next:e.getNextStepCell(1)}];0<t.length&&t.length<this.length;){for(var n=t[t.length-1],i=n.cell,r=null;!r&&0<n.next.length;){var s=n.next.shift().cell;s!==n.prev&&(r={prev:i,cell:s,next:s.getNextStepCell(t.length+1)})}r?t.push(r):t.pop()}return t.length>=this.length}},"Border@armyants":{enableLineNG:!0,isLineNG:function(){return this.isBorder()}},"Border@oyakodori":{prehook:{line:function(e){return!(!e||!this.puzzle.execConfig("dispmove"))&&(2===(this.sidecell[0].path||this.sidecell[1].path).departure.qnum&&this.isBorder())}}},Board:{cols:6,rows:6,hasborder:1},"Board@armyants":{addExtraInfo:function(){this.antmgr=this.addInfoList(this.klass.AreaAntGraph)}},"Board@oyakodori":{addExtraInfo:function(){this.nestmgr=this.addInfoList(this.klass.AreaNestGraph)}},LineGraph:{enabled:!0,moveline:!0},"LineGraph@oyakodori":{setExtraData:function(e){this.common.setExtraData.call(this,e),e.blist=new this.klass.BorderList(e.getedgeobjs())}},"AreaRoomGraph@kaero":{enabled:!0},"AreaAntGraph:AreaGraphBase@armyants":{enabled:!0,relation:{"cell.qnum":"node","border.line":"move"},setComponentRefs:function(e,t){e.ant=t},getObjNodeList:function(e){return e.antnodes},resetObjNodeList:function(e){e.antnodes=[]},isnodevalid:function(e){return-1!==e.base.qnum},isedgevalidbynodeobj:function(e,t){e=e.base.qnum,t=t.base.qnum;return-2===e||-2===t||-1===e==(-1===t)&&1===Math.abs(e-t)},modifyOtherInfo:function(e,t){this.setEdgeByNodeObj(e.sidecell[0]),this.setEdgeByNodeObj(e.sidecell[1])}},"AreaNestGraph:AreaGraphBase":{enabled:!0,relation:{"cell.ques":"node","border.ques":"separator"},setComponentRefs:function(e,t){e.nest=t},getObjNodeList:function(e){return e.nestnodes},resetObjNodeList:function(e){e.nestnodes=[]},isedgevalidbylinkobj:function(e){return!e.isBorder()},isnodevalid:function(e){return e.ice()}},Graphic:{gridcolor_type:"LIGHT",bgcellcolor_func:"qsub2",numbercolor_func:"move",qsubcolor1:"rgb(224, 224, 255)",qsubcolor2:"rgb(255, 255, 144)",paint:function(){this.drawBGCells(),this.drawDashedGrid(),this.drawBorders(),this.drawTip(),this.drawPekes(),this.drawDepartures(),this.drawLines(),"oyakodori"===this.pid?this.drawCircles():(this.drawCellSquare(),this.drawQuesNumbers()),this.drawChassis(),this.drawTarget()},drawCellSquare:function(){for(var e=this.vinc("cell_number_base","crispEdges",!0),t=.7*this.bw-1,n=.7*this.bh-1,i=this.puzzle.execConfig("dispmove"),r=this.range.cells,s=0;s<r.length;s++){var o=r[s];e.vid="c_sq_"+o.id,!i&&o.isDeparture()||i&&o.isDestination()?(1===o.error?e.fillStyle=this.errbcolor1:1===o.qsub?e.fillStyle=this.qsubcolor1:2===o.qsub?e.fillStyle=this.qsubcolor2:e.fillStyle=this.bgcolor,e.fillRectCenter(o.bx*this.bw,o.by*this.bh,t,n)):e.vhide()}}},"Graphic@oyakodori":{bgcellcolor_func:"icebarn",icecolor:"rgb(204,204,204)",circleratio:[.35,.3],movelinecolor:"#444444",getCircleFillColor:function(e){var t=this.puzzle.execConfig("dispmove"),n=(t?e.base:e).qnum,t=(t?e.base:e).error;return 1===n?1===t?this.errbcolor1:"white":2===n?1===t?this.errcolor1:this.quescolor:null}},Encode:{decodePzpr:function(e){this.decodeBorder(),"oyakodori"===this.pid?(this.decodeCircle(),this.decodeIce()):"kaero"===this.pid?this.decodeKaero():this.decodeNumber16()},encodePzpr:function(e){this.encodeBorder(),"oyakodori"===this.pid?(this.encodeCircle(),this.encodeIce()):"kaero"===this.pid?this.encodeKaero():this.encodeNumber16()},decodeKaero:function(){for(var e=0,t=0,n=this.outbstr,i=this.board,r=0;r<n.length;r++){var s=n.charAt(r),o=i.cell[e];if(this.include(s,"0","9")?o.qnum=parseInt(s,36)+27:this.include(s,"A","Z")?o.qnum=parseInt(s,36)-9:"-"===s?(o.qnum=parseInt(n.charAt(r+1),36)+37,r++):"."===s?o.qnum=-2:this.include(s,"a","z")&&(e+=parseInt(s,36)-10),e++,!i.cell[e]){t=r+1;break}}this.outbstr=n.substring(t)},encodeKaero:function(){for(var e="",t=0,n=this.board,i=0;i<n.cell.length;i++){var r="",s=n.cell[i].qnum;-2===s?r=".":1<=s&&s<=26?r=""+(s+9).toString(36).toUpperCase():27<=s&&s<=36?r=""+(s-27).toString(10):37<=s&&s<=72?r="-"+(s-37).toString(36).toUpperCase():t++,0===t?e+=r:!r&&26!==t||(e+=(9+t).toString(36).toLowerCase()+r,t=0)}0<t&&(e+=(9+t).toString(36).toLowerCase()),this.outbstr+=e}},FileIO:{decodeData:function(){this.decodeCellQnum(),this.decodeCellQanssub(),this.decodeBorderQues(),this.decodeBorderLine()},encodeData:function(){this.encodeCellQnum(),this.encodeCellQanssub(),this.encodeBorderQues(),this.encodeBorderLine()}},"FileIO@oyakodori":{decodeCellQnum:function(){this.decodeCell(function(e,t){"."!==t&&(8&(t=+t)&&(e.ques=6),e.qnum=(-9&t)-2)})},encodeCellQnum:function(){this.encodeCell(function(e){e=e.qnum+2|(6===e.ques?8:0);return 1!=e?e+" ":". "})},decodeCellQanssub:function(){},encodeCellQanssub:function(){}},"AnsCheck@kaero#1":{checklist:["checkBranchLine","checkCrossLine","checkConnectObject","checkLineOverLetter","checkSameObjectInRoom_kaero","checkGatheredObject","checkNoObjectBlock","checkDisconnectLine"]},"AnsCheck@armyants#1":{checklist:["checkBranchLine","checkCrossLine","checkConnectObject","checkLineOverLetter","checkLineOverBorder","checkUniqueNumberInBlock","checkNumberWithinSize","checkSideCell_ants","checkAntNumber","checkDisconnectLine","checkNumberExist"]},"AnsCheck@oyakodori#1":{checklist:["checkBranchLine","checkCrossLine","checkConnectObject","checkLineOverLetter","checkLineOverNest","checkMultiCircle","checkBlackIntersect","checkWhiteNoIntersect","checkSingleCircle","checkCircleMatch","checkCircleOutsideNest","checkDisconnectLine"]},"AnsCheck@kaero":{checkSameObjectInRoom_kaero:function(){var e=this.board.roommgr.components;e:for(var t=0;t<e.length;t++)for(var n=e[t].clist,i=-1,r=n.getDeparture(),s=0;s<r.length;s++){var o=r[s].qnum;if(-1===i)i=o;else if(i!==o){if(this.failcode.add("bkPlNum"),this.checkOnly)break e;this.puzzle.execConfig("dispmove")||r.seterr(4),n.seterr(1)}}},checkGatheredObject:function(){for(var e=0,t=this.board,n=0;n<t.cell.length;n++)e<(i=t.cell[n].base.qnum)&&(e=i);e:for(var i=0;i<=e;i++)for(var r=t.cell.filter(function(e){return i===e.base.qnum}),s=null,o=0;o<r.length;o++){var c=r[o].room;if(null===s)s=c;else if(null!==c&&s!==c){this.failcode.add("bkSepNum"),this.puzzle.execConfig("dispmove")||r.getDeparture().seterr(4),r.seterr(1);break e}}},checkNoObjectBlock:function(){this.checkNoMovedObjectInRoom(this.board.roommgr)}},"AnsCheck@armyants":{checkLineOverBorder:function(){for(var e=this.board,t=!0,n=0;n<e.border.length;n++){var i=e.border[n];if(i.isBorder()&&i.isLine()){if(t=!1,this.checkOnly)break;i.seterr(1)}}t||(this.failcode.add("laOnBorder"),e.border.setnoerr())},checkUniqueNumberInBlock:function(){this.checkDifferentNumberInRoom_main(this.board.antmgr,this.isDifferentNumberInClistBase)},isDifferentNumberInClistBase:function(e){return this.isIndividualObject(e,function(e){return e.base.qnum})},checkNumberWithinSize:function(){this.checkAllCell(function(e){return e.ant&&e.base.qnum>e.ant.clist.length},"ceNumGtSize")},checkAntNumber:function(){for(var e=this.board.antmgr.components,t=0;t<e.length;t++){var n=e[t];if(!n.clist.isCmp()){if(this.failcode.add("bkWrongNum"),this.checkOnly)break;this.board.cell.setnoerr(),n.clist.seterr(1)}}},checkSideCell_ants:function(){for(var e=!0,t=this.board,n=0;n<t.cell.length;n++){var i=t.cell[n],r=null,s=i.adjacent.right,o=i.adjacent.bottom;if(i.ant&&(!s.isnull&&s.ant&&i.ant!==s.ant?r=s:!o.isnull&&o.ant&&i.ant!==o.ant&&(r=o),r)){if(e=!1,this.checkOnly)break;i.ant.clist.seterr(1),r.ant.clist.seterr(1)}}e||this.failcode.add("bsAnt")}},"AnsCheck@oyakodori":{checkLineOverNest:function(){this.checkAllCell(function(e){return 2<=e.lcnt&&e.ice()},"laOnIce")},checkBlackIntersect:function(){for(var e=this.board.linegraph.components,t=0;t<e.length;t++){var n=e[t];if(2===n.departure.qnum){var i=n.blist.filter(function(e){return e.isBorder()});if(0!==i.length){if(this.failcode.add("laShadeOnBorder"),this.checkOnly)break;this.board.border.setnoerr(),i.seterr(1),n.departure.seterr(1)}}}},checkWhiteNoIntersect:function(){for(var e=this.board.linegraph.components,t=0;t<e.length;t++){var n=e[t];if(1===n.departure.qnum&&n.destination.ice()&&!n.blist.some(function(e){return e.isBorder()})){if(this.failcode.add("laUnshadeNoBorder"),this.checkOnly)break;this.board.border.setnoerr(),n.blist.seterr(1),n.departure.seterr(1)}}},checkCircleOutsideNest:function(){this.checkAllCell(function(e){return e.isDestination()&&!e.ice()},"nmOutOfBk")},checkSingleCircle:function(){this.checkAllBlock(this.board.nestmgr,function(e){return-1!==e.base.qnum},function(e,t,n,i){return e*t==1||1!==n},"nmLt2")},checkMultiCircle:function(){this.checkAllBlock(this.board.nestmgr,function(e){return-1!==e.base.qnum},function(e,t,n,i){return n<=2},"nmGt2")},checkCircleMatch:function(){for(var e=this.board.nestmgr.components,t=0;t<e.length;t++){var n=e[t].clist,i=n.filter(function(e){return-1!==e.base.qnum});if(2===i.length&&i[0].base.qnum===i[1].base.qnum){if(this.failcode.add("nmNumberEq"),this.checkOnly)break;n.seterr(1)}}}}});
//# sourceMappingURL=kaero.js.map