/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["anglers"],{MouseEvent:{inputModes:{edit:["number","shade","clear"],play:["line","peke"]},autoedit_func:"qnum",autoplay_func:"line",inputqnum:function(){var e=this.getcell_excell();e.isnull||e===this.mouseCell||(e!==this.cursor.getc()&&e!==this.cursor.getex()?this.setcursor(e):this.inputqnum_main(e),this.mouseCell=e)},inputShade:function(){return this.inputFixedNumber(-3)},mouseinput_clear:function(){return this.inputFixedNumber(-1)}},KeyEvent:{enablemake:!0,keyinput:function(e){var t=this.cursor.getex();t.isnull?this.key_inputqnum(e):this.key_inputqnum_main(t,e)},getNewNumber:function(e,t,n){if(0===e.getminnum()){if("q"===t)return-3;if("w"===t)return 0}return this.common.getNewNumber.call(this,e,t,n)}},ExCell:{maxnum:function(){return this.board.cols*this.board.rows},posthook:{qnum:function(){this.path&&this.board.linegraph.setExtraData(this.path)}}},Cell:{minnum:0,maxnum:function(){return this.board.cols*this.board.rows},posthook:{qnum:function(){this.path&&this.board.linegraph.setExtraData(this.path)}}},Board:{hasexcell:2,hasborder:2},Border:{isBorder:function(){return-3===this.sidecell[0].qnum||-3===this.sidecell[1].qnum},prehook:{line:function(e){return e&&!!this.sidecell.find(function(e){return-3===e.qnum||"excell"===e.group&&-1===e.qnum})},qsub:function(e){return e&&!this.inside}}},LineGraph:{enabled:!0,makeClist:!0,rebuild2:function(){for(var e=this.board.excell,t=0;t<e.length;t++)this.setComponentRefs(e[t],null),this.resetObjNodeList(e[t]);this.common.rebuild2.call(this)},setExtraData:function(e){this.common.setExtraData.call(this,e),e.fishcount=e.clist.filter(function(e){return 0===e.qnum}).length,e.numcount=e.clist.filter(function(e){return-2===e.qnum||0<e.qnum}).length}},Graphic:{irowake:!0,gridcolor_type:"LIGHT",paint:function(){this.drawBGCells(),this.drawGrid(),this.drawQuesCells(),this.drawBorders(),this.drawLines(),this.drawPekes(),this.drawCellSquare(),this.drawQuesNumbers(),this.drawNumbersExCell(),this.drawFish(),this.drawChassis(),this.drawTarget()},drawCellSquare:function(){for(var e=this.vinc("cell_number_base","crispEdges",!0),t=.7*this.bw-1,n=.7*this.bh-1,i=this.range.cells,l=0;l<i.length;l++){var r=i[l];e.vid="c_sq_"+r.id,-2===r.qnum||0<r.qnum?(e.fillStyle=1===r.error?this.errbcolor1:this.bgcolor,e.fillRectCenter(r.bx*this.bw,r.by*this.bh,t,n)):e.vhide()}for(var t=this.bw-2,n=this.bh-2,h=this.range.excells,l=0;l<h.length;l++){r=h[l];e.vid="x_sq_"+r.id,-2===r.qnum||0<r.qnum?(e.fillStyle=1===r.error?this.errbcolor1:this.bgcolor,e.fillRectCenter(r.bx*this.bw,r.by*this.bh,t,n)):e.vhide()}},getQuesNumberText:function(e){return 0===e.qnum?null:this.getNumberTextCore(e.qnum)},drawFish:function(){for(var e=this.vinc("cell_fish","auto"),t=(e.lineWidth=2+this.cw/30|0,.45*this.cw),n=90*Math.PI/180,i=180*Math.PI/180,l=270*Math.PI/180,r=0*Math.PI/180,h=0;h<this.board.cell.length;h++){var s,o,c,u,a,d,f=this.board.cell[h];0!==f.qnum?(e.vid="f_outline_"+f.id,e.vhide(),e.vid="f_fill_"+f.id,e.vhide(),e.vid="f_tail_"+f.id,e.vhide()):(c=f.bx,u=f.by,c=(c-.15)*this.bw,u=(u-.15)*this.bh,s=c+.45*this.bw,o=u-.45*this.bh,c=c-.45*this.bw,u=u+.45*this.bh,a=s+t*Math.cos(n),d=o+t*Math.sin(n),e.strokeStyle=this.getQuesNumberColor(f),e.fillStyle=this.getBGCellColor(f)?null:"#aaddff",e.vid="f_fill_"+f.id,e.beginPath(),e.moveTo(s+t*Math.cos(n),o+t*Math.sin(n)),e.arc(s,o,t,n,i,!1),e.arc(c,u,t,l,r,!1),e.fill(),e.vid="f_outline_"+f.id,e.stroke(),e.vid="f_tail_"+f.id,e.beginPath(),e.moveTo(a+.35*this.bw,d),e.lineTo(a,d),e.lineTo(a,d+.35*this.bh),e.stroke())}},getBGCellColor:function(e){return-3===e.qnum?e.error?this.errcolor1:this.quescolor:e.error?this.errbcolor1:null}},Encode:{decodePzpr:function(e){var n=this.board,i=n.cell.length;this.genericDecodeNumber16(i+n.excell.length,function(e,t){(e<i?n.cell[e]:n.excell[e-i]).qnum=0===t?-3:0<t?t-1:t})},encodePzpr:function(e){var t=this.board,n=t.cell.length;this.genericEncodeNumber16(n+t.excell.length,function(e){e=e<n?t.cell[e]:t.excell[e-n];return-3===e.qnum?0:0<=e.qnum?e.qnum+1:e.qnum})}},FileIO:{decodeData:function(){this.decodeCellExCell(function(e,t){"."!==t&&(e.qnum="#"===t?-3:+t)}),this.decodeBorderLine()},encodeData:function(){this.encodeCellExCell(function(e){return-3===e.qnum?"# ":-1!==e.qnum?e.qnum+" ":". "}),this.encodeBorderLine()}},AnsCheck:{checklist:["checkBranchLine","checkCrossLine","checkLineOnShade","checkLineOverLetter","checkLineTooLong","checkLineTooShort","checkLineHasFish","checkLineHasNumber","checkVisited","checkNoLine+"],checkLineOnShade:function(){this.checkAllCellExcell(function(e){return e.qnum===("excell"===e.group?-1:-3)&&e.pathnodes&&0<e.pathnodes.length},"lnOnShade")},checkAllCellExcell:function(e,t){for(var n=this.board,i=-1;i<=n.maxby;i+=2)for(var l=-1;l<=n.maxbx;l+=2){var r=n.getobj(l,i);if(e(r)){if(this.failcode.add(t),this.checkOnly)break;r.seterr(1)}}},checkVisited:function(){this.checkAllCellExcell(function(e){return-1!==e.qnum&&-3!==e.qnum&&0===e.pathnodes.length},"lnIsolate")},checkAllPath:function(e,t){for(var n=this.board,i=n.linegraph.components,l=0;l<i.length;l++){var r=i[l];if(e(r)){if(this.failcode.add(t),this.checkOnly)break;n.border.setnoerr(),r.setedgeerr(1)}}},checkLineHasFish:function(){this.checkAllPath(function(e){return 0===e.fishcount},"lnNoFish")},checkLineHasNumber:function(){this.checkAllPath(function(e){return 0===e.numcount},"lnNoNum")},checkLineTooLong:function(){this.checkAllCellExcell(function(e){return 0<e.qnum&&e.path&&e.path.clist.length>e.qnum+1},"lnLenGt")},checkLineTooShort:function(){this.checkAllCellExcell(function(e){return 0<e.qnum&&e.path&&e.path.fishcount&&e.path.clist.length<e.qnum+1},"lnLenLt")},checkNoLine:function(){this.checkAllCell(function(e){return-3!==e.qnum&&0===e.lcnt},"ceNoLine")}}});
//# sourceMappingURL=anglers.js.map