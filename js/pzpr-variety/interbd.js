/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["interbd"],{MouseEvent:{use:!0,inputModes:{edit:["number","color","color-","clear"],play:["shade","unshade"]},mouseinput_auto:function(){this.puzzle.playmode?(this.mousestart||this.mousemove)&&this.inputcell():this.puzzle.editmode&&this.mousestart&&this.mouseinput_numcolor()},mouseinput_numcolor:function(){var e=this.getcell();e.isnull||e===this.mouseCell||(e!==this.cursor.getc()?this.setcursor(e):(this.setNewNumColor(e),e.draw()),this.mouseCell=e)},setNewNumColor:function(e){var t=e.getNumColor();"left"===this.btn?65===t?e.setNumColor(-1):-1===t?e.setNumColor(0):60<=t?e.setNumColor(t%10+1):e.setNumColor(t+10):"right"===this.btn&&(-1===t?e.setNumColor(65):0===t?e.setNumColor(-1):t<10?e.setNumColor(t+59):e.setNumColor(t-10))},getNewNumber:function(e,t){var s=0!==e.ques,i=e.getmaxnum(),e=e.getminnum(),o=-1;return"left"===this.btn?o=i<=t?s?-2:-1:-1===t?-2:t<e?e:t+1:"right"===this.btn&&(o=-1===t||i<t||-2===t&&s?i:t<=e?-2:-2===t?-1:t-1),o},mouseinput_other:function(){!this.mousestart||"left"!==this.btn&&"right"!==this.btn||"color"!==this.inputMode&&"color-"!==this.inputMode||this.mouseinput_color()},mouseinput_color:function(){var e=this.getcell();e.isnull||e===this.mouseCell||(e!==this.cursor.getc()?this.setcursor(e):(this.setNewQues(e),e.draw()),this.mouseCell=e)},setNewQues:function(e){var t=e.ques,s=e.qnum;"left"===this.btn?6<=t?(-2===s&&e.setQnum(-1),e.setQues(0)):0===t&&-1===s?e.setNum(-2):e.setQues(t+1):0===t?-2===s?e.setQnum(-1):(-1===s&&e.setNum(-2),e.setQues(6)):e.setQues(t-1)}},KeyEvent:{enablemake:!0,keyinput:function(e){"-"===e?this.key_undef():this.key_interbd(e)},keyrows:["qwerty","asdfgh","zxcvbn"],key_undef:function(){var e=this.cursor.getc();-2!==e.qnum?e.setQnum(-2):0!==e.ques?e.setQues(0):e.setQnum(-1),e.draw()},key_interbd:function(e){var t,s=this.cursor.getc(),i=-1;for(t in this.keyrows)if(-1!==(i=this.keyrows[t].indexOf(e))){i+=1;break}-1!==i?(s.ques!==i||-1===s.qnum?s.setQues(i):(s.setQues(0),i=-1),-1===i&&-2===s.qnum?s.setQnum(-1):-1===s.qnum&&s.setNum(-2),s.draw()):this.key_inputqnum(e)}},Cell:{numberRemainsUnshaded:!0,minnum:0,maxnum:4,getNumColor:function(){if(-1===this.qnum&&0===this.ques)return-1;var e=this.qnum<0?0:this.qnum+1;return 10*this.ques+e},setNumColor:function(e){var t;e<0?(this.setQnum(-1),this.setQues(0)):(this.setQnum(0<(t=e%10)?t-1:-2),this.setQues(e/10|0),this.setQans(0),this.setQsub(0))},posthook:{qnum:function(e){-1===e&&this.setQues(0)}}},AreaUnshadeGraph:{enabled:!0},Graphic:{numbercolor_func:"qnum",qanscolor:"black",circleratio:[.43,.37],colors:["gray","red","blue","green","#c000c0","#ff8000","#00c0c0"],paint:function(){this.drawBGCells(),this.drawShadedCells(),this.drawDotCells(),this.drawGrid(),this.drawCircles(),this.drawQuesMarks(),this.drawQuesNumbers(),this.drawChassis(),this.drawTarget()},getCircleStrokeColor:function(e){return 1!==this.puzzle.getConfig("disptype_interbd")?null:e.ques<1||6<e.ques?-1!==e.qnum?this.colors[0]:null:this.colors[e.ques]},getQuesNumberText:function(e){return-2!==e.qnum||1!==this.puzzle.getConfig("disptype_interbd")&&0===e.ques?this.getNumberText(e,e.qnum):""},getQuesNumberColor:function(e){return 2===this.puzzle.getConfig("disptype_interbd")||3===this.puzzle.getConfig("disptype_interbd")&&0===e.ques?this.quescolor:this.colors[e.ques]},getNumberVerticalOffset:function(e){return this.fontsizeratio=1===this.puzzle.getConfig("disptype_interbd")?.65:.45,1!==this.puzzle.getConfig("disptype_interbd")&&3===e.ques?.1*this.cw:0},drawQuesMarks:function(){for(var e=this.vinc("cell_mark","auto"),t=this.puzzle.getConfig("disptype_interbd"),s=(e.lineWidth=Math.max(this.cw/18,2),.4*this.cw),i=.867*s,o=s,r=Math.sin(.4*Math.PI)*s,n=Math.cos(.4*Math.PI)*s,u=Math.sin(.8*Math.PI)*s,h=Math.cos(.8*Math.PI)*s,c=Math.sin(.333*Math.PI)*s,l=Math.cos(.333*Math.PI)*s,a=this.range.cells,d=0;d<a.length;d++){var m=a[d];if(e.vid="c_mk_"+m.id,1===t)e.vhide();else{e.strokeStyle=2===t?this.quescolor:this.colors[m.ques];var f=m.bx*this.bw,b=m.by*this.bh;switch(m.ques){case 1:e.strokeCircle(f,b,s);break;case 2:e.beginPath(),e.setOffsetLinePath(f,b,0,-s,s,0,0,s,-s,0,!0),e.stroke();break;case 3:e.beginPath(),e.setOffsetLinePath(f,b,0,-i,-o,i,o,i,!0),e.stroke();break;case 4:e.strokeRectCenter(f,b,s,s);break;case 5:e.beginPath(),e.setOffsetLinePath(f,b,0,-s,-r,-n,-u,-h,u,-h,r,-n,!0),e.stroke();break;case 6:e.beginPath(),e.setOffsetLinePath(f,b,s,0,l,c,-l,c,-s,0,-l,-c,l,-c,!0),e.stroke();break;default:e.vhide()}}}}},Encode:{decodePzpr:function(e){this.decodeNumColor()},encodePzpr:function(e){this.encodeNumColor()},decodeNumColor:function(){for(var e=0,t=0,s=this.outbstr,i=this.board;t<s.length&&i.cell[e];){var o=i.cell[e],r=s.charAt(t),n=this.readNumber16(s,t);-1!==n[0]?(o.setNumColor(n[0]),t+=n[1],e++):("g"<=r&&r<="z"&&(e+=parseInt(r,36)-15),t++)}this.outbstr=s.substr(t)},encodeNumColor:function(){for(var e=0,t="",s=this.board,i=0;i<s.cell.length;i++){var o=s.cell[i].getNumColor(),o=this.writeNumber16(o);""===o&&e++,0===e?t+=o:!o&&20!==e||(t+=(15+e).toString(36)+o,e=0)}0<e&&(t+=(15+e).toString(36)),this.outbstr+=t}},FileIO:{decodeData:function(){this.decodeCellNumColorAns()},encodeData:function(){this.encodeCellNumColorAns()},decodeCellNumColorAns:function(){this.decodeCell(function(e,t){"#"===t?e.qans=1:"+"===t?e.qsub=1:"."!==t&&e.setNumColor(+t)})},encodeCellNumColorAns:function(){this.encodeCell(function(e){var t=e.getNumColor();return 0<=t?t+" ":1===e.qans?"# ":1===e.qsub?"+ ":". "})}},AnsCheck:{checklist:["checkDir4ShadeOver","checkNoColor","checkSurrounded","checkSeparated","checkColors","checkDir4ShadeLess+","checkDivision"],checkDir4ShadeOver:function(){this.checkDir4Cell(function(e){return e.isShade()},2,"nmShadeGt")},checkDir4ShadeLess:function(){this.checkDir4Cell(function(e){return e.isShade()},1,"nmShadeLt")},checkColors:function(){this.checkSameObjectInRoom(this.board.ublkmgr,function(e){return e.ques-1},"bkPlColor")},checkNoColor:function(){this.checkAllBlock(this.board.ublkmgr,function(e){return 0<e.ques},function(e,t,s,i){return 0!==s},"bkNoColor")},checkSurrounded:function(){for(var e=0;e<this.board.cell.length;e++){var t=this.board.cell[e];if(t.isShade()){var s=t.countDir4Cell(function(e){return!e.isShade()});if(!(2<=s)){if(this.failcode.add("shSurrounded"),this.checkOnly)break;t.seterr(1)}}}},checkSeparated:function(){this.checkGatheredObjectInGraph(this.board.ublkmgr,function(e){return e.ques||-1},"bkSepColor")},checkDivision:function(){for(var e=0;e<this.board.cell.length;e++){var t=this.board.cell[e];if(1===t.qans){var s=t.getdir4clist().filter(function(e){return!e[0].isShade()});if(!(s.length<2)){for(var i=s[0][0].ublk,o=!1,r=1;r<s.length;r++)if(s[r][0].ublk!==i){o=!0;break}if(!o){if(this.failcode.add("shNoDivide"),this.checkOnly)break;t.seterr(1)}}}}}}});
//# sourceMappingURL=interbd.js.map