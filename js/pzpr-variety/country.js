/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e){var i=["country","moonsun","onsen","doubleback","maxi","simpleloop","detour","dotchi","ovotovata","rassi","remlen","nothing","dotchi2"];"object"==typeof module&&module.exports?module.exports=[i,e]:pzpr.classmgr.makeCustom(i,e)}({"MouseEvent@country,onsen,detour":{inputModes:{edit:["border","number","clear","info-line"],play:["line","peke","subcircle","subcross","clear","info-line"]}},"MouseEvent@maxi":{inputModes:{edit:["border","number","clear","info-line"],play:["line","peke","clear","info-line"]}},"MouseEvent@moonsun":{inputModes:{edit:["border","moon","sun","clear","info-line"],play:["line","peke","clear","info-line"]},mouseinput_other:function(){switch(this.inputMode){case"sun":this.inputFixedNumber(1);break;case"moon":this.inputFixedNumber(2)}}},"MouseEvent@doubleback":{inputModes:{edit:["border","clear","info-line","empty"],play:["line","peke","clear","info-line"]}},"MouseEvent@nothing":{inputModes:{edit:["border","clear","info-line"],play:["line","peke","shade","unshade","clear","info-line"]},inputdragcross:function(){var e;null===this.firstPoint.bx?this.firstPoint.set(this.inputPoint):(null!==this.inputData||.1<(e=this.inputPoint.bx-this.firstPoint.bx)*e+(e=this.inputPoint.by-this.firstPoint.by)*e)&&this.inputShade()},inputShade:function(){var e=this.getcell();if(!e.isnull&&e!==this.mouseCell){null===this.inputData&&("shade"===this.inputMode?this.inputData=1!==e.qsub?1:0:"unshade"===this.inputMode?this.inputData=2!==e.qsub?2:0:this.inputData=("left"===this.btn?[1,2,0]:[2,0,1])[e.qsub]);for(var i=(this.mouseCell=e).room.clist,t=0;t<i.length;t++)i[t].setQsub(this.inputData);i.draw()}}},"MouseEvent@simpleloop":{inputModes:{edit:["clear","info-line","empty"],play:["line","peke","clear","info-line"]}},"MouseEvent@dotchi,dotchi2":{inputModes:{edit:["border","circle-shade","circle-unshade","clear","info-line"],play:["line","peke","clear","info-line"]}},"MouseEvent@ovotovata":{inputModes:{edit:["border","number","shade","clear","info-line"],play:["line","peke","subcircle","subcross","clear","info-line"]},inputShade:function(){var e=this.getcell();if(!e.isnull&&e!==this.mouseCell){null===this.inputData&&(this.inputData=e.ice()?0:6);for(var i=e.room.clist,t=0;t<i.length;t++)i[t].setQues(this.inputData);i.draw(),this.mouseCell=e}}},"MouseEvent@rassi#2":{inputModes:{edit:["border","clear","info-line","empty"],play:["line","peke","subcircle","subcross","clear","info-line"]},mouseinput_rassi:function(){this.puzzle.playmode?this.mousestart||this.mousemove?"left"===this.btn?this.inputLine():"right"===this.btn&&this.inputdragcross():this.mouseend&&this.notInputted()&&(this.inputpeke_ifborder()||this.inputMB()):this.puzzle.editmode&&(this.mousestart||this.mousemove?this.inputborder():this.mouseend&&this.notInputted()&&this.inputempty())},inputdragcross:function(){var e;null===this.firstPoint.bx?this.firstPoint.set(this.inputPoint):(null!==this.inputData||.1<(e=this.inputPoint.bx-this.firstPoint.bx)*e+(e=this.inputPoint.by-this.firstPoint.by)*e)&&this.inputFixedQsub(2)}},MouseEvent:{mouseinput_auto:function(){if("rassi"===this.pid)return this.mouseinput_rassi();this.puzzle.playmode?this.mousestart||this.mousemove?"left"===this.btn?this.inputLine():"right"===this.btn&&("nothing"===this.pid?this.inputdragcross():this.inputpeke()):this.mouseend&&this.notInputted()&&"simpleloop"!==this.pid&&(this.inputpeke_ifborder()||"maxi"===this.pid||"dotchi"===this.pid||("nothing"===this.pid?this.inputShade():this.inputMB())):this.puzzle.editmode&&("simpleloop"===this.pid?this.inputempty():this.mousestart||this.mousemove?this.inputborder():this.mouseend&&this.notInputted()&&this.inputqnum())}},"MouseEvent@moonsun,dotchi2#2":{inputMB:function(){var i=this.getcell();if(!i.isnull&&-1!==i.qnum)for(var e=i.room.clist.filter(function(e){return i.qnum===e.qnum}),t=0===i.qsub?2:0,n=0;n<e.length;n++)e[n].setQsub(t),e[n].draw()}},"MouseEvent@remlen#2":{inputModes:{edit:["border","number","clear","empty","info-line"],play:["line","peke","diraux","clear","info-line"]},mouseinput_other:function(){"diraux"===this.inputMode&&(this.mousestart||this.mousemove?this.inputdiraux_mousemove():this.mouseend&&this.notInputted()&&this.clickdiraux())},mouseinput_auto:function(){this.puzzle.playmode&&"right"===this.btn?this.mousestart?this.inputdiraux_mousedown():2===this.inputData||3===this.inputData?this.inputpeke():this.mousemove&&this.inputdiraux_mousemove():this.puzzle.playmode&&"left"===this.btn?this.mousestart||this.mousemove?this.inputLine():this.mouseend&&this.notInputted()&&this.clickdiraux():this.puzzle.editmode&&(this.mousestart||this.mousemove?this.inputborder():this.mouseend&&this.notInputted()&&this.inputqnum())}},KeyEvent:{enablemake:!0},"KeyEvent@ovotovata":{keyinput:function(e){if("q"===e){for(var i=this.cursor.getc(),t=i.room.clist,n=i.ice()?0:6,o=0;o<t.length;o++)t[o].setQues(n);t.draw(),this.prev=i}else this.key_inputqnum(e)}},"Cell@country,onsen,maxi,detour":{maxnum:function(){return Math.min(999,this.room.clist.length)}},"Cell@remlen":{disInputHatena:!0,maxnum:function(){return Math.min(999,this.board.cols*this.board.rows)},seterr:function(e){this.board.isenableSetError()&&(0<e?this.error|=e:this.error=e)}},"Cell@country":{minnum:function(){return this.puzzle.getConfig("country_empty")?0:1}},"Cell@maxi":{minnum:1},"Cell@detour":{minnum:0},"Cell@moonsun,dotchi,dotchi2":{disInputHatena:!0,numberAsObject:!0,maxnum:2,posthook:{qnum:function(e){this.room.countMarkAndLine()}}},"Cell@dotchi#1":{noLP:function(e){return 2===this.qnum}},"Cell@doubleback,simpleloop,rassi,remlen":{noLP:function(e){return this.isEmpty()}},"Cell@ovotovata":{maxnum:function(){return Math.max(this.board.cols,this.board.rows)-1}},"Border@doubleback,simpleloop,dotchi,remlen":{enableLineNG:!0},"Border@moonsun,dotchi,dotchi2#1":{posthook:{line:function(e){var i=this.sidecell[0].room,t=this.sidecell[1].room;i.countMarkAndLine(),i!==t&&t.countMarkAndLine()}}},"Border@rassi":{checkStableLine:function(e){return 0!==e&&(this.isLineNG()||this.isBorder())}},Board:{hasborder:1},"Board@onsen,maxi,detour,remlen":{cols:8,rows:8,addExtraInfo:function(){this.lineblkgraph=this.addInfoList(this.klass.LineBlockGraph)}},CellList:{getOverlappingBorders:function(){var e=this.getRectSize();return this.board.borderinside(e.x1-1,e.y1-1,e.x2+1,e.y2+1)}},"CellList@remlen":{seterr:function(e){for(var i=0;i<this.length;i++)this[i].seterr(e)}},LineGraph:{enabled:!0},"LineGraph@onsen,maxi,detour,rassi,remlen":{makeClist:!0},"LineBlockGraph:LineGraph@onsen,maxi,detour,remlen":{enabled:!0,relation:{"border.line":"link","border.ques":"separator"},makeClist:!0,coloring:!1,setComponentRefs:function(e,i){e.lpath=i},getObjNodeList:function(e){return e.lpathnodes},resetObjNodeList:function(e){e.lpathnodes=[]},incdecLineCount:null,isedgevalidbylinkobj:function(e){return e.isLine()&&!e.isBorder()},isedgeexistsbylinkobj:function(e){return null!==e.lpath},setEdgeByLinkObj:function(e){var i=this.isedgevalidbylinkobj(e);if(i===this.isedgeexistsbylinkobj(e))for(var t=this.getSideObjByLinkObj(e),n=0;n<t.length;n++){var o=t[n];this.isnodevalid(o)?this.createNodeIfEmpty(o):this.deleteNodeIfEmpty(o)}else i?this.addEdgeByLinkObj(e):this.removeEdgeByLinkObj(e)}},AreaRoomGraph:{enabled:!0},"AreaRoomGraph@country,maxi,detour,remlen":{hastop:!0},"AreaRoomGraph@ovotovata":{hastop:!0,setTopOfRoom_combine:function(e,i){if(this.common.setTopOfRoom_combine.call(this,e,i),e.ques!==i.ques){for(var t=e.room.clist,n=i.room.clist,o=(t.length>=n.length?e:i).ques,s=0;s<t.length;s++)t[s].setQues(o);for(s=0;s<n.length;s++)n[s].setQues(o);t.draw(),n.draw()}}},"AreaRoomGraph@moonsun,dotchi,dotchi2":{setExtraData:function(e){this.common.setExtraData.call(this,e),e.countMarkAndLine()}},"GraphComponent@moonsun,dotchi2":{countMarkAndLine:function(){for(var e=this.count={moon:{exists:0,passed:0},sun:{exists:0,passed:0}},i=this.clist,t=0;t<i.length;t++){var n=i[t];2===n.qnum?(e.moon.exists++,0<n.lcnt&&e.moon.passed++):1===n.qnum&&(e.sun.exists++,0<n.lcnt&&e.sun.passed++)}}},"GraphComponent@dotchi":{countMarkAndLine:function(){for(var e=this.count={curve:0,straight:0},i=this.clist,t=0;t<i.length;t++){var n=i[t];1===n.qnum&&2===n.lcnt&&(n.isLineStraight()?e.straight++:e.curve++)}}},Graphic:{irowake:!0,numbercolor_func:"qnum",gridcolor_type:"SLIGHT",paint:function(){"remlen"!==this.pid&&"simpleloop"!==this.pid&&this.drawBGCells(),"country"===this.pid?this.drawGrid():this.drawDashedGrid(),"remlen"===this.pid&&this.drawBorderDirBG(),"remlen"!==this.pid&&"simpleloop"!==this.pid||this.drawBGCells(),"country"===this.pid||"maxi"===this.pid||"detour"===this.pid||"ovotovata"===this.pid||"remlen"===this.pid?this.drawQuesNumbers():"moonsun"===this.pid?this.drawMarks():"onsen"===this.pid?this.drawCircledNumbers():"dotchi"!==this.pid&&"dotchi2"!==this.pid||this.drawCircles(),this.drawBorders(),"onsen"!==this.pid&&"nothing"!==this.pid&&this.drawMBs(),this.drawLines(),this.drawPekes(),"remlen"===this.pid&&this.drawBorderAuxDir(),this.drawChassis(),"rassi"!==this.pid&&"doubleback"!==this.pid&&"nothing"!==this.pid&&"simpleloop"!==this.pid&&this.drawTarget()}},"Graphic@onsen":{hideHatena:!0,circleratio:[.4,.37],gridcolor_type:"LIGHT",repaintParts:function(e){this.range.cells=e.cellinside(),this.drawCircledNumbers()}},"Graphic@moonsun":{circlefillcolor_func:"qnum2",circlestrokecolor_func:"qnum2",gridcolor_type:"LIGHT",drawMarks:function(){for(var e=this.vinc("cell_mark","auto",!0),i=(e.lineWidth=Math.max(this.cw/36,1),.35*this.cw),t=285*Math.PI/180,n=135*Math.PI/180,o=120*Math.PI/180,s=300*Math.PI/180,r=this.range.cells,c=0;c<r.length;c++){var h,l,a,u,d=r[c];e.vid="c_sun_"+d.id,1===d.qnum?(e.fillStyle=this.getCircleFillColor(d),e.strokeStyle=this.getCircleStrokeColor(d),e.shapeCircle(d.bx*this.bw,d.by*this.bh,i)):e.vhide(),e.vid="c_moon_"+d.id,2===d.qnum?(h=d.bx*this.bw,l=d.by*this.bh,a=(d.bx-.25)*this.bw,u=(d.by-.15)*this.bh,e.fillStyle=this.getCircleFillColor(d),e.beginPath(),e.moveTo(h+i*Math.cos(t),l+i*Math.sin(t)),e.arc(h,l,i,t,n,!1),e.lineTo(a+i*Math.cos(o),u+i*Math.sin(o)),e.arc(a,u,i,o,s,!0),e.lineTo(h+i*Math.cos(t),l+i*Math.sin(t)),e.closePath(),e.fill()):e.vhide()}}},"Graphic@simpleloop":{getBGCellColor:function(e){return 7===e.ques?"black":this.getBGCellColor_error1(e)}},"Graphic@doubleback,rassi,remlen":{getBGCellColor:function(e){return 7===e.ques?"darkgray":this.getBGCellColor_error1(e)}},"Graphic@simpleloop,doubleback,rassi,remlen":{getBorderColor:function(e){var i=e.sidecell[0],t=e.sidecell[1];return(7!==i.ques||7!==t.ques)&&("simpleloop"!==this.pid||7!==i.ques&&7!==t.ques)?!e.inside||i.isnull||t.isnull||!i.isEmpty()&&!t.isEmpty()?this.getBorderColor_ques(e):"black":null}},"Graphic@maxi,detour,remlen":{textoption:{ratio:.4,position:5,hoffset:.8,voffset:.75}},"Graphic@dotchi,dotchi2":{circlefillcolor_func:"qnum2",circlestrokecolor_func:"qnum2",mbcolor:"#0096ff"},"Graphic@ovotovata":{gridcolor_type:"LIGHT",bgcellcolor_func:"icebarn",icecolor:"rgb(204,204,204)"},"Graphic@remlen#2":{getBGCellColor_error1:function(e){return 0<e.error&&1&e.error?this.errbcolor1:null},getQuesNumberColor:function(e){return 0<e.error&&2&e.error?this.errcolor1:this.quescolor},drawBorderDirBG:function(){this.vinc("border_bg","auto",!0);for(var e=this.context,i=.25*this.cw,t=this.range.borders,n=0;n<t.length;n++){var o=t[n];e.vid="bdbg_"+o.id,2===o.error?(e.strokeStyle=this.errcolor1,e.lineWidth=this.lw+this.addlw,e.strokeCross(o.bx*this.bw,o.by*this.bh,i)):e.vhide()}}},"Graphic@nothing":{bgcellcolor_func:"qsub2",qsubcolor1:"silver"},Encode:{decodePzpr:function(e){"country"===this.pid&&this.puzzle.setConfig("country_empty",this.checkpflag("e")),"ovotovata"===this.pid&&this.puzzle.setConfig("loop_full",this.checkpflag("f")),"simpleloop"!==this.pid&&this.decodeBorder(),"remlen"===this.pid&&("/"!==this.outbstr[0]?this.decodeEmpty():this.outbstr=this.outbstr.substr(1)),"country"===this.pid||"maxi"===this.pid||"detour"===this.pid||"ovotovata"===this.pid||"remlen"===this.pid?this.decodeRoomNumber16():"moonsun"===this.pid||"dotchi"===this.pid||"dotchi2"===this.pid?this.decodeCircle():"onsen"===this.pid?this.decodeNumber16():"doubleback"!==this.pid&&"simpleloop"!==this.pid&&"rassi"!==this.pid||this.decodeEmpty()},encodePzpr:function(e){"country"===this.pid&&(this.outpflag=this.puzzle.getConfig("country_empty")?"e":null),"ovotovata"===this.pid&&(this.outpflag=this.puzzle.getConfig("loop_full")?"f":null),"simpleloop"!==this.pid&&this.encodeBorder(),"remlen"!==this.pid||this.encodeEmpty()||(this.outbstr+="/"),"country"===this.pid||"maxi"===this.pid||"detour"===this.pid||"ovotovata"===this.pid||"remlen"===this.pid?this.encodeRoomNumber16():"moonsun"===this.pid||"dotchi"===this.pid||"dotchi2"===this.pid?this.encodeCircle():"onsen"===this.pid?this.encodeNumber16():"doubleback"!==this.pid&&"simpleloop"!==this.pid&&"rassi"!==this.pid||this.encodeEmpty()}},"Encode@ovotovata":{decodeRoomNumber16:function(){var e=this.board,t=(e.roommgr.rebuild(),e.roommgr.components);this.genericDecodeNumber16(t.length,function(e,i){1&i&&t[e].clist.each(function(e){e.ques=6}),t[e].top.qnum=1===(i>>=2)?-2:i-1})},encodeRoomNumber16:function(){var e=this.board,t=(e.roommgr.rebuild(),e.roommgr.components);this.genericEncodeNumber16(t.length,function(e){var e=t[e].top,i=-2===e.qnum?1:e.qnum+1;return i<<=2,6===e.ques&&(i|=1),i})}},FileIO:{decodeData:function(){"country"===this.pid&&1<=this.filever&&this.decodeFlags(),"ovotovata"===this.pid&&this.decodeConfigFlag("f","loop_full"),"simpleloop"!==this.pid&&(2<=this.filever?this.decodeBorderQues():this.decodeAreaRoom()),"doubleback"===this.pid||"simpleloop"===this.pid||"rassi"===this.pid?this.decodeEmpty():this.decodeCellQnum(),"remlen"===this.pid?this.decodeBorderArrowAns():(this.decodeBorderLine(),"onsen"!==this.pid&&"simpleloop"!==this.pid&&this.decodeCellQsub())},encodeData:function(){"country"===this.pid&&this.encodeFlags(["country_empty"]),"ovotovata"===this.pid&&this.encodeConfigFlag("f","loop_full"),"simpleloop"!==this.pid&&(this.filever=2,this.encodeBorderQues()),"doubleback"===this.pid||"simpleloop"===this.pid||"rassi"===this.pid?this.encodeEmpty():this.encodeCellQnum(),"remlen"===this.pid?this.encodeBorderArrowAns():(this.encodeBorderLine(),"onsen"!==this.pid&&"simpleloop"!==this.pid&&this.encodeCellQsub())},decodeEmpty:function(){this.decodeCell(function(e,i){"*"===i&&(e.ques=7)})},encodeEmpty:function(){this.encodeCell(function(e){return 7===e.ques?"* ":". "})}},"FileIO@ovotovata":{decodeCellQnum:function(){this.decodeCell(function(e,i){"-"===i.charAt(0)&&(e.ques=6,i=i.substr(1)),"0"===i?e.qnum=-2:"."!==i&&0<+i&&(e.qnum=+i)})},encodeCellQnum:function(){this.encodeCell(function(e){var i="";return 6===e.ques&&(i+="-"),-2===e.qnum?i+="0":-1!==e.qnum&&(i+=e.qnum.toString()),(i=""===i?".":i)+" "})}},"FileIO@remlen":{decodeCellQnum:function(){this.decodeCell(function(e,i){"#"===i?e.ques=7:"-"===i?e.qnum=-2:"."!==i&&(e.qnum=+i)})},encodeCellQnum:function(){this.encodeCell(function(e){return 7===e.ques?"# ":0<=e.qnum?e.qnum+" ":-2===e.qnum?"- ":". "})}},"AnsCheck@country#1":{checklist:["checkBranchLine","checkCrossLine","checkRoomPassOnce","checkRoadCount","checkNoRoadCountry","checkSideAreaGrass","checkDeadendLine+","checkOneLoop"]},"AnsCheck@doubleback#1":{checklist:["checkBranchLine","checkCrossLine","checkDeadendLine+","checkOneLoop","checkNoLine","checkRoomPassTwice"]},"AnsCheck@simpleloop#1":{checklist:["checkBranchLine","checkCrossLine","checkDeadendLine+","checkOneLoop","checkNoLine"]},"AnsCheck@moonsun#1":{checklist:["checkBranchLine","checkCrossLine","checkRoomPassOnce","checkPassesSingleMarks","checkNextRoomIsNotMoon","checkNextRoomIsNotSun","checkAllMoonPassed","checkAllSunPassed","checkNoRoadCountry","checkPassesAnyMarks","checkDeadendLine+","checkOneLoop"]},"AnsCheck@onsen#1":{checklist:["checkBranchLine","checkCrossLine","checkSingleNumberInLoop","checkLineRoomPassOnce","checkLineRoomLength","checkNoRoadCountry","checkNumberExistsInLoop","checkLineLengthInEachRoom","checkDeadendLine+","checkIsolatedCircle+"]},"AnsCheck@maxi#1":{checklist:["checkBranchLine","checkCrossLine","checkShortLineInRoom","checkLongLineInRoom","checkDeadendLine+","checkOneLoop","checkNoLine"]},"AnsCheck@detour#1":{checklist:["checkBranchLine","checkCrossLine","checkTurnsInRoom","checkDeadendLine+","checkOneLoop","checkNoLine"]},"AnsCheck@dotchi#1":{checklist:["checkBranchLine","checkCrossLine","checkLineOnShadedCircle","checkCircleEqual","checkAllCirclePassed","checkDeadendLine+","checkOneLoop"]},"AnsCheck@ovotovata#1":{checklist:["checkBranchLine","checkCrossLine","checkShadedRegions","checkNumberExit","checkHatenaExit","checkDeadendLine+","checkNoLineIfVariant","checkOneLoop"]},"AnsCheck@rassi#1":{checklist:["checkBranchLine","checkCrossLine","checkLineOverBorder","checkLoop","checkLinesInRoom","checkAroundEnd","checkNoLine"]},"AnsCheck@remlen#1":{checklist:["checkBranchLine","checkCrossLine","checkRememberedLength","checkDeadendLine+","checkOneLoop","checkNoLine"]},"AnsCheck@nothing#1":{checklist:["checkBranchLine","checkCrossLine","checkRoomPassOnce","checkRegionFullyVisited","checkSideAreaUnused","checkDeadendLine+","checkOneLoop"]},"AnsCheck@dotchi2#1":{checklist:["checkBranchLine","checkCrossLine","checkShadedTurn","checkUnshadedStraight","checkPassesSingleMarks","checkAllMoonPassed","checkAllSunPassed","checkPassesAnyMarks","checkDeadendLine+","checkOneLoop"]},AnsCheck:{checkNoRoadCountry:function(){this.puzzle.getConfig("country_empty")||this.checkLinesInArea(this.board.roommgr,function(e,i,t,n){return 0!==t},"bkNoLine")},checkRoomPassOnce:function(){for(var e=this.board.roommgr.components,i=0;i<e.length;i++){for(var t=0,n=e[i].clist,o=0;o<n.length;o++){var s=n[o].adjborder,r=s.top;1===r.ques&&1===r.line&&t++,1===(r=s.bottom).ques&&1===r.line&&t++,1===(r=s.left).ques&&1===r.line&&t++,1===(r=s.right).ques&&1===r.line&&t++}if(!(t<=2)){if(this.failcode.add("bkPassTwice"),this.checkOnly)break;n.seterr(1)}}},checkRoomPassTwice:function(){for(var e=this.board.roommgr.components,i=0;i<e.length;i++){for(var t=0,n=e[i].clist,o=0;o<n.length;o++){var s=n[o].adjborder,r=s.top;1===r.ques&&1===r.line&&t++,1===(r=s.bottom).ques&&1===r.line&&t++,1===(r=s.left).ques&&1===r.line&&t++,1===(r=s.right).ques&&1===r.line&&t++}if(4!==t){if(this.failcode.add("bkNotPassTwice"),this.checkOnly)break;n.seterr(1)}}}},"AnsCheck@country":{checkRoadCount:function(){this.checkLinesInArea(this.board.roommgr,function(e,i,t,n){return n<=0||n===t},"bkLineNe")},checkSideAreaGrass:function(){this.checkSideAreaCell(function(e,i){return 0===e.lcnt&&0===i.lcnt},!1,"cbNoLine")}},"AnsCheck@moonsun,dotchi2":{checkPassesSingleMarks:function(){this.checkAllRoom(function(e){return 0===e.moon.passed||0===e.sun.passed},function(e){return-1!==e.qnum&&0<e.lcnt},"bkBothMarksPassed")},checkPassesAnyMarks:function(){this.checkAllRoom(function(e){return 0<e.moon.passed||0<e.sun.passed},function(e){return-1!==e.qnum},"bkNoMarksPassed")},checkAllMoonPassed:function(){this.checkAllRoom(function(e){return 0===e.moon.passed||e.moon.exists===e.moon.passed},function(e){return 2===e.qnum&&0===e.lcnt},"bkNotAllMSPassed")},checkAllSunPassed:function(){this.checkAllRoom(function(e){return 0===e.sun.passed||e.sun.exists===e.sun.passed},function(e){return 1===e.qnum&&0===e.lcnt},"bkNotAllMUPassed")},checkAllRoom:function(e,i,t){for(var n=this.board.roommgr.components,o=0;o<n.length;o++){var s=n[o],r=s.count;if(!e(r)){if(this.failcode.add(t),this.checkOnly)break;s.clist.filter(i).seterr(1)}}},checkNextRoomIsNotMoon:function(){this.checkNextRoom(function(e,i){return 0===e.count.moon.passed||0===i.count.moon.passed},"bkMSPassedGt2")},checkNextRoomIsNotSun:function(){this.checkNextRoom(function(e,i){return 0===e.count.sun.passed||0===i.count.sun.passed},"bkMUPassedGt2")},checkNextRoom:function(e,i){for(var t=this.board.border,n=0;n<t.length;n++){var o=t[n];if(0!==o.ques&&0!==o.line){var s=o.sidecell[0].room,o=o.sidecell[1].room;if(s!==o&&!e(s,o)){if(this.failcode.add(i),this.checkOnly)break;s.clist.seterr(1),o.clist.seterr(1)}}}}},"AnsCheck@onsen":{checkLineRoomPassOnce:function(){var e=this.board,i=e.linegraph.components,t=e.roommgr.components;e:for(var n=0;n<i.length;n++)for(var o=[],s=0;s<i[n].clist.length;s++){var r=i[n].clist[s],c=t.indexOf(r.room);if(o[c]){if(o[c]!==r.lpath){if(this.failcode.add("blPassTwice"),this.checkOnly)break e;o[c].clist.seterr(1),r.lpath.clist.seterr(1)}}else o[c]=r.lpath}},checkLineRoomLength:function(){for(var e=this.board,i=e.linegraph.components,t=e.lineblkgraph.components,n=[],o=0;o<t.length;o++){var s=t[o].clist[0].path,r=i.indexOf(s),c=(c=n[r])||n[r]||s.clist.getQnumCell().getNum();if(!(c<0||c===t[o].clist.length)){if(this.failcode.add("blLineNe"),this.checkOnly)break;t[o].clist.seterr(1)}}},checkLineLengthInEachRoom:function(){var e=this.board,i=e.linegraph.components,t=e.lineblkgraph.components;e:for(var n=0;n<i.length;n++){var o=i[n],s=o.clist.getQnumCell().getNum();if(!(0<=s)){for(var r,c={},h=null,l=0;l<o.clist.length;l++){var a=t.indexOf(o.clist[l].lpath);c[a]=(c[a]||0)+1}for(r in c)if(h){if(h!==c[r]){if(this.failcode.add("blLineDiff"),this.checkOnly)break e;o.clist.seterr(1);break}}else h=c[r]}}},checkIsolatedCircle:function(){this.checkAllCell(function(e){return 0===e.lcnt&&e.isNum()},"lnIsolate")},checkSingleNumberInLoop:function(){this.checkNumbersInLoop(function(e){return e<=1},"lpNumGt2")},checkNumberExistsInLoop:function(){this.checkNumbersInLoop(function(e){return 0<e},"lpNoNum")},checkNumbersInLoop:function(e,i){for(var t=!0,n=this.board.linegraph.components,o=0;o<n.length;o++)if(!e(n[o].clist.filter(function(e){return e.isNum()}).length)){if(t=!1,this.checkOnly)break;n[o].setedgeerr(1)}t||(this.failcode.add(i),this.checkOnly||this.board.border.setnoerr())}},"AnsCheck@detour":{checkTurnsInRoom:function(){for(var e=this.board.roommgr.components,i=0;i<e.length;i++){var t=e[i],n=t.clist,o=0,s=t.top;if(!s.isnull&&!(s.qnum<0)){for(var r=0;r<n.length;r++)n[r].isLineCurve()&&o++;if(o!==s.qnum){if(this.failcode.add("blWrongTurns"),this.checkOnly)break;t.clist.seterr(1)}}}}},"AnsCheck@maxi":{checkShortLineInRoom:function(){for(var e=this.board.roommgr.components,i=0;i<e.length;i++){var t=e[i];if(!(0<t.clist.filter(function(e){return e.lcnt<2}).length)){var n=t.top;if(!(n.isnull||n.qnum<0)){for(var o=0,s=0;s<t.clist.length;s++)o=Math.max(o,t.clist[s].lpath.clist.length);if(o<n.qnum){if(this.failcode.add("blLineShort"),this.checkOnly)break;t.clist.seterr(1)}}}}},checkLongLineInRoom:function(){for(var e=this.board.roommgr.components,i=0;i<e.length;i++){var t=e[i],n=t.top;if(!n.isnull&&!(n.qnum<0))for(var o=t.clist.filter(function(e){return 0<e.lcnt}),s=0;s<o.length;s++)o[s].lpath.clist.length>n.qnum&&(this.failcode.add("blLineLong"),o[s].lpath.clist.seterr(1))}}},"AnsCheck@dotchi":{checkAllCirclePassed:function(){this.checkAllCell(function(e){return 0===e.lcnt&&1===e.qnum},"lnIsolate")},checkLineOnShadedCircle:function(){this.checkAllCell(function(e){return e.noLP()&&0<e.lcnt},"lnOnShade")},checkCircleEqual:function(){for(var e=this.board.roommgr.components,i=0;i<e.length;i++){var t=e[i];if(0!==t.count.curve&&0!==t.count.straight){if(this.failcode.add("bkNoMatch"),this.checkOnly)break;t.clist.filter(function(e){return 1===e.qnum}).seterr(1)}}}},"AnsCheck@ovotovata":{checkShadedRegions:function(){for(var e=this.board.roommgr.components,i=0;i<e.length;i++){var t=e[i];if(0!==t.top.ques&&!t.clist.some(function(e){return 0<e.lcnt})){if(this.failcode.add("bkNoLine"),this.checkOnly)break;t.clist.seterr(1)}}},checkNumberExit:function(){for(var e=this.getExitDistances(),i=this.board.roommgr.components,t=0;t<i.length;t++){var n=i[t];if(!(n.top.qnum<0)){var o=e[""+n.top.id];if(o&&!(o.max<=n.top.qnum&&o.minValid===n.top.qnum)){if(this.failcode.add("blNoNumber"),this.checkOnly)break;this.board.border.setnoerr(),n.clist.seterr(1);for(var s=0;s<o.lists.length;s++){var r=o.lists[s];(r.length>n.top.qnum||r.length<n.top.qnum&&r[0].isLineCurve())&&r.getOverlappingBorders().seterr(1)}}}}},checkHatenaExit:function(){for(var e=this.getExitDistances(),i=this.board.roommgr.components,t=0;t<i.length;t++){var n=i[t];if(-2===n.top.qnum){var o=e[""+n.top.id];if(o&&!(o.max<=o.minValid)){if(this.failcode.add("blNoHatena"),this.checkOnly)break;this.board.border.setnoerr(),n.clist.seterr(1);for(var s=0;s<o.lists.length;s++){var r=o.lists[s];(r.length>o.minValid||r[0].isLineCurve())&&r.getOverlappingBorders().seterr(1)}}}}},getExitDistances:function(){if(this._info.exits)return this._info.exits;for(var e=this.board.cell.length,i={},t=this.board.border,n=0;n<t.length;n++){var o=t[n];if(!o.isnull&&o.ques&&o.line)for(var s=0;s<=1;s++){var r,c=o.sidecell[s],h=o.sidecell[1-s];-1!==c.room.top.qnum&&c.room!==h.room&&((r=""+c.room.top.id)in i||(i[r]={minValid:e,max:0,lists:[]}),c=(o.isvert?[o.RT,o.LT]:[o.DN,o.UP])[s],i[r].lists.unshift(this.scanExit(h,c)))}}for(r in i){var l=i[r];l.lists.forEach(function(e){e.length>l.max&&(l.max=e.length),e[0].isLineCurve()&&e.length<l.minValid&&(l.minValid=e.length)})}return this._info.exits=i},scanExit:function(e,i){for(var t=[e],n=e.getaddr();e&&!e.isnull&&e.isLineStraight();)n.movedir(i,2),e=n.getc(),t.unshift(e);return new this.klass.CellList(t)}},"AnsCheck@rassi":{checkLineOverBorder:function(){for(var e=this.board,i=!0,t=0;t<e.border.length;t++){var n=e.border[t];if(n.checkStableLine(n.line)){if(i=!1,this.checkOnly)break;n.seterr(1)}}i||(this.failcode.add("laOnBorder"),e.border.setnoerr())},checkAroundEnd:function(){this.checkAroundCell(function(e,i){return 1===e.lcnt&&1===i.lcnt},"lnDeadEndAround")},checkLoop:function(){for(var e=this.board.linegraph.components,i=0;i<e.length;i++)if(!e[i].clist.some(function(e){return 2!==e.lcnt})){if(this.failcode.add("laLoop"),this.checkOnly)break;this.board.border.setnoerr(),e[i].setedgeerr(1)}},checkLinesInRoom:function(){for(var e=this.board,i=e.linegraph.components,t=e.roommgr.components,n=[],o=0;o<i.length;o++){var s=t.indexOf(i[o].clist[0].room);if(n[s]){if(this.failcode.add("blPassTwice"),this.checkOnly)break;this.board.border.setnoerr(),i[o].setedgeerr(1)}else n[s]=i[o]}}},"AnsCheck@remlen":{checkRememberedLength:function(){for(var e=this.board.linegraph.components,i=0;i<e.length;i++){var t=[],n=1===e[i].circuits?[e[i].clist[0]]:e[i].clist.filter(function(e){return 1===e.lcnt});if(!(2<n.length)){for(var o=0;o<n.length;o++)for(var s=1;s<=4;s++)n[o].reldirbd(s,1).isLine()&&t.push(this.walkLine(n[o],s));if(2===t.length&&0!==t[0].length&&0!==t[1].length){if(this.failcode.add("blRemLength"),this.checkOnly)return;for(var r=t[0].length<t[1].length?t[0]:t[1],c=0;c<r.length;c++)r[c].path.clist.seterr(1),r[c].cell.room.top.seterr(2),r[c].cell.reldirbd(r[c].dir,1).seterr(2)}}}},walkLine:function(e,i){var t=[],n=e.getaddr();do{var o=n.getc(),s=(n.movedir(i,2),n.getc().lpath),r=o.room.top.getNum(),r=(o.lpath===s||-1===r||s.clist.length===r||s.clist.some(function(e){return 2!==e.lcnt})||t.push({cell:o,dir:i,path:s}),n.getc().adjborder)}while(1!==i&&r.bottom.isLine()?i=2:2!==i&&r.top.isLine()?i=1:3!==i&&r.right.isLine()?i=4:4!==i&&r.left.isLine()&&(i=3),!n.equals(e)&&2===n.getc().lcnt&&!n.getc().isEmpty());return t}},"AnsCheck@nothing#2":{checkSideAreaUnused:function(){this.checkSideAreaSize(this.board.roommgr,function(e){return e.clist.some(function(e){return 0<e.lcnt})?0:1},"cbNoLine")},checkRegionFullyVisited:function(){for(var e=this.board.roommgr.components,i=0;i<e.length;i++){for(var t=e[i],n=!1,o=!1,s=!1,r=0;r<t.clist.length&&!s&&(!n||!o);r++)switch(t.clist[r].lcnt){case 0:o=!0;break;case 2:n=!0;break;default:s=!0}if(n&&o&&!s){if(this.failcode.add("bkLineNe"),this.checkOnly)break;t.clist.seterr(1)}}}},"AnsCheck@dotchi2#2":{checkShadedTurn:function(){this.checkAllCell(function(e){return 2===e.qnum&&e.isLineStraight()},"mashuBStrig")},checkUnshadedStraight:function(){this.checkAllCell(function(e){return 1===e.qnum&&e.isLineCurve()},"mashuWCurve")}}});
//# sourceMappingURL=country.js.map