/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(r,e){"object"==typeof module&&module.exports?module.exports=[r,e]:pzpr.classmgr.makeCustom(r,e)}(["tachibk"],{MouseEvent:{inputModes:{edit:["number","clear"],play:["border","number","subline"]},getBoardAddress:function(r){var e=this.board,r=this.common.getBoardAddress.call(this,r),t=4/this.puzzle.painter.lwratio,e=(e.minbx+e.maxbx)/2,i=e+t;return r.bx>=e&&r.bx<i?r.bx=r.bx<(e+i)/2?e-.01:e:r.bx>=i&&(r.bx-=t),r},autoedit_func:"qnum",autoplay_func:"border"},KeyEvent:{enablemake:!0,enableplay:!0},Border:{enableLineNG:!0,isLineNG:function(){var r=this.board;return this.bx===(r.minbx+r.maxbx)/2},prehook:{qans:function(r){return r&&this.isLineNG()},qsub:function(r){return r&&this.isLineNG()}}},Board:{cols:8,rows:8,hascross:1,hasborder:1,initBoardSize:function(r,e){1&r&&(r=Math.max(2,r-1)),this.common.initBoardSize.call(this,r,e)}},BoardExec:{allowedOperations:function(r){return this.FLIPX|this.FLIPY},distObj:function(r,e){var t=this.board;return e.isnull?-1:(r&=15)===this.UP?e.by:r===this.DN?2*t.rows-e.by:r===this.LT?e.bx%t.cols:r===this.RT?t.cols-e.bx%t.cols:-1},execadjust_main:function(e,t){var r=this.board,i=(this.adjustBoardData(e,t),e&this.EXPAND&&(e===this.EXPANDUP||e===this.EXPANDDN?r.rows++:e!==this.EXPANDLT&&e!==this.EXPANDRT||(r.cols+=2)),this);["cell","cross","border"].forEach(function(r){e&i.EXPAND?i.expandGroup(r,e):e&i.REDUCE?i.reduceGroup(r,e):i.turnflipGroup(r,e,t)}),e&this.REDUCE&&(e===this.REDUCEUP||e===this.REDUCEDN?r.rows--:e!==this.REDUCELT&&e!==this.REDUCERT||(r.cols-=2)),r.setminmax(),r.setposAll(),this.adjustBoardData2(e,t)}},Cell:{enableSubNumberArray:!0,disableAnum:!0,maxnum:function(){var r=this.board;return r.cols*r.rows>>2},seterr:function(r){this.board.isenableSetError()&&(this.error=0<r?Math.max(r,this.error):r)}},CellList:{seterr:function(r){for(var e=0;e<this.length;e++)this[e].seterr(r)}},AreaRoomGraph:{relation:{"cell.qnum":"info","border.qans":"separator"},enabled:!0,isedgevalidbylinkobj:function(r){return!r.isBorder()&&!r.isLineNG()},modifyOtherInfo:function(r,e){this.setExtraData(r.room)},setExtraData:function(r){var e=r.clist=new this.klass.CellList(r.getnodeobjs());r.isvalid=!e.some(function(r){return 0<r.qnum&&r.qnum!==e.length})}},Graphic:{gridcolor_type:"LIGHT",circlestrokecolor_func:"null",errbcolor2:"rgb(255, 216, 216)",circleratio:[.35,.35],paint:function(){this.drawBGCells(),this.drawDashedGrid(),this.drawTargetSubNumber(!0),this.drawBorders(),this.drawBorderQsubs(),this.drawChassis(),this.drawCircles(),this.drawQuesNumbers(),this.drawSubNumbers(!0),this.drawTarget()},drawTarget:function(){this.drawCursor(!0,this.puzzle.editmode||0<=this.puzzle.mouse.inputMode.indexOf("number"))},fontsizeratio:.75,flushCanvas:function(){for(var r=this.vinc("background","crispEdges",!0),e=this.bw,t=this.bh,i=.15<this.margin?this.margin:0,s=this.board,o=s.minbx-i,n=s.minby-i,a=(s.maxbx+i-o)/2,h=s.maxby+i-n,l=a*e+1,c=0;c<2;c++){var d=c?l+2*this.cw/this.lwratio:0;r.vid="BG"+c,r.fillStyle=this.bgcolor,r.fillRect(d+o*e-.5,n*t-.5,l,h*t+1)}},drawDashedGrid:function(){var r=this.vinc("grid","crispEdges",!0),e=this.board,t=Math.max(e.minbx,0),i=Math.min(e.maxbx,2*e.cols),s=Math.max(e.minby,0),e=Math.min(e.maxby,2*e.rows),o=this.range.x1,n=this.range.y1,a=this.range.x2,h=this.range.y2,l=(o<t&&(o=t),i<a&&(a=i),n<s&&(n=s),e<h&&(h=e),o-=1&o,n-=1&n,a+=1&a,h+=1&h,(t+i)/2),c=this.getDashArray(),d=this.bw,u=this.bh,t=Math.max(o,t+2),b=Math.min(a,i-2),i=Math.max(n,s+2),m=Math.min(h,e-2),f=2*this.cw/this.lwratio;r.lineWidth=this.gw,r.strokeStyle=this.gridcolor;for(var x=t;x<=b;x+=2){var g=x*d,v=n*u,p=h*u;x!==l&&(l<x&&(g+=f),r.vid="bdy_"+x,r.strokeDashedLine(g,v,g,p,c))}for(x=i;x<=m;x+=2){var k=x*u,w=o*d,C=l*d,E=l*d+f,N=a*d+f;w<C&&(r.vid="bd_0x_"+x,r.strokeDashedLine(w,k,C,k,c)),E<N&&(r.vid="bd_1x_"+x,r.strokeDashedLine(E,k,N,k,c))}},getCellHorizontalOffset:function(r){var e=this.board;return r.bx>(e.minbx+e.maxbx)/2?2*this.cw/this.lwratio:0},getBorderHorizontalOffset:function(r){return this.getCellHorizontalOffset(r)},getBoardCols:function(){var r=this.board;return 1/this.lwratio+(r.maxbx-r.minbx)/2},getCanvasCols:function(){return this.getBoardCols()+3*this.margin},setParameter:function(){this.common.setParameter.call(this),this.basex0=-this.margin*this.cw*.25},drawChassis:function(){for(var r=this.vinc("chassis","crispEdges",!0),e=this.board,t=e.cols*this.cw/2,i=e.rows*this.ch,s=this.lw,o=this.lm,n=0;n<2;n++){var a=n?t+2*this.cw/this.lwratio:0;r.fillStyle=this.quescolor,r.vid="ch"+n+"s1_",r.fillRect(a-o,-o,s,i+s),r.vid="ch"+n+"s2_",r.fillRect(a+t-o,-o,s,i+s),r.vid="ch"+n+"s3_",r.fillRect(a-o,-o,t+s,s),r.vid="ch"+n+"s4_",r.fillRect(a-o,i-o,t+s,s)}},getBGCellColor:function(r){return 0<r.error?this.errbcolor1:null},getQuesNumberColor:function(r){return 0<r.error?this.errcolor1:this.quescolor},getCircleFillColor:function(r){return 2===r.error?this.errbcolor2:null},getBorderColor:function(r){return r.qans?this.getBorderColor_qans(r):null}},Encode:{decodePzpr:function(r){this.decodeNumber16()},encodePzpr:function(r){this.encodeNumber16()}},FileIO:{decodeData:function(){this.decodeCellQnum(),this.decodeBorderAns(),this.decodeCellSnum()},encodeData:function(){this.encodeCellQnum(),this.encodeBorderAns(),this.encodeCellSnum()}},AnsCheck:{checklist:["checkSizeOverlap","checkSmallNumberArea","checkLargeNumberArea","checkBankEqual","checkBorderDeadend+"],checkSmallNumberArea:function(){return this.checkNumberArea(-1,"bkSizeLt")},checkLargeNumberArea:function(){return this.checkNumberArea(1,"bkSizeGt")},checkBankEqual:function(){for(var r=this.board,e=(r.minbx+r.maxbx)/2,t=[],i=[],s=r.roommgr.components,o=0;o<s.length;o++){if(!s[o].isvalid)return;((l=(a=s[o].clist)[0].bx<e)?t:i).push(a.getBlockShapes().canon)}for(var n=0;n<t.length;n++)-1!==(h=i.indexOf(t[n]))&&(t.splice(n,1),i.splice(h,1),n--);if(0!==t.length&&0!==i.length&&(this.failcode.add("bankNe"),!this.checkOnly))for(o=0;o<s.length;o++){var a,h,l=(a=s[o].clist)[0].bx<e,c=a.getBlockShapes().canon;-1!==(h=(l?t:i).indexOf(c))&&(a.seterr(1),(l?t:i).splice(h,1))}},checkSizeOverlap:function(){for(var r=this.board,e=r.cols,t=1;t<r.maxby;t+=2)for(var i=1;i<e;i+=2){var s=r.getc(i,t),o=r.getc(i+e,t),n=s.room,a=o.room;if(n.isvalid&&a.isvalid&&n.clist.length===a.clist.length){if(this.failcode.add("ceOverlap"),this.checkOnly)return;n.clist.seterr(1),a.clist.seterr(1),s.seterr(2),o.seterr(2)}}},checkNumberArea:function(r,e){for(var t=this.board.roommgr.components,i=0;i<t.length;i++)if(!t[i].isvalid)for(var s=t[i].clist,o=s.length,n=0;n<s.length;n++){var a=s[n].qnum;if(!(a<=0)&&(r<0&&o<a||0<r&&a<o)){if(this.failcode.add(e),this.checkOnly)return;s.seterr(1)}}}},FailCode:{bkSizeLt:"bkSizeLt.fillomino",bkSizeGt:"bkSizeGt.fillomino"}});
//# sourceMappingURL=tachibk.js.map