/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["tren"],{MouseEvent:{inputModes:{edit:["number","undef"],play:["border","bgcolor","bgcolor1","bgcolor2"]},mouseinput_auto:function(){this.puzzle.playmode?(this.mousestart||this.mousemove)&&("left"===this.btn&&this.isBorderMode()?this.inputborder():this.inputBGcolor()):this.puzzle.editmode&&this.mouseend&&this.notInputted()&&this.inputqnum()}},KeyEvent:{enablemake:!0},Cell:{numberAsObject:!0,maxnum:function(){return Math.max(this.board.cols,this.board.rows)-2},minnum:0,posthook:{qnum:function(){this.board.roommgr.setExtraData(this.room)}},isTren:function(){return this.isNum()}},Board:{hasborder:1},AreaRoomGraph:{INVALID:0,HORZ:1,VERT:2,enabled:!0,setExtraData:function(e){var t=e.clist=new this.klass.CellList(e.getnodeobjs()),n=t.filter(function(e){return e.isNum()});e.num=0===n.length?-1:1===n.length?n[0].qnum:-3,1===t.length||3<t.length?e.tren=this.INVALID:(n=t.getRectSize(),e.tren=3<n.rows*n.cols?this.INVALID:1===n.rows?this.HORZ:this.VERT)}},Graphic:{gridcolor_type:"DLIGHT",bordercolor_func:"qans",errbcolor2:"rgb(255, 192, 192)",paint:function(){this.drawBGCells(),this.drawDashedGrid(),this.drawBorders(),this.drawQuesNumbers(),this.drawChassis(),this.drawTarget()},getBGCellColor:function(e){return this.getBGCellColor_error2(e)||this.getBGCellColor_qsub2(e)}},Encode:{decodePzpr:function(e){this.decodeNumber16(),this.puzzle.setConfig("tren_new",this.checkpflag("n"))},encodePzpr:function(e){this.outpflag=this.puzzle.getConfig("tren_new")?"n":null,this.encodeNumber16()}},FileIO:{decodeData:function(){this.decodeConfig(),this.decodeCellQnum(),this.decodeBorderAns(),this.decodeCellQanssub()},encodeData:function(){this.encodeConfig(),this.encodeCellQnum(),this.encodeBorderAns(),this.encodeCellQanssub()},decodeConfig:function(){this.decodeConfigFlag("n","tren_new")},encodeConfig:function(){this.encodeConfigFlag("n","tren_new")}},AnsCheck:{checklist:["checkDoubleNumberInTren","checkConnectivity","checkTrenDistance","checkNumberNotInTren+","checkDeadendLines"],checkConnectivity:function(){if(this.puzzle.getConfig("tren_new"))for(var e=null,t=this.board.roommgr.components,n=0;n<t.length;n++){var r=t[n];if(-1===r.num)if(e){if(this.failcode.add("bkDivide"),this.checkOnly)break;e.clist.seterr(1),r.clist.seterr(1)}else e=r}},checkDoubleNumberInTren:function(){this.checkAllBlock(this.board.roommgr,function(e){return e.isNum()},function(e,t,n,r){return 3<e*t||n<2},"bkNumGe2")},checkTrenDistance:function(){for(var e=!this.puzzle.getConfig("multierr"),t=(this.checkRowsColsPartly(function(t,n){return!n.keycell||n.keycell.isnull||n.keycell.isTren()||t.add(n.keycell),t.each(function(e){n.isvert?e.vertlist=t:e.horzlist=t}),!0},function(e,t){var n=t?"top":"left";return!(!e.isTren()&&!e.adjborder[n].isBorder())&&(e[t?"vertlist":"horzlist"]=new e.klass.CellList([e]),!0)}),this.board.roommgr.components),n=0;n<t.length;n++){var r=t[n];if(r&&r.tren&&!(r.num<0)){var o=r.clist.getTopCell(),i=this.board.emptycell,s=i,s=r.tren===this.board.roommgr.VERT?(i=o.adjacent.top,o.relcell(0,2*r.clist.length)):(i=o.adjacent.left,o.relcell(2*r.clist.length,0)),o=[i,s].map(function(e){var t=new e.klass.CellList;return t=e.isnull||-1!==e.qnum||e.room.tren&&-1!==e.room.num&&-3!==e.room.num?t:r.tren===e.board.roommgr.VERT?e.vertlist:e.horzlist});if(r.num!==o[0].length+o[1].length){if(this.failcode.add("nmMoveNe"),this.checkOnly)break;if(r.clist.seterr(1),o[0].seterr(2),o[1].seterr(2),e)break}}}},checkNumberNotInTren:function(){this.checkAllCell(function(e){return-1!==e.qnum&&!e.room.tren},"nmOutsideTren")},checkDeadendLines:function(){for(var e=this.board.border,t=0;t<e.length;t++){var n=e[t],r=n.sidecell[0],o=n.sidecell[1];if(n.isBorder()&&(-1===r.room.num&&-1===o.room.num)){if(this.failcode.add("bdUnused"),this.checkOnly)break;this.board.border.setnoerr(),n.seterr(1)}}}}});
//# sourceMappingURL=tren.js.map