/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["skyscrapers"],{MouseEvent:{inputModes:{edit:["number"],play:["number","clear"]},mouseinput_number:function(){!this.mousestart||this.puzzle.editmode&&this.inputqnum_excell()||this.inputqnum()},mouseinput_auto:function(){var e;this.puzzle.playmode?this.mousestart?(e=this.getcell_excell()).isnull||("cell"===e.group?this.inputqnum():this.inputflash()):this.inputflash():this.mouseinput_number()},mouseevent:function(e){var t;this.isclearflash=!1,0!==e||(t=this.getpos(0).getex()).isnull||1!==t.qinfo||(this.isclearflash=!0),this.common.mouseevent.call(this,e)},inputflash:function(){var e=this.getpos(0).getex(),t=this.puzzle.board;e.isnull||this.mouseCell===e||(this.isclearflash?(t.lightclear(),this.mousereset()):(t.flashlight(e),this.mouseCell=e))},inputqnum_excell:function(){var e=this.getpos(0).getex();return!e.isnull&&(e!==this.cursor.getex()?this.setcursor(e):this.inputqnum_main(e),!0)}},KeyEvent:{enablemake:!0,enableplay:!0,keyinput:function(e){var t=this.cursor.getex();!t.isnull&&this.puzzle.editmode?this.key_inputqnum_main(t,e):this.key_inputqnum(e)}},TargetCursor:{initCursor:function(){this.init(-1,-1),this.adjust_init()},setminmax_customize:function(){this.puzzle.editmode||(this.minx+=2,this.miny+=2,this.maxx-=2,this.maxy-=2)}},Cell:{enableSubNumberArray:!0,maxnum:function(){return Math.max(this.board.cols,this.board.rows)}},ExCell:{disInputHatena:!0,maxnum:function(){var e=this.board;return this.by<0||this.by>2*e.rows?e.rows:e.cols}},Board:{cols:5,rows:5,hasborder:1,hasexcell:2,flashlight:function(e){this.lightclear(),this.searchSight(e,!0),this.puzzle.redraw()},lightclear:function(){if(this.hasinfo){for(var e=0;e<this.cell.length;e++)this.cell[e].qinfo=0;for(e=0;e<this.excell.length;e++)this.excell[e].qinfo=0;this.haslight=!1,this.puzzle.redraw()}},searchSight:function(e,t){for(var i=0,s=[],n=0;n<this.cell.length;n++)s[n]=0;var l=e.getaddr(),r=0,h=0;for(l.by===this.minby+1?r=2:l.by===this.maxby-1?r=1:l.bx===this.minbx+1?r=4:l.bx===this.maxbx-1&&(r=3);0!==r;){l.movedir(r,2);var u=l.getc();if(u.isnull)break;u.getNum()<=h||(h=u.getNum(),s[u.id]=1,i++)}if(t){e.qinfo=1;for(n=0;n<this.cell.length;n++)s[n]&&(this.cell[n].qinfo=s[n]);this.hasinfo=!0}return{cnt:i}}},Graphic:{gridcolor_type:"LIGHT",lightcolor:"rgb(255, 255, 127)",paint:function(){this.drawBGCells(),this.drawBGExCells(),this.drawTargetSubNumber(),this.drawGrid(),this.drawBorders(),this.drawSubNumbers(),this.drawAnsNumbers(),this.drawQuesNumbers(),this.drawArrowNumbersExCell_skyscrapers(),this.drawChassis(),this.drawCursor()},getBGCellColor:function(e){return 1===e.error?this.errbcolor1:1===e.qinfo?this.lightcolor:null},getBGExCellColor:function(e){return 1===e.error?this.errbcolor1:1===e.qinfo?this.lightcolor:null},drawArrowNumbersExCell_skyscrapers:function(){for(var e=this.vinc("excell_number","auto"),t=this.board,i=.5*this.bw,s=.5*this.bh,n=.3*this.bw,l=.3*this.bh,r=.25*this.bh,h=.25*this.bw,u={ratio:.7},o=this.range.excells,a=0;a<o.length;a++){var c=o[a],m=c.qnum,b=c.bx*this.bw,d=c.by*this.bh,m=0<=m?""+m:"";m&&(e.fillStyle=this.getQuesNumberColor(c)),e.vid="excell_arrow_"+c.id,m?(e.beginPath(),c.by===t.minby+1?e.setOffsetLinePath(b,d+s,0,l,h,0,-h,0):c.by===t.maxby-1?e.setOffsetLinePath(b,d-s,0,-l,h,0,-h,0):c.bx===t.minbx+1?e.setOffsetLinePath(b+i,d,n,0,0,r,0,-r):c.bx===t.maxbx-1&&e.setOffsetLinePath(b-i,d,-n,0,0,r,0,-r),e.fill()):e.vhide(),e.vid="excell_text_"+c.id,m?(c.by===t.minby+1?d-=.1*this.ch:c.by===t.maxby-1?d+=.1*this.ch:c.bx===t.minbx+1?b-=.1*this.cw:c.bx===t.maxbx-1&&(b+=.1*this.cw),this.disptext(m,b,d,u)):e.vhide()}}},Encode:{decodePzpr:function(e){this.decodeNumber16ExCell(),this.decodeNumber16()},encodePzpr:function(e){this.encodeNumber16ExCell(),this.board.cell.some(function(e){return-1!==e.qnum})&&this.encodeNumber16()}},FileIO:{decodeData:function(){this.decodeCellExCellQnumAnumsub()},encodeData:function(){this.encodeCellExCellQnumAnumsub()},decodeCellExCellQnumAnumsub:function(){this.decodeCellExCell(function(e,t){"."!==t&&("excell"===e.group?e.qnum=+t:"cell"===e.group&&("q"===t[0]?e.qnum=+t.substr(1):"."!==(t=0<=t.indexOf("[")?this.setCellSnum(e,t):t)&&(e.anum=+t)))})},encodeCellExCellQnumAnumsub:function(){this.encodeCellExCell(function(e){if("excell"===e.group){if(-1!==e.qnum)return e.qnum+" "}else if("cell"===e.group){if(-1!==e.qnum)return"q"+e.qnum+" ";var t=".",i=e.anum;return-1!==i?t=""+i:t+=this.getCellSnum(e),t+" "}return". "})}},AnsCheck:{checklist:["checkDifferentNumberInLine","checkSight","checkNoNumCell+"],checkSight:function(e){for(var t=this.board,i=!0,s=new this.klass.ExCellList,n=0;n<t.excell.length;n++){var l=t.excell[n];if(-1!==l.qnum){var r=t.searchSight(l,!1).cnt;if(l.qnum!==r){if(i=!1,this.checkOnly)break;l.seterr(1),s.add(l)}}}i||(this.failcode.add("nmSightNe"),s.each(function(e){t.searchSight(e,!0)}))}}});
//# sourceMappingURL=skyscrapers.js.map