/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(t,e){"object"==typeof module&&module.exports?module.exports=[t,e]:pzpr.classmgr.makeCustom(t,e)}(["tents"],{MouseEvent:{use:!0,inputModes:{edit:["number","mark-tree","clear"],play:["mark-tent","objblank","subline","peke","completion"]},mouseinput_other:function(){switch(this.inputMode){case"mark-tree":this.inputFixedNumber(1);break;case"mark-tent":this.inputFixedNumber(2)}},mouseinput_number:function(){this.mousestart&&(this.inputqnum_excell(),this.notInputted&&this.inputqnum())},mouseinput_auto:function(){var t,e,i,n,s,u,o,r;this.puzzle.playmode?(this.mousestart&&(this.placedTent=!1,this.firstPoint.reset(),this.inputqcmp()),(t=this.getcell()).isnull||(null!==this.inputData||this.firstPoint.oncell()||this.firstPoint.set(t),e=this.firstPoint.getc(),r=t.getnb(e),i=1===this.puzzle.getConfig("use"),n=1===e.getNum()||1===t.getNum(),s=2===e.getNum()||2===t.getNum(),u=1===e.qsub||1===t.qsub,o=-1===e.getNum()&&0===e.qsub||-1===t.getNum()&&0===t.qsub,null===this.inputData&&this.firstPoint.equals(t)&&(o&&"left"===this.btn&&(t.setinfo(2),this.board.hasinfo=!0,t.draw()),o&&"right"===this.btn&&("border"!==(r=this.getpos(.22).getb()).group||r.isnull)&&(this.inputData=2)),null!==this.inputData||this.firstPoint.equals(t)||(n&&s&&(this.inputData=1),n&&o&&(r.isnull||1!==r.qsub?this.inputData="left"===this.btn?1:2:this.inputData=0),n&&u&&(this.inputData="left"!==this.btn||i?2:1),this.inputcell_tents(e),this.notInputted()||this.puzzle.opemgr.newOperation(),r.isnull||null===this.inputData||(1===this.inputData?r.setQsub(1!==r.qsub?1:0):1===r.qsub&&r.setQsub(0),r.draw(),this.notInputted()||this.puzzle.opemgr.newOperation())),"right"===this.btn&&null===this.inputData&&this.mouseend&&this.inputpeke_ifborder()||null===this.inputData&&!this.mouseend||this.inputcell_tents(t))):this.puzzle.editmode&&this.mouseend&&this.notInputted()&&(this.inputqnum_excell(),this.notInputted&&this.inputqnum())},inputcell_tents:function(t,e){var i,n;t.isnull||t===this.mouseCell||-1!==t.qnum||(null===this.inputData&&(i=2===t.anum?1:1===t.qsub?2:0,e?this.inputData=i!==e?e:0:1===this.puzzle.getConfig("use")?(n="left"===this.btn?1:2,this.inputData=i!==n?n:0):(n=i+("left"===this.btn?1:-1),this.inputData=(n+3)%3)),1===this.inputData&&this.placedTent||2===this.inputData&&this.placedTent&&2===t.anum||(t.setAnum(1===this.inputData?2:-1),2===this.inputData?t.setQsub(1):1===t.qsub&&t.setQsub(0),t.removeAuxLines(),t.draw(),this.mouseCell=t,this.placedTent=!0))},inputqnum_excell:function(){var t=this.getcell_excell();t.isnull||"excell"!==t.group||(t!==this.cursor.getex()?this.setcursor(t):this.inputqnum_main(t))},inputDot:function(){this.inputcell_tents(this.getcell(),2)},inputqcmp:function(){var t=this.getcell_excell();t.isnull||t.noNum()||"excell"!==t.group||(t.setQcmp(+!t.qcmp),t.draw(),this.mousereset())}},KeyEvent:{enablemake:!0,keyinput:function(t){this.key_inputexcell(t),this.key_inputqnum(t)}},TargetCursor:{initCursor:function(){this.init(-1,-1)}},ExCell:{disInputHatena:!0,maxnum:function(){var t=this.bx,e=this.by;return-1===t&&-1===e?0:-1===e?this.board.rows:this.board.cols},minnum:0},Border:{prehook:{qsub:function(t){return!!t&&(1!==this.sidecell[0].getNum()&&1!==this.sidecell[1].getNum())}}},Cell:{numberAsObject:!0,disInputHatena:!0,maxnum:function(){return this.puzzle.editmode?1:3},posthook:{qnum:function(t){0<=t&&this.setQsub(0)}},removeAuxLines:function(){var t,e=2===this.getNum()?1:1===this.getNum()?2:null;for(t in this.adjacent){var i=this.adjacent[t];!i||i.isnull||i.getNum()===e||(i=this.getnb(i)).isnull||1!==i.qsub||i.setQsub(0)}}},Board:{hasborder:1,hasexcell:1,cols:8,rows:8,addExtraInfo:function(){this.campgraph=this.addInfoList(this.klass.AreaCampGraph)}},BoardExec:{adjustBoardData:function(t,e){this.adjustExCellTopLeft_1(t,e)},adjustBoardData2:function(t,e){this.adjustExCellTopLeft_2(t,e)}},"AreaCampGraph:AreaNumberGraph":{enabled:!0,makeClist:!0,setComponentRefs:function(t,e){t.camp=e},getObjNodeList:function(t){return t.campnodes},resetObjNodeList:function(t){t.campnodes=[]},isnodevalid:function(t){return 1===t.getNum()||2===t.getNum()},isedgevalidbynodeobj:function(t,e){return 1===t.getNum()&&2===e.getNum()||2===t.getNum()&&1===e.getNum()},setExtraData:function(t){this.common.setExtraData.call(this,t),t.counts={tents:0,trees:0};for(var e=0;e<t.nodes.length;e++)switch(t.nodes[e].obj.getNum()){case 1:t.counts.trees++;break;case 2:t.counts.tents++}}},Graphic:{enablebcolor:!0,bgcellcolor_func:"error1",qanscolor:"rgb(0, 127, 0)",paint:function(){this.drawBGCells(),this.drawDotCells(),this.drawGrid(),this.drawBorderQsubs(),this.drawPekes(),this.drawTents(),this.drawTrees(),this.drawNumbersExCell(),this.drawChassis(),this.drawTarget()},getQuesNumberColor:function(t){return 1===t.error?this.errcolor1:t.qcmp?this.qcmpcolor:this.quescolor},drawBorderQsubs:function(){for(var t=this.vinc("border_qsub","crispEdges",!0),e=this.range.borders,i=0;i<e.length;i++){var n,s,u=e[i];t.vid="b_qsub1_"+u.id,1===u.qsub?(n=u.bx*this.bw,s=u.by*this.bh,t.fillStyle=u.trial?this.linetrialcolor:this.pekecolor,u.isHorz()?t.fillRectCenter(n,s,1,this.bh):t.fillRectCenter(n,s,this.bw,1)):t.vhide()}},drawTents:function(){for(var t=this.vinc("cell_tent","auto"),e=.25*this.cw,i=.125*this.cw,n=.05*this.cw,s=.1*this.cw,u=.325*this.cw,o=this.range.cells,r=0;r<o.length;r++){var l=o[r],c=l.bx*this.bw,h=(l.by+.15)*this.bh,a=l.getNum();2===(a=-1!==a||l.isDot()?a:l.qinfo)?(t.vid="c_tentouter_"+l.id,a=this.getAnsNumberColor(l),-1===l.getNum()&&0<this.board.trialstage&&(a=this.trialcolor),t.fillStyle=a,t.beginPath(),t.setOffsetLinePath(c,h,0,-e,-e,e,e,e,!0),t.fill(),t.vid="c_tentinner_"+l.id,t.fillStyle="white",t.beginPath(),t.setOffsetLinePath(c,h,0,0,-i,e,i,e,!0),t.fill(),t.vid="c_tentline_"+l.id,t.lineWidth=Math.max(this.cw/32,2),t.strokeStyle=a,t.beginPath(),t.moveTo(c-u,h+e),t.lineTo(c+u,h+e),t.moveTo(c-e,h+e),t.lineTo(c+n,h-(e+s)),t.moveTo(c+e,h+e),t.lineTo(c-n,h-(e+s)),t.closePath(),t.stroke()):(t.vid="c_tentouter_"+l.id,t.vhide(),t.vid="c_tentinner_"+l.id,t.vhide(),t.vid="c_tentline_"+l.id,t.vhide())}},drawTrees:function(){for(var t=this.vinc("cell_tree","auto"),e=.275*this.cw,i=.08*this.cw,n=.35*this.cw,s=this.range.cells,u=0;u<s.length;u++){var o=s[u],r=o.bx*this.bw,l=o.by*this.bh;1===o.getNum()?(t.lineWidth=Math.max(this.cw/32,2),t.vid="c_treeroot_"+o.id,t.fillStyle="black",t.fillRect(r-i,l,2*i,n),t.vid="c_treetop_"+o.id,t.strokeStyle="black",t.fillStyle="rgb(212,251,121)",t.shapeCircle(r,l-.15*this.bh,e)):(t.vid="c_treeroot_"+o.id,t.vhide(),t.vid="c_treetop_"+o.id,t.vhide())}}},Encode:{decodePzpr:function(t){this.decodeNumber16ExCell(),this.decode1Cell(1)},encodePzpr:function(t){this.encodeNumber16ExCell(),this.encode1Cell(1)}},FileIO:{decodeData:function(){this.decodeCellExCell(function(t,e){"."!==e&&("excell"!==t.group||t.isnull?"cell"===t.group&&(0<+e?t.qnum=+e:"A"===e?t.anum=2:"-"===e&&(t.qsub=1)):("c"===e[0]&&(t.qcmp=1,e=e.substring(1)),t.qnum=+e))}),this.decodeBorderAns()},encodeData:function(){this.encodeCellExCell(function(t){if("excell"===t.group&&!t.isnull&&-1!==t.qnum)return(t.qcmp?"c":"")+t.qnum+" ";if("cell"===t.group){if(-1!==t.qnum)return t.qnum+" ";if(2===t.anum)return"A ";if(1===t.qsub)return"- "}return". "}),this.encodeBorderAns()}},AnsCheck:{checklist:["checkAroundTents","checkTreeNone","checkCampsGt","checkTentNone","checkCampsLt","checkTentCount+"],checkAroundTents:function(){this.checkAroundCell(function(t,e){return 2===t.getNum()&&2===e.getNum()},"tentAround")},checkTentNone:function(){this.checkCamps_inner(function(t){return 0===t.counts.tents},"nmTentNone")},checkTreeNone:function(){this.checkCamps_inner(function(t){return 0===t.counts.trees},"nmTreeNone")},checkCampsLt:function(){this.checkCamps_inner(function(t){return 0<t.counts.tents&&t.counts.tents<t.counts.trees},"nmTentLt")},checkCampsGt:function(){this.checkCamps_inner(function(t){return 0<t.counts.trees&&t.counts.tents>t.counts.trees},"nmTentGt")},checkCamps_inner:function(t,e){for(var i=this.board.campgraph.components,n=0;n<i.length;n++){var s=i[n];if(s&&t(s)){if(this.failcode.add(e),this.checkOnly)break;s.clist.seterr(1)}}},checkTentCount:function(){this.checkRowsCols(this.isExCellCount,"exTentNe")},getRowsColsValue:function(t){return t.filter(function(t){return 2===t.getNum()}).length}}});
//# sourceMappingURL=tents.js.map