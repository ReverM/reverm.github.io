/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,i){"object"==typeof module&&module.exports?module.exports=[e,i]:pzpr.classmgr.makeCustom(e,i)}(["kurodoko","nurimisaki","cave","teri"],{MouseEvent:{use:!0,autoedit_func:"qnum",autoplay_func:"cellpeke"},"MouseEvent@kurodoko":{inputModes:{edit:["number","clear","info-blk"],play:["shade","unshade","peke","info-blk"]},RBShadeCell:!0},"MouseEvent@teri":{inputModes:{edit:["number","clear","info-blk","info-ublk"],play:["shade","unshade","subline","info-blk","info-ublk"]},RBShadeCell:!0,mouseinputAutoPlay:function(){this.mousestart&&(this.isDraggingLine=this.puzzle.key.isALT),this.isDraggingLine?this.inputQsubLine():this.inputcell()},dispInfoUblk:function(){var e=this.getcell();this.mousereset(),!e.isnull&&e.isUnshade()&&(e.getVisibleCells().setinfo(2),this.board.hasinfo=!0,this.puzzle.redraw())}},"MouseEvent@nurimisaki":{inputModes:{edit:["number","clear","info-ublk"],play:["shade","unshade","info-ublk"]},autoplay_func:"cell"},"MouseEvent@cave":{inputModes:{edit:["number","clear","info-ublk"],play:["shade","unshade","peke","info-ublk"]}},KeyEvent:{enablemake:!0},Cell:{numberRemainsUnshaded:!0,maxnum:function(){return this.board.cols+this.board.rows-1},minnum:2,seterr:function(e){this.board.isenableSetError()&&(this.error<=0?this.error=e:this.error=Math.min(this.error,e))},getVisibleDirections:function(){var e,i={};for(e in this.adjacent)for(var t=this;i[e]="left"===e||"right"===e?t.bx:t.by,(t=t.adjacent[e]).isUnshade()&&!t.isnull;);return i},getVisibleCells:function(){var e=this.getVisibleDirections(),i=this.board.cellinside(e.left,this.by,e.right,this.by);return i.extend(this.board.cellinside(this.bx,e.top,this.bx,this.by-2)),i.extend(this.board.cellinside(this.bx,this.by+2,this.bx,e.bottom)),i}},"Cell@teri":{maxnum:function(){return this.board.cols*this.board.rows},getVisibleCells:function(){var e=this.getVisibleDirections(),i={},t={};i[this.bx]=e.top,t[this.bx]=e.bottom;for(var n=-2;n<=2;n+=4)for(var o=e.top,r=e.bottom,s=n<0?e.left:e.right,a=this.bx+n;a!==s+n;a+=n){for(var l,h=this.board.getc(a,this.by),c=h;c.by>o;){if((l=c.adjacent.top).isShade())break;c=l}for(o=c.by,i[a]=o,c=h;c.by<r;){if((l=c.adjacent.bottom).isShade())break;c=l}r=c.by,t[a]=r}for(var d={left:this.bx,right:this.bx,top:this.by,bottom:this.by,count:1},u=e.left;u<=this.bx;u+=2)for(var b=this.bx;b<=e.right;b+=2){var f=Math.max(i[u],i[b]),k=Math.min(t[u],t[b]),m=1+(b-u>>1),p=1+(k-f>>1);m*p>d.count&&(d={left:u,right:b,top:f,bottom:k,count:m*p})}return this.board.cellinside(d.left,d.top,d.right,d.bottom)}},CellList:{seterr:function(e){for(var i=0;i<this.length;i++)this[i].seterr(e)}},Board:{cols:9,rows:9,hasborder:1},AreaUnshadeGraph:{enabled:!0},"AreaShadeGraph@cave":{enabled:!0},Graphic:{hideHatena:!0,gridcolor_type:"DLIGHT",qanscolor:"black",enablebcolor:!0,numbercolor_func:"qnum",circleratio:[.45,.4],paint:function(){this.drawBGCells(),this.drawGrid(),this.drawShadedCells(),this.drawDotCells(),"teri"===this.pid?this.drawBorderQsubs():"kurodoko"===this.pid&&this.drawPekes(),this.drawCircledNumbers(),this.drawChassis(),this.drawTarget()},getBGCellColor:function(e){return 0<e.error||0<e.qinfo?this.errbcolor1:null}},"Graphic@cave":{hideHatena:!1,gridcolor_type:"DLIGHT",enablebcolor:!0,getBGCellColor:function(e){return 0<e.error||0<e.qinfo?this.errbcolor1:1===e.qsub?this.bcolor:null},qanscolor:"black",drawTrialMarks:function(){for(var e=this.vinc("cell_mark","auto",!0),i=(e.lineWidth=1,Math.max(.03*this.cw,2)),t=this.range.cells,n=0;n<t.length;n++){var o=t[n];e.vid="c_mark_"+o.id,1===o.qsub&&o.trial?(e.strokeStyle=this.trialcolor,e.strokeCross(o.bx*this.bw,o.by*this.bh,2*i)):e.vhide()}},paint:function(){this.drawBGCells(),this.drawDashedGrid(!1),this.drawShadedCells(),this.drawTrialMarks(),this.drawQuesNumbers(),this.drawPekes(),this.drawTarget()}},Encode:{decodePzpr:function(e){this.decodeNumber16()},encodePzpr:function(e){this.encodeNumber16()},decodeKanpen:function(){this.fio.decodeCellQnum_kanpen()},encodeKanpen:function(){this.fio.encodeCellQnum_kanpen()}},FileIO:{decodeData:function(){this.decodeCellQnum(),this.decodeCellAns(),"teri"===this.pid?this.decodeBorderAns():"kurodoko"!==this.pid&&"cave"!==this.pid||this.decodeBorderLine()},encodeData:function(){this.encodeCellQnum(),this.encodeCellAns(),"teri"===this.pid&&this.board.border.some(function(e){return e.qsub})?this.encodeBorderAns():"kurodoko"!==this.pid&&"cave"!==this.pid||this.encodeBorderLineIfPresent()},kanpenOpen:function(){this.decodeCellQnumAns_kanpen()},kanpenSave:function(){this.encodeCellQnumAns_kanpen()},kanpenOpenXML:function(){this.decodeCellQnum_XMLBoard(),this.decodeCellAns_XMLAnswer()},kanpenSaveXML:function(){this.encodeCellQnum_XMLBoard(),this.encodeCellAns_kurodoko_XMLAnswer()},UNDECIDED_NUM_XML:-4,encodeCellAns_kurodoko_XMLAnswer:function(){this.encodeCellXMLArow(function(e){if(-1===e.qnum){if(1===e.qans)return"w";if(1===e.qsub)return"s"}return"u"})}},AnsCheck:{checklist:["checkShadeCellExist","check2x2ShadeCell@nurimisaki","checkAdjacentShadeCell@kurodoko,teri","checkConnectUnshadeRB@kurodoko,teri","checkConnectUnshade@nurimisaki,cave","checkConnectShadeOutside@cave","checkViewOfNumber","check2x2UnshadeCell@nurimisaki","checkCirclePromontory@nurimisaki","checkNonCircleNotPromontory@nurimisaki","doneShadingDecided"],checkViewOfNumber:function(){for(var e=this.board.cell,i=0;i<e.length;i++){var t=e[i];if(t.isValidNum()){var n=t.getVisibleCells();if(t.qnum!==n.length){if(this.failcode.add("nmSumViewNe"),this.checkOnly)break;t.seterr(1),n.seterr(2)}}}}},"AnsCheck@nurimisaki":{check2x2UnshadeCell:function(){this.check2x2Block(function(e){return e.isUnshade()},"cu2x2")},checkCirclePromontory:function(){var i=this;this.checkAllCell(function(e){return e.isNum()&&!i.isPromontory(e)},"circleNotPromontory")},checkNonCircleNotPromontory:function(){var i=this;this.checkAllCell(function(e){return e.noNum()&&e.isUnshade()&&i.isPromontory(e)},"nonCirclePromontory")},isPromontory:function(e){var i=0;return e.adjacent.left.isUnshade()&&i++,e.adjacent.right.isUnshade()&&i++,e.adjacent.top.isUnshade()&&i++,e.adjacent.bottom.isUnshade()&&i++,1===i}},"AnsCheck@cave":{checkConnectShadeOutside:function(){for(var e=this.board,i=0;i<e.sblkmgr.components.length;i++){var t=e.sblkmgr.components[i].clist,n=t.getRectSize();if(n.x1!==e.minbx+1&&n.x2!==e.maxbx-1&&n.y1!==e.minby+1&&n.y2!==e.maxby-1){if(this.failcode.add("csConnOut"),this.checkOnly)break;t.seterr(1)}}}}});
//# sourceMappingURL=kurodoko.js.map