/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["batten"],{MouseEvent:{use:!0,inputModes:{edit:["mark-checkerboard","number"],play:["shade","unshade","completion"]},mouseinput_number:function(){this.mousestart&&this.inputqnum_excell()},mouseinput_auto:function(){this.puzzle.playmode?(this.mousestart&&this.inputqcmp(),(this.mousestart||this.mousemove)&&this.inputShade()):this.puzzle.editmode&&((this.mousestart||this.mousemove)&&this.inputcheckerboard(),this.mouseend&&this.notInputted()&&this.inputqnum_excell())},inputShade:function(){(1===this.inputData||2===this.inputData)&&this.board.cellsAreForcedOpposite(this.getcell(),this.mouseCell)||this.inputcell()},mouseinput_other:function(){"mark-checkerboard"===this.inputMode&&this.inputcheckerboard()},inputcheckerboard:function(){var e=this.getcross(),t=this.board;this.prevPos.equals(e)||e.bx<2||e.bx>t.maxbx-2||e.by<2||e.by>t.maxby-2||(this.prevPos.set(e),null===this.inputData&&(this.inputData=1===e.qnum?-1:1),this.puzzle.opemgr.disCombine=!0,e.setQnum(this.inputData),this.puzzle.opemgr.disCombine=!1,e.draw())},inputqnum_excell:function(){var e=this.getcell_excell();e.isnull||"excell"!==e.group||(e!==this.cursor.getex()?this.setcursor(e):this.inputqnum_main(e))},inputqcmp:function(){var e=this.getcell_excell();e.isnull||e.noNum()||"excell"!==e.group||(e.setQcmp(+!e.qcmp),e.draw(),this.mousereset())}},KeyEvent:{enablemake:!0,keyinput:function(e){this.cursor.getex().isnull?this.cursor.getx().isnull||this.key_inputcross(e):this.key_inputexcell(e)},key_inputcross:function(e){var t=this.cursor.getx();null!==t&&("1"===e?t.setQnum(1):" "!==e&&"-"!==e&&"0"!==e||t.setQnum(-1),t.draw())}},TargetCursor:{initCursor:function(){this.init(-1,-1)},movedir:function(e,t){var i=this.bx,s=this.by;this.common.movedir.call(this,e,t),this.isOutsideGrid()?1&this.bx||(this.bx--,this.by--):1&this.bx&&(this.bx++,this.bx>this.maxx&&(this.bx-=2),this.by++,this.by>this.maxy&&(this.by-=2),(this.bx<=0||this.by<=0)&&(this.bx=i,this.by=s))},isOutsideGrid:function(){return this.bx<=0||this.by<=0}},Cross:{maxnum:1},ExCell:{disInputHatena:!0,maxnum:function(){var e=this.bx,t=this.by;return-1===e&&-1===t?0:-1===t?this.board.rows:this.board.cols},minnum:0},Board:{hasexcell:1,hascross:1,cols:8,rows:8,cellsAreForcedOpposite:function(e,t){if(null===e||e.isnull||null===t||t.isnull||e===t||e.getOrthogonalCell(t)!==t)return!1;var e=e.getaddr(),t=t.getaddr(),i=(e.bx+t.bx)/2,s=(e.by+t.by)/2,r=i,o=s;return e.bx===t.bx?(i--,r++):(s--,o++),this.crossinside(i,s,r,o).some(function(e){return 1===e.qnum})}},BoardExec:{adjustBoardData:function(e,t){this.adjustExCellTopLeft_1(e,t)},adjustBoardData2:function(e,t){this.adjustExCellTopLeft_2(e,t)}},Graphic:{enablebcolor:!0,shadecolor:"#444444",paint:function(){this.drawBGCells(),this.drawDotCells(),this.drawShadedCells(),this.drawGrid(),this.drawNumbersExCell(),this.drawChassis(),this.drawCheckerboards(),this.drawCursor(this.puzzle.cursor.isOutsideGrid(),this.puzzle.editmode)},getQuesNumberColor:function(e){return 1===e.error?this.errcolor1:e.qcmp?this.qcmpcolor:this.quescolor},drawCheckerboards:function(){for(var e=this.vinc("checkerboard","auto"),t=(e.lineWidth=1,this.range),i=.35*this.bw,s=.35*this.bh,r=1+this.cw/40,o=this.board.crossinside(t.x1,t.y1,t.x2,t.y2),n=0;n<o.length;n++){var h=o[n],u=h.bx*this.bw,c=h.by*this.bh,l=1===h.error||1===h.qinfo;e.vid="s_checkerboard_back_"+h.id,1===h.qnum?(e.fillStyle=l?this.errcolor1:this.quescolor,e.strokeStyle=this.bgcolor,e.shapeRectCenter(u,c,i+r,s+r)):e.vhide(),e.vid="s_checkerboard_front_"+h.id,1===h.qnum?(e.fillStyle=l?this.errbcolor1:this.bgcolor,e.beginPath(),e.moveTo(u-i,c-s),e.lineTo(u,c-s),e.lineTo(u,c+s),e.lineTo(u+i,c+s),e.lineTo(u+i,c),e.lineTo(u-i,c),e.closePath(),e.fill()):e.vhide()}}},Encode:{decodePzpr:function(e){this.decodeCrossMark(),this.decodeNumber16ExCell()},encodePzpr:function(e){this.encodeCrossMark(),this.encodeNumber16ExCell()}},FileIO:{decodeData:function(){this.decodeCrossNum(),this.decodeCellExCell(function(e,t){"."!==t&&("excell"!==e.group||e.isnull?"cell"===e.group&&("#"===t?e.qans=1:"+"===t&&(e.qsub=1)):("c"===t[0]&&(e.qcmp=1,t=t.substring(1)),e.qnum=+t))})},encodeData:function(){this.encodeCrossNum(),this.encodeCellExCell(function(e){if("excell"===e.group&&!e.isnull&&-1!==e.qnum)return(e.qcmp?"c":"")+e.qnum+" ";if("cell"===e.group){if(1===e.qans)return"# ";if(1===e.qsub)return"+ "}return". "})}},AnsCheck:{checklist:["checkCheckerboardOnSymbol","checkCheckerboardOutsideSymbol","checkShadeCount","doneShadingDecided"],checkCheckerboardOnSymbol:function(){this.checkCheckerboard(1,!0,"shNoDiag")},checkCheckerboardOutsideSymbol:function(){this.checkCheckerboard(-1,!1,"shDiag")},checkCheckerboard:function(e,t,i){for(var s=this.board,r=0;r<s.cross.length;r++){var o=s.cross[r];if(o.qnum===e){var n=this.board.cellinside(o.bx-1,o.by-1,o.bx+1,o.by+1);if(this.areCheckerboard(n)!==t){if(this.failcode.add(i),this.checkOnly)break;(t?o:n).seterr(1)}}}},areCheckerboard:function(e){e=e.filter(function(e){return e.isShade()});if(2!==e.length)return!1;var t=e[0],e=e[1];return t.bx!==e.bx&&t.by!==e.by}}});
//# sourceMappingURL=batten.js.map