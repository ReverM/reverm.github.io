/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["railpool"],{MouseEvent:{inputModes:{edit:["border","empty","clear","info-line"],play:["line","peke","info-line"]},mouseinput_auto:function(){this.puzzle.playmode?"left"===this.btn?this.mousestart||this.mousemove?this.inputLine():this.mouseend&&this.notInputted()&&this.inputpeke():"right"===this.btn&&(this.mousestart||this.mousemove)&&this.inputpeke():this.puzzle.editmode&&("left"===this.btn?this.mousestart||this.mousemove?this.inputborder():this.mouseend&&this.notInputted()&&this.setcursor(this.getcell()):"right"===this.btn&&this.inputempty())}},KeyEvent:{enablemake:!0,keyinput:function(e){this.key_inputqnums(e)}},Cell:{distinctQnums:!0,noLP:function(e){return this.isEmpty()},getSegment:function(e){var t,n=new this.klass.PieceList;if(e){for(t=this;t.adjborder.right.isLine();t=t.adjacent.right)n.add(t.adjborder.right);for(t=this;t.adjborder.left.isLine();t=t.adjacent.left)n.add(t.adjborder.left)}else{for(t=this;t.adjborder.top.isLine();t=t.adjacent.top)n.add(t.adjborder.top);for(t=this;t.adjborder.bottom.isLine();t=t.adjacent.bottom)n.add(t.adjborder.bottom)}return n},seterr:function(e){this.board.isenableSetError()&&(this.error|=e)}},CellList:{getClueSet:function(){for(var e=[],t=0;t<this.length;t++)for(var n=this[t],r=0;r<n.qnums.length;r++){var i=n.qnums[r];-2!==i&&e.includes(i)||e.push(i)}return e},getSegmentLengthsSet:function(){for(var e=[],t=0;t<this.length;t++){var n=this[t],r=n.getSegment(!0),n=n.getSegment(!1);0<r.length&&!e.includes(r.length)&&e.push(r.length),0<n.length&&!e.includes(n.length)&&e.push(n.length)}return e}},Border:{enableLineNG:!0},Board:{hasborder:1},AreaRoomGraph:{enabled:!0},LineGraph:{enabled:!0},Graphic:{irowake:!0,getQuesNumberColor:function(e,t){return 1&e.error||e.error&8<<t?this.errcolor1:this.quescolor},paint:function(){this.drawBGCells(),this.drawGrid(),this.drawBorders(),this.drawTapaNumbers(),this.drawPekes(),this.drawLines(),this.drawChassis(),this.drawTarget()},getBGCellColor:function(e){return 7===e.ques?"black":this.getBGCellColor_error1(e)},getBorderColor:function(e){var t=e.sidecell[0],n=e.sidecell[1];return!e.inside||t.isnull||n.isnull||!t.isEmpty()&&!n.isEmpty()?this.getBorderColor_ques(e):"black"}},Encode:{decodePzpr:function(e){this.decodeNumber_railpool(),this.decodeBorder(),this.decodeEmpty()},encodePzpr:function(e){this.encodeNumber_railpool(),this.encodeBorder(),this.encodeEmpty()},decodeNumber_railpool:function(){for(var e=0,t=0,n=!1,r=this.outbstr,i=this.board,t=0;t<r.length;t++){var s=i.cell[e],o=r.charAt(t);if(this.include(o,"0","j")){for(s.qnums=[];this.include(o,"0","j");){for(var h=0;this.include(o,"a","j");)h=10*(h+(parseInt(o,36)-10)),o=r.charAt(++t);h+=parseInt(o,10),s.qnums.push(0===h?-2:+o),o=r.charAt(++t)}t--,e++,n=!0}else this.include(o,"k","z")&&(e+=parseInt(o,36)-19,n&&e--,n=!1);if(!i.cell[e]||"/"===o)break}this.outbstr=r.substr(t+1),"/"===this.outbstr[0]&&(this.outbstr=this.outbstr.substr(1))},encodeNumber_railpool:function(){for(var e=0,t="",n=this.board,r=0;r<n.cell.length;r++){var i="",s=n.cell[r].qnums;if(0<s.length)for(var o=0;o<s.length;o++){for(var h=s[o],l=[];0<h;){var c=h%10,h=Math.floor(h/10);l.push((h<10?c:c+10).toString(36))}0===l.length?i+="0":i+=l.reverse(l).join("")}else e++;0===e?(t+=i,e=1):""===i&&16!==e||(t+=(19+e).toString(36)+i,e=""===i?0:1)}t+=1<e?(19+e).toString(36):"/",this.outbstr+=t}},FileIO:{decodeData:function(){this.decodeQnums(),this.decodeEmpty(),this.decodeAreaRoom(),this.decodeBorderLine()},encodeData:function(){this.encodeQnums(),this.encodeEmpty(),this.encodeAreaRoom(),this.encodeBorderLine()},decodeEmpty:function(){this.decodeCell(function(e,t){"*"===t&&(e.ques=7)})},encodeEmpty:function(){this.encodeCell(function(e){return 7===e.ques?"* ":". "})}},AnsCheck:{checklist:["checkBranchLine","checkCrossLine","checkUncluedLength","checkMissingLength","checkTooManyUnspecified","checkTooFewUnspecified","checkDeadendLine+","checkOneLoop","checkNoLine"],checkUncluedLength:function(){for(var e=!0,t=this.board.roommgr.components,n=0;n<t.length;n++){var r=t[n].clist,i=t[n].clist.getClueSet();if(0!==i.length&&!i.includes(-2)){for(var s=0;s<r.length;s++){var o=r[s],h=o.getSegment(!0),o=o.getSegment(!1);if(0<h.length&&!i.includes(h.length)){if(e=!1,this.checkOnly)break;h.seterr(1),r.seterr(1)}if(0<o.length&&!i.includes(o.length)){if(e=!1,this.checkOnly)break;o.seterr(1),r.seterr(1)}}if(this.checkOnly&&!e)break}}e||(this.failcode.add("segUnclued"),this.board.border.setnoerr())},checkMissingLength:function(){for(var e=!0,t=this.board.roommgr.components,n=0;n<t.length;n++){var r=t[n].clist,i=t[n].clist.getClueSet();if(0!==i.length){for(var s=t[n].clist.getSegmentLengthsSet(),o=0;o<i.length;o++){var h=i[o];if(-2!==h&&!s.includes(h)){if(e=!1,this.checkOnly)break;for(var l=0;l<r.length;l++)for(var c=r[l],d=0;d<c.qnums.length;d++)c.qnums[d]===h&&c.seterr(8<<d)}}if(this.checkOnly&&!e)break}}e||this.failcode.add("clueUnused")},checkTooManyUnspecified:function(){for(var e=!0,t=this.board.roommgr.components,n=0;n<t.length;n++){var r=t[n].clist,i=r.getClueSet();if(0!==i.length){var s=r.getSegmentLengthsSet();if(i.length<s.length){if(e=!1,this.checkOnly)break;r.seterr(1);for(var o=0;o<r.length;o++){var h=r[o],l=h.getSegment(!0),h=h.getSegment(!1);0<l.length&&!i.includes(l.length)&&l.seterr(1),0<h.length&&!i.includes(h.length)&&h.seterr(1)}}}}e||this.failcode.add("tooManyUnspecified")},checkTooFewUnspecified:function(){for(var e=!0,t=this.board.roommgr.components,n=0;n<t.length;n++){var r=t[n].clist,i=r.getClueSet();if(0!==i.length){var s=r.getSegmentLengthsSet();if(i.length>s.length){if(e=!1,this.checkOnly)break;r.seterr(1);for(var o=0;o<r.length;o++){var h=r[o],l=h.getSegment(!0),h=h.getSegment(!1);0<l.length&&!i.includes(l.length)&&l.seterr(1),0<h.length&&!i.includes(h.length)&&h.seterr(1)}}}}e||this.failcode.add("tooFewUnspecified")}}});
//# sourceMappingURL=railpool.js.map