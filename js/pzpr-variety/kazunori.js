/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["kazunori"],{MouseEvent:{inputModes:{edit:["border","number"],play:["number","clear"]},mouseinput_number:function(){this.mousestart&&(this.puzzle.editmode?this.inputmark_mouseup():this.inputqnum())},mouseinput_auto:function(){this.puzzle.playmode?this.mousestart&&this.inputqnum():this.puzzle.editmode&&(this.mousestart||this.mousemove?"left"===this.btn&&this.inputborder():this.mouseend&&this.notInputted()&&this.inputmark_mouseup())},inputmark_mouseup:function(){var e,t,r,i=this.getpos(.33);i.isinside()&&(this.cursor.equals(i)?(e=i.getb()).isnull||(t=e.qnum,r=e.maxnum(),"left"===this.btn?-1===t?e.setQnum(-2):-2===t?e.setQnum(2):r<=t?e.setQnum(-1):e.setQnum(t+1):"right"===this.btn&&(-1===t?e.setQnum(r):2===t?e.setQnum(-2):-2===t?e.setQnum(-1):e.setQnum(t-1)),e.draw()):(this.setcursor(i),i.draw()))}},KeyEvent:{enablemake:!0,enableplay:!0,moveTarget:function(e){return this.puzzle.editmode?this.moveTBorder(e):!!this.puzzle.playmode&&this.moveTCell(e)},keyinput:function(e){this.puzzle.editmode?this.key_inputmark(e):this.puzzle.playmode&&this.key_inputqnum(e)},key_inputmark:function(e){var t=this.cursor.getb();if(!t.isnull){if(" "===e)t.setQnum(-1);else if("-"===e)t.setQnum(-2!==t.qnum?-2:-1);else{if(!("0"<=e&&e<="9"))return;var e=+e,r=t.qnum,i=t.maxnum();0<(e=this.prev===t&&0<r&&10*r+e<=i?10*r+e:e)&&e<=i&&t.setQnum(e)}(this.prev=t).draw()}}},TargetCursor:{adjust_modechange:function(){this.bx-=(this.bx+1)%2,this.by-=(this.by+1)%2}},Cell:{enableSubNumberArray:!0,maxnum:function(){return(this.room.clist.length+1)/2|0}},Border:{maxnum:function(){return this.sidecell[0].maxnum()+this.sidecell[1].maxnum()|0}},Board:{cols:8,rows:8,hasborder:1,disable_subclear:!0,addExtraInfo:function(){this.norigraph=this.addInfoList(this.klass.AreaNoriGraph)}},BoardExec:{adjustBoardData:function(e,t){this.adjustBorderArrow(e,t)}},AreaRoomGraph:{enabled:!0},"AreaNoriGraph:AreaGraphBase":{enabled:!0,relation:{"cell.anum":"node","border.ques":"separator"},setComponentRefs:function(e,t){e.nori=t},getObjNodeList:function(e){return e.norinodes},resetObjNodeList:function(e){e.norinodes=[]},isnodevalid:function(e){return 0<e.anum},isedgevalidbylinkobj:function(e){return e.sideobj[0].anum===e.sideobj[1].anum&&!e.isBorder()},isedgevalidbynodeobj:function(e,t){return e.anum===t.anum&&!this.board.getb(e.bx+t.bx>>1,e.by+t.by>>1).isBorder()}},Graphic:{hideHatena:!0,gridcolor_type:"LIGHT",paint:function(){this.drawBGCells(),this.drawTargetSubNumber(),this.drawGrid(),this.drawBorders(),this.drawQuesNumbersBD(),this.drawSubNumbers(),this.drawAnsNumbers(),this.drawChassis(),this.drawTarget_minarism()},drawQuesNumbersBD:function(){for(var e=this.vinc("border_nums","auto",!0),t=.27*this.cw,r=(e.lineWidth=1,e.strokeStyle=this.quescolor,{ratio:.45}),i=this.range.borders,n=0;n<i.length;n++){var s=i[n],u=s.bx*this.bw,o=s.by*this.bh;e.vid="b_cp_"+s.id,-1!==s.qnum?(e.fillStyle=1===s.error?this.errbcolor1:"white",e.shapeCircle(u,o,t)):e.vhide(),e.vid="border_text_"+s.id,0<s.qnum?(e.fillStyle=this.quescolor,this.disptext(""+s.qnum,u,o,r)):e.vhide()}},drawTarget_minarism:function(){this.drawCursor(this.puzzle.playmode)}},Encode:{decodePzpr:function(){this.decodeBorder(),this.decodeBorderNumber()},encodePzpr:function(){this.encodeBorder(),this.encodeBorderNumber()},decodeBorderNumber:function(){for(var e=0,t=this.outbstr,r=this.board,i=0;i<t.length;i++){var n=r.border[e],s=t.charAt(i);if(this.include(s,"0","9")||this.include(s,"a","f")?n.qnum=parseInt(s,16):"-"===s?(n.qnum=parseInt(t.substr(i+1,2),16),i+=2):"."===s?n.qnum=-2:this.include(s,"g","z")&&(e+=parseInt(s,36)-16),e++,!r.border[e])break}this.outbstr=t.substr(i+1)},encodeBorderNumber:function(){for(var e="",t=0,r=this.board,i=0,n=r.border.length;i<n;i++){var s="",u=r.border[i].qnum;-2===u?s=".":0<=u&&u<16?s=""+u.toString(16):16<=u&&u<256?s="-"+u.toString(16):t++,0===t?e+=s:!s&&20!==t||(e+=(15+t).toString(36)+s,t=0)}0<t&&(e+=(15+t).toString(36)),this.outbstr+=e}},FileIO:{decodeData:function(){this.decodeBorder(function(e,t){"|"===t?e.ques=1:"-"===t?(e.ques=1,e.qnum=-2):"!"===t?e.qnum=-2:"."!==t&&("!"!==t.charAt(0)?e.ques=1:t=t.substr(1),e.qnum=+t)}),this.decodeCellAnumsub()},encodeData:function(){this.encodeBorder(function(e){return 0<=e.qnum?(1===e.ques?"":"!")+e.qnum+" ":-2===e.qnum?1===e.ques?"- ":"! ":1===e.ques?"| ":". "}),this.encodeCellAnumsub()}},AnsCheck:{checklist:["checkBlockEvenSize","check2x2SameNumber","checkOverSaturatedNumberInRoom","checkSumOfNumber","checkNoNumCell+","checkSingleNoriSize"],checkBlockEvenSize:function(){this.checkAllArea(this.board.roommgr,function(e,t,r,i){return 0==(1&r)},"bkOddSize")},checkSingleNoriSize:function(){this.checkAllArea(this.board.norigraph,function(e,t,r,i){return 2<=r},"nmNotLink")},checkSumOfNumber:function(){for(var e=this.board.border,t=0;t<e.length;t++){var r=e[t],i=r.sidecell[0],n=r.sidecell[1];if(!(r.qnum<=0)){var s=i.anum,u=n.anum;if(-1!==s&&-1!==u&&r.qnum!==s+u){if(this.failcode.add("nmSumNe"),this.checkOnly)break;r.seterr(1),i.seterr(1),n.seterr(1)}}}},check2x2SameNumber:function(){var e=this.board;e:for(var t=0;t<e.cell.length;t++){var r=e.cell[t],i=r.bx,r=r.by;if(!(i>=e.maxbx-1||r>=e.maxby-1)){var n=e.cellinside(i,r,i+2,r+2);if(!(n[0].anum<=0)){for(var s=1;s<4;s++)if(n[0].anum!==n[s].anum)continue e;if(this.failcode.add("nmSame2x2"),this.checkOnly)break;n.seterr(1)}}}},checkOverSaturatedNumberInRoom:function(){for(var e=this.board.roommgr.components,t=0;t<e.length;t++){for(var r=e[t].clist,i=[],n=r[0].getmaxnum(),s=r[0].getminnum(),u=s;u<=n;u++)i[u]=0;for(var o=0;o<r.length;o++)r[o].anum>=s&&i[r[o].anum]++;var a=r.filter(function(e){return 3<=i[e.anum]});if(0!==a.length){if(this.failcode.add("bkSameNumGt2"),this.checkOnly)break;a.seterr(1)}}}}});
//# sourceMappingURL=kazunori.js.map