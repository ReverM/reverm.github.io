/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(t,e){"object"==typeof module&&module.exports?module.exports=[t,e]:pzpr.classmgr.makeCustom(t,e)}(["heyapin"],{MouseEvent:{use:!0,inputModes:{edit:["border","number","clear","info-room"],play:["pin","peke","clear","info-room"]},dispInfoRoom:function(){var t=this.getcell();this.mousereset(),t.isnull||(t.pinroom.clist.setinfo(1),this.board.hasinfo=!0,this.puzzle.redraw())},mouseinput_auto:function(){this.puzzle.playmode?1===this.puzzle.getConfig("use")?this.inputdot("left"===this.btn?1:2):this.inputdot():this.puzzle.editmode&&(this.mousestart||this.mousemove?this.inputborder():this.mouseend&&this.notInputted()&&this.inputqnum())},mouseinput_other:function(){"pin"===this.inputMode&&this.inputdot(1)},inputpeke:function(){this.inputdot(2)},mouseinput_clear:function(){this.puzzle.playmode?this.inputdot(0):this.inputFixedNumber(-1)},inputdot:function(t){var e=this.getcross();this.prevPos.equals(e)||(this.prevPos.set(e),null===this.inputData&&(void 0!==t?this.inputData=e.getPin()===t?0:t:"left"===this.btn?this.inputData={0:1,1:2,2:0}[e.getPin()]:"right"===this.btn&&(this.inputData={0:2,1:0,2:1}[e.getPin()])),e.setPin(this.inputData),e.draw())}},KeyEvent:{enablemake:!0},Cross:{getPin:function(){return this.qans?1:this.qsub?2:0},setPin:function(t){this.setQans(1===t?1:0),this.setQsub(2===t?1:0)}},Cell:{maxnum:function(){return this.room.xlist.length}},Board:{cols:6,rows:6,hasborder:1,hascross:2,addExtraInfo:function(){this.pingraph=this.addInfoList(this.klass.AreaPinGraph)}},AreaRoomGraph:{enabled:!0,hastop:!0,setExtraData:function(t){this.common.setExtraData.call(this,t);var e=new Set;t.clist.each(function(t){t.board.crossinside(t.bx-1,t.by-1,t.bx+1,t.by+1).each(function(t){e.add(t)})}),t.xlist=new this.klass.CrossList(Array.from(e))}},"AreaPinGraph:AreaGraphBase":{countprop:"l2cnt",relation:{"cell.ques":"node","border.ques":"separator","cross.qans":"pin"},enabled:!0,setComponentRefs:function(t,e){t.pinroom=e},getObjNodeList:function(t){return t.pinnodes},resetObjNodeList:function(t){t.pinnodes=[]},modifyOtherInfo:function(t,e){for(var i in t.adjborder)t.adjborder[i].isnull||this.setEdgeBySeparator(t.adjborder[i])},isnodevalid:function(t){return!0},isedgevalidbylinkobj:function(t){return!t.isBorder()||t.sidecross[0].qans||t.sidecross[1].qans}},Graphic:{gridcolor_type:"DARK",enablebcolor:!0,bgcellcolor_func:"qsub1",pekecolor:"rgb(127,127,255)",paint:function(){this.drawBGCells(),this.drawGrid(),this.drawQuesNumbers(),this.drawBorders(),this.drawChassis(),this.drawDots(),this.drawTarget()},padding:.25,getBoardCols:function(){return this.board.cols+2*this.padding},getBoardRows:function(){return this.board.rows+2*this.padding},getOffsetCols:function(){return this.padding},getOffsetRows:function(){return this.padding},drawDots:function(){for(var t=this.vinc("dot","auto"),e=this.range,i=.2*this.cw,o=(i<3&&(i=3),this.board.crossinside(e.x1,e.y1,e.x2,e.y2)),n=0;n<o.length;n++){var s=o[n],r=s.bx,a=s.by,r=r*this.bw,a=a*this.bh,h=(t.vid="s_dot_"+s.id,this.getPinOutlineColor(s));1===s.qans?(t.lineWidth=1+this.cw/20|0,t.strokeStyle=h,t.fillStyle=this.getPinFillColor(s),t.shapeCircle(r,a,.2*this.cw)):1===s.qsub?(t.lineWidth=1+this.cw/30|0,t.strokeStyle=h,t.beginPath(),t.moveTo(r-i,a-i),t.lineTo(r+i,a+i),t.moveTo(r-i,a+i),t.lineTo(r+i,a-i),t.closePath(),t.stroke()):t.vhide()}},getPinFillColor:function(t){return 1===t.qans?1===t.error?this.errbcolor1:"white":null},getPinOutlineColor:function(t){return t.trial?this.trialcolor:t.qans?1===t.error?this.errcolor1:-1===t.error?this.noerrcolor:this.qanscolor:this.pekecolor}},Encode:{decodePzpr:function(t){this.decodeBorder(),this.decodeRoomNumber16(),this.puzzle.setConfig("heyapin_overlap",this.checkpflag("o"))},encodePzpr:function(t){this.outpflag=this.puzzle.getConfig("heyapin_overlap")?"o":null,this.encodeBorder(),this.encodeRoomNumber16()}},FileIO:{decodeData:function(){this.decodeConfigFlag("o","heyapin_overlap"),this.decodeAreaRoom(),this.decodeCellQnum(),this.decodeCross(function(t,e){t.setPin(+e)})},encodeData:function(){this.encodeConfigFlag("o","heyapin_overlap"),this.encodeAreaRoom(),this.encodeCellQnum(),this.encodeCross(function(t){return t.getPin()+" "})}},AnsCheck:{checklist:["checkPinOverlap","checkPinCount","checkPinRoomConnect+"],checkPinRoomConnect:function(){this.checkOneArea(this.board.pingraph,"lnPlLoop")},checkPinCount:function(){for(var t=this.board.roommgr.components,e=0;e<t.length;e++){var i=t[e];if(i.top.isNum()&&i.xlist.filter(function(t){return t.qans}).length!==i.top.getNum()){if(this.failcode.add("bkPinNe"),this.checkOnly)break;i.clist.seterr(1)}}},checkPinOverlap:function(){if(this.puzzle.getConfig("heyapin_overlap"))for(var t=0;t<this.board.cross.length;t++){var e=this.board.cross[t];if(e.qans){var i=new Set,o=this.board.cellinside(e.bx-1,e.by-1,e.bx+1,e.by+1);if(o.each(function(t){i.add(t.room)}),!(2<=i.size)){if(this.failcode.add("cxOverlap"),this.checkOnly)break;this.board.cross.setnoerr(),e.seterr(1)}}}}},FailCode:{lnPlLoop:"lnPlLoop.ladders"}});
//# sourceMappingURL=heyapin.js.map