/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(i,t){"object"==typeof module&&module.exports?module.exports=[i,t]:pzpr.classmgr.makeCustom(i,t)}(["minarism","kropki"],{"MouseEvent@minarism#1":{inputModes:{edit:["ineq","number"],play:["number","clear"]},mouseinput:function(){this.puzzle.editmode&&this.inputMode.match(/number/)?this.mousestart&&this.inputmark_mouseup():this.common.mouseinput.call(this)},mouseinput_other:function(){"ineq"===this.inputMode&&(this.mousestart||this.mousemove)&&this.inputmark_mousemove()}},"MouseEvent@kropki#1":{inputModes:{edit:["circle-unshade","circle-shade"],play:["number","clear"]},mouseinput:function(){this.puzzle.editmode&&"auto"!==this.inputMode?this.mousestart&&this.inputmark_kropki():this.common.mouseinput.call(this)}},MouseEvent:{mouseinput_auto:function(){this.puzzle.playmode?this.mousestart&&this.inputqnum():this.puzzle.editmode&&("kropki"===this.pid?this.mousestart&&this.inputmark_kropki():this.mousestart||this.mousemove?"left"===this.btn&&this.inputmark_mousemove():this.mouseend&&this.notInputted()&&this.inputmark_mouseup())}},"MouseEvent@minarism":{inputmark_mousemove:function(){var i,t=this.getpos(0);if(!t.getc().isnull)return i=this.prevPos.getnb(t),i.isnull?void(this.prevPos=t):(this.inputData=this.prevPos.getdir(t,2),i.setQdir(this.inputData!==i.qdir?this.inputData:0),i.draw(),void this.mousereset())},inputmark_mouseup:function(){var i,t,e,s,r=this.getpos(.33);r.isinside()&&(this.cursor.equals(r)||"auto"!==this.inputMode?(i=r.getb()).isnull||(e=i.qdir,t=-1!==(t=i.qnum)?0<t?t:0:0<e?e-(i.bx%2==1?4:6):-1,e=Math.max(this.board.cols,this.board.rows)-1,s=-3,this.inputMode.match(/number/)&&(s=-1),"left"===this.btn?s<=t&&t<e?t++:t=s:"right"===this.btn&&(s<t&&t<=e?t--:t=e),0<=t?(i.setQdir(0),i.setQnum(1<=t?t:-2)):(-1===t?i.setQdir(0):i.setQdir(t+(i.bx%2==1?4:6)),i.setQnum(-1)),i.draw()):(this.setcursor(r),r.draw()))}},"MouseEvent@kropki":{inputmark_kropki:function(){var i,t,e=this.getpos(.33);e.isinside()&&(this.cursor.equals(e)||"auto"!==this.inputMode?(i=e.getb()).isnull||(t=i.qnum,"circle-unshade"===this.inputMode?i.setQnum(1!==i.qnum?1:0):"circle-shade"===this.inputMode?i.setQnum(2!==i.qnum?2:0):"left"===this.btn?-1===t?i.setQnum(1):1===t?i.setQnum(2):i.setQnum(-1):"right"===this.btn&&(-1===t?i.setQnum(2):2===t?i.setQnum(1):i.setQnum(-1)),i.draw()):(this.setcursor(e),e.draw()))}},KeyEvent:{enablemake:!0,enableplay:!0,moveTarget:function(i){return this.puzzle.editmode?this.moveTBorder(i):!!this.puzzle.playmode&&this.moveTCell(i)},keyinput:function(i){this.puzzle.editmode?this.key_inputmark(i):this.puzzle.playmode&&this.key_inputqnum(i)},key_inputmark:function(i){var t=this.cursor.getb();if(!t.isnull){if("kropki"===this.pid)if("1"===i||"2"===i)t.setQnum(+i);else{if(" "!==i&&"-"!==i)return;t.setQnum(-1)}else if("q"===i||"w"===i||"e"===i||" "===i||"-"===i){var e=t.NDIR;"q"===i&&(e=t.isHorz()?t.UP:t.LT),"w"===i&&(e=t.isHorz()?t.DN:t.RT),t.setQdir(t.qdir!==e?e:t.NDIR),t.setQnum(-1)}else{if(!("0"<=i&&i<="9"))return;var e=+i,i=t.qnum,s=Math.max(this.board.cols,this.board.rows)-1;t.setQdir(t.NDIR),!(i<=0||this.prev!==t)&&10*i+e<=s?t.setQnum(10*i+e):e<=s&&t.setQnum(e)}(this.prev=t).draw()}}},TargetCursor:{adjust_modechange:function(){this.bx-=(this.bx+1)%2,this.by-=(this.by+1)%2}},Cell:{enableSubNumberArray:!0,maxnum:function(){return Math.max(this.board.cols,this.board.rows)}},Board:{cols:7,rows:7,hasborder:1},"BoardExec@minarism":{adjustBoardData:function(i,t){this.adjustBorderArrow(i,t)}},Graphic:{hideHatena:!0,numbercolor_func:"anum",paint:function(){"minarism"===this.pid&&this.drawBDBase(),this.drawBGCells(),this.drawTargetSubNumber(),"minarism"===this.pid&&this.drawDashedGrid(),"kropki"===this.pid&&this.drawGrid(),"minarism"===this.pid&&this.drawQuesNumbers_and_IneqSigns(),"kropki"===this.pid&&this.drawStars(),this.drawSubNumbers(),this.drawAnsNumbers(),this.drawChassis(),this.drawTarget_minarism()},drawTarget_minarism:function(){this.drawCursor(this.puzzle.playmode)}},"Graphic@minarism":{gridcolor_type:"LIGHT",drawBDBase:function(){var i=this.vinc("border_base","auto");if(i.use.canvas)for(var t=.29*this.cw,e=this.range.borders,s=0;s<e.length;s++){var r,n=e[s];0===n.qdir&&-1===n.qnum||(r=n.bx*this.bw,n=n.by*this.bh,i.fillStyle="white",i.fillRectCenter(r,n,t,t))}},drawQuesNumbers_and_IneqSigns:function(){for(var i=this.vinc("border_marks","auto",!0),t=.27*this.cw,e=.22*this.cw,s=(i.lineWidth=1,i.strokeStyle=this.quescolor,{ratio:.45}),r=this.range.borders,n=0;n<r.length;n++){var o=r[n],u=o.bx*this.bw,h=o.by*this.bh;if(i.vid="b_cp_"+o.id,-1!==o.qnum?(i.fillStyle=1===o.error?this.errcolor1:"white",i.shapeCircle(u,h,t)):i.vhide(),i.vid="border_text_"+o.id,0<o.qnum?(i.fillStyle=this.quescolor,this.disptext(""+o.qnum,u,h,s)):i.vhide(),i.vid="b_is1_"+o.id,o.qdir===o.UP||o.qdir===o.LT){switch(i.beginPath(),o.qdir){case o.UP:i.setOffsetLinePath(u,h,-e,e,0,-e,e,e,!1);break;case o.LT:i.setOffsetLinePath(u,h,e,-e,-e,0,e,e,!1)}i.stroke()}else i.vhide();if(i.vid="b_is2_"+o.id,o.qdir===o.DN||o.qdir===o.RT){switch(i.beginPath(),o.qdir){case o.DN:i.setOffsetLinePath(u,h,-e,-e,0,e,e,-e,!1);break;case o.RT:i.setOffsetLinePath(u,h,-e,-e,e,0,-e,e,!1)}i.stroke()}else i.vhide()}}},"Graphic@kropki":{drawStars:function(){for(var i=this.vinc("star","auto",!0),t=(i.lineWidth=Math.max(.03*this.cw,1),this.range.borders),e=0;e<t.length;e++){var s=t[e],r=s.bx,n=s.by;i.vid="s_star1_"+s.id,1===s.qnum?(i.strokeStyle=1===s.error?this.errcolor1:this.quescolor,i.fillStyle="white",i.shapeCircle(r*this.bw,n*this.bh,.12*this.cw)):i.vhide(),i.vid="s_star2_"+s.id,2===s.qnum?(i.fillStyle=1===s.error?this.errcolor1:this.quescolor,i.fillCircle(r*this.bw,n*this.bh,.135*this.cw)):i.vhide()}}},"Encode@minarism":{decodePzpr:function(i){this.decodeMinarism(i)},encodePzpr:function(i){this.encodeMinarism(i)},decodeMinarism:function(i){var t=this.puzzle.pzpr.parser,e=0,s=0,r=0,n=this.outbstr,o=this.board,u=o.border.length;i===t.URL_PZPRAPP&&(u+=o.cols+o.rows);for(var h=0;h<n.length;h++){var a=n.charAt(h),d=(i===t.URL_PZPRAPP&&(e<o.cols*o.rows?r=e/o.cols|0:e<2*o.cols*o.rows&&(r=o.rows)),o.border[e-r]),c=0;if(this.include(a,"0","9")||this.include(a,"a","f")?d.qnum=parseInt(a,16):"-"===a?(d.qnum=parseInt(n.substr(h+1,2),16),h+=2):"."===a?d.qnum=-2:"g"===a?c=i===t.URL_PZPRV3||e<o.cols*o.rows?1:2:"h"===a?c=i===t.URL_PZPRV3||e<o.cols*o.rows?2:1:this.include(a,"i","z")?e+=parseInt(a,36)-18:i===t.URL_PZPRAPP&&"/"===a&&(e=o.cell.length-1),1===c?d.qdir=d.isHorz()?d.UP:d.LT:2===c&&(d.qdir=d.isHorz()?d.DN:d.RT),u<=++e){s=h+1;break}}this.outbstr=n.substr(s)},encodeMinarism:function(i){for(var t=this.puzzle.pzpr.parser,e="",s=0,r=this.board,n=0;n<r.border.length;n++){var o,u,h="",a=r.border[n];a?(o=a.qdir,u=a.qnum,o===a.UP||o===a.LT?h=i===t.URL_PZPRV3||r.cell[n]?"g":"h":o===a.DN||o===a.RT?h=i===t.URL_PZPRV3||r.cell[n]?"h":"g":-2===u?h=".":0<=u&&u<16?h=""+u.toString(16):16<=u&&u<256?h="-"+u.toString(16):s++):s++,0===s?e+=h:!h&&18!==s||(e+=(17+s).toString(36)+h,s=0)}0<s&&(e+=(17+s).toString(36)),this.outbstr+=e}},"Encode@kropki":{decodePzpr:function(i){this.decodeCircle_kropki(i)},encodePzpr:function(i){this.encodeCircle_kropki(i)},decodeCircle_kropki:function(i){for(var t=this.board,e=this.outbstr,s=0,r=[9,3,1],n=e?Math.min((t.border.length+2)/3|0,e.length):0,o=0;o<n;o++)for(var u,h=parseInt(e.charAt(o),27),a=0;a<3;a++)t.border[s]&&(0<(u=(h/r[a]|0)%3)&&(t.border[s].qnum=u),s++);this.outbstr=e.substr(n)},encodeCircle_kropki:function(i){for(var t=this.board,e="",s=0,r=0,n=[9,3,1],o=0;o<t.border.length;o++)0<t.border[o].qnum&&(r+=t.border[o].qnum*n[s]),3===++s&&(e+=r.toString(27),r=s=0);0<s&&(e+=r.toString(27)),this.outbstr+=e}},FileIO:{decodeData:function(){this.decodeBorder(function(i,t){"a"===t?i.qdir=i.isHorz()?i.UP:i.LT:"b"===t?i.qdir=i.isHorz()?i.DN:i.RT:"."===t?i.qnum=-2:"0"!==t&&(i.qnum=+t)}),this.decodeCellAnumsub()},encodeData:function(){this.encodeBorder(function(i){var t=i.qdir;return t===i.UP||t===i.LT?"a ":t===i.DN||t===i.RT?"b ":-2===i.qnum?". ":-1!==i.qnum?i.qnum+" ":"0 "}),this.encodeCellAnumsub()}},AnsCheck:{checklist:["checkDifferentNumberInLine","checkSubOfNumber@minarism","checkIneqMark@minarism","checkSubOfNumberIs1@kropki","checkSubOfNumberIsNot1@kropki","checkDivOfNumberIs2@kropki","checkDivOfNumberIsNot2@kropki","checkNoNumCell+"],checkHintSideCell:function(i,t){for(var e=this.board.border,s=0;s<e.length;s++){var r=e[s],n=r.sidecell[0],o=r.sidecell[1],u=n.getNum(),h=o.getNum();if(!(u<=0||h<=0)&&i(r,u,h)){if(this.failcode.add(t),this.checkOnly)break;n.seterr(1),o.seterr(1)}}}},"AnsCheck@minarism":{checkSubOfNumber:function(){this.checkHintSideCell(function(i,t,e){return 0<i.qnum&&i.qnum!==Math.abs(t-e)},"nmSubNe")},checkIneqMark:function(){this.checkHintSideCell(function(i,t,e){i=i.qdir;return!(0===i||(1===i||3===i)&&t<e||(2===i||4===i)&&e<t)},"nmIneqNe")}},"AnsCheck@kropki":{checkSubOfNumberIs1:function(){this.checkHintSideCell(function(i,t,e){return 1===i.qnum&&1!==Math.abs(t-e)},"nmSubNe1")},checkSubOfNumberIsNot1:function(){this.checkHintSideCell(function(i,t,e){return 1!==i.qnum&&1===Math.abs(t-e)&&!(2===i.qnum&&t*e==2)},"nmSubEq1")},checkDivOfNumberIs2:function(){this.checkHintSideCell(function(i,t,e){return 2===i.qnum&&!(2*t===e||t===2*e)},"nmDivNe2")},checkDivOfNumberIsNot2:function(){this.checkHintSideCell(function(i,t,e){return!(2===i.qnum||2*t!==e&&t!==2*e||1===i.qnum&&t*e==2)},"nmDivEq2")}}});
//# sourceMappingURL=minarism.js.map