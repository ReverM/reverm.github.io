/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["hashikake"],{MouseEvent:{inputModes:{edit:["number","clear"],play:["line","peke"]},autoedit_func:"qnum",autoplay_func:"line",prevblist:null,mousereset:function(){this.common.mousereset.call(this),this.prevblist=new this.klass.BorderList},inputLine:function(){var e,t,i,n,s=this.getpos(.2);this.prevPos.equals(s)||((e=this.prevPos.getlineobj(s)).isnull||(t=this.prevPos.getdir(s,1),i=e.getlinesize(),n=this.board.borderinside(i.x1,i.y1,i.x2,i.y2),0!==this.prevblist.length&&this.prevblist.include(e)||(this.inputData=null),null===this.inputData&&(this.inputData=[1,2,0][e.line]),0<this.inputData&&(t===e.UP||t===e.LT)&&n.reverse(),n.setLineVal(this.inputData),n.setQsub(0),this.prevblist=n,this.puzzle.painter.paintRange(i.x1-1,i.y1-1,i.x2+1,i.y2+1)),this.prevPos=s)},inputpeke:function(){var e,t,i=this.getpos(.22);"right"===this.btn&&this.prevPos.equals(i)||((e=i.getb()).isnull||(null===this.inputData&&(this.inputData=2!==e.qsub?2:0),e.setQsub(this.inputData),t=e.getlinesize(),this.board.borderinside(t.x1,t.y1,t.x2,t.y2).setLineVal(0),this.prevPos=i,this.puzzle.painter.paintRange(t.x1-1,t.y1-1,t.x2+1,t.y2+1),e.draw()))}},KeyEvent:{enablemake:!0},Cell:{maxnum:8,getCountOfBridges:function(){for(var e=0,t=this.getdir4cblist(),i=0;i<t.length;i++){var n=t[i][1];!n.isnull&&0<n.line&&(e+=n.line)}return e},isCmp:function(){return this.puzzle.execConfig("autocmp")&&this.qnum===this.getCountOfBridges()},getState:function(){if(-1!==this.qnum)return 0;var e=this.adjborder.top,t=this.adjborder.left,e=e.isnull?0:e.line,t=t.isnull?0:t.line;return(0<e?e:0)+(0<t?t<<2:0)},setState:function(e){var t,i,n,s;0!==e&&(t=this.adjborder,0<(s=3&e)&&(i=t.top,n=t.bottom,i.isnull||(i.line=s),n.isnull||(n.line=s)),0<(i=(12&e)>>2)&&(n=t.left,s=t.right,n.isnull||(n.line=i),s.isnull||(s.line=i)))}},Border:{getlinesize:function(){var e=this.getaddr(),t=e.clone();if(this.isVert()){for(;e.move(-1,0).getc().noNum();)e.move(-1,0);for(;t.move(1,0).getc().noNum();)t.move(1,0)}else{for(;e.move(0,-1).getc().noNum();)e.move(0,-1);for(;t.move(0,1).getc().noNum();)t.move(0,1)}return e.getc().isnull||t.getc().isnull?{x1:-1,y1:-1,x2:-1,y2:-1}:{x1:e.bx,y1:e.by,x2:t.bx,y2:t.by}}},BorderList:{setLineVal:function(t){this.each(function(e){e.setLineVal(t)})},setQsub:function(t){this.each(function(e){e.setQsub(t)})},reverse:Array.prototype.reverse},Address:{getlineobj:function(e){return 1==(1&e.bx)&&this.bx===e.bx&&1===Math.abs(this.by-e.by)||1==(1&e.by)&&this.by===e.by&&1===Math.abs(this.bx-e.bx)?(this.onborder()?this:e).getb():this.board.nullobj}},Board:{cols:9,rows:9,hasborder:1},LineGraph:{enabled:!0,isLineCross:!0,makeClist:!0,iscrossing:function(e){return e.noNum()}},Graphic:{hideHatena:!0,autocmp:"number",irowake:!0,gridcolor_type:"THIN",circleratio:[.47,.42],circlefillcolor_func:"qcmp",numbercolor_func:"qnum",lwratio:8,paint:function(){this.drawGrid(!1,this.puzzle.editmode&&!this.outputImage),this.drawPekes(),this.drawLines_hashikake(),this.drawCircledNumbers(),this.drawTarget()},drawLines_hashikake:function(e){for(var t=this.vinc("line","crispEdges"),i=1.5*this.lw,n=this.range.borders,s=0;s<n.length;s++){var r=n[s],o=this.getColorSolverAware(r.isLine(),r.isLineBySolver(),this.getLineColor(r)),l=r.isVert(),u=r.bx*this.bw,c=r.by*this.bh,h=this.lm+this.addlw/2;t.fillStyle=o,t.vid="b_line_"+r.id,!o||1!==r.line&&1!==r.lineBySolver?t.vhide():l?t.fillRectCenter(u,c,this.bw+h,h):t.fillRectCenter(u,c,h,this.bh+h),t.vid="b_dline_"+r.id,!o||2!==r.line&&2!==r.lineBySolver?t.vhide():(t.beginPath(),l?(t.rectcenter(u,c-i,this.bw+h,h),t.rectcenter(u,c+i,this.bw+h,h)):(t.rectcenter(u-i,c,h,this.bh+h),t.rectcenter(u+i,c,h,this.bh+h)),t.fill())}},repaintLines:function(e){this.range.borders=e,this.drawLines_hashikake(),this.context.use.canvas&&this.repaintParts(e)},repaintParts:function(e){this.range.cells=e.cellinside(),this.drawCircledNumbers()}},Encode:{decodePzpr:function(e){this.decodeNumber16()},encodePzpr:function(e){this.encodeNumber16()},decodeKanpen:function(){this.fio.decodeCellQnum_kanpen()},encodeKanpen:function(){this.fio.encodeCellQnum_kanpen()}},FileIO:{decodeData:function(){this.decodeCellQnum(),this.decodeBorderLine()},encodeData:function(){this.encodeCellQnum(),this.encodeBorderLine()},kanpenOpen:function(){this.decodeCell(function(e,t){"1"<=t&&t<="8"?e.qnum=+t:"9"===t&&(e.qnum=-2)}),this.decodeCell(function(e,t){"0"!==t&&e.setState(+t)})},kanpenSave:function(){this.encodeCell(function(e){return 0<e.qnum?e.qnum+" ":-2===e.qnum?"9 ":". "}),this.encodeCell(function(e){return e.getState()+" "})},kanpenOpenXML:function(){this.decodeCellQnum_XMLBoard(),this.decodeBorderLine_hashikake_XMLAnswer()},kanpenSaveXML:function(){this.encodeCellQnum_XMLBoard(),this.encodeBorderLine_hashikake_XMLAnswer()},UNDECIDED_NUM_XML:9,decodeBorderLine_hashikake_XMLAnswer:function(){this.decodeCellXMLArow(function(e,t){e.setState(+t.substr(1))})},encodeBorderLine_hashikake_XMLAnswer:function(){this.encodeCellXMLArow(function(e){return"n"+e.getState()})}},AnsCheck:{checklist:["checkLineExist+","checkCrossConnectLine","checkCellNumberNotOver","checkConnectAllNumber","checkCellNumberNotLess"],checkCellNumberNotOver:function(){this.checkAllCell(function(e){return e.isValidNum()&&e.qnum<e.getCountOfBridges()},"nmLineGt")},checkCellNumberNotLess:function(){this.checkAllCell(function(e){return e.isValidNum()&&e.qnum>e.getCountOfBridges()},"nmLineLt")}}});
//# sourceMappingURL=hashikake.js.map