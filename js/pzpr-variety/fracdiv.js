/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(t,e){"object"==typeof module&&module.exports?module.exports=[t,e]:pzpr.classmgr.makeCustom(t,e)}(["fracdiv"],{MouseEvent:{inputModes:{edit:["number","empty","clear"],play:["border","subline"]},mouseinput_auto:function(){this.puzzle.playmode?(this.mousestart||this.mousemove)&&("left"===this.btn&&this.isBorderMode()?this.inputborder():this.inputQsubLine()):this.puzzle.editmode&&this.mousestart&&this.input51()},mouseinput_clear:function(){this.input51_fixed()}},KeyEvent:{enablemake:!0,keyinput:function(t){"q"===t||this.cursor.getc().is51cell()?this.inputnumber51(t):this.key_inputqnum(t)}},TargetCursor:{chtarget:function(t,e,i){this.targetdir=t?e+i<0?4:2:2===this.targetdir?4:2,this.draw()},detectTarget:function(t){t=t||this.getobj();return t&&!t.isnull&&t.is51cell()?this.targetdir:0}},Cell:{disInputHatena:!0,shouldDraw51cell:function(){return!!this.is51cell()&&(!this.puzzle.playeronly&&!this.puzzle.painter.outputImage||-1!==this.qnum&&-2!==this.qnum&&-1!==this.qnum2&&-2!==this.qnum2)},posthook:{qnum:function(){this.updateQnums()},qnum2:function(){this.updateQnums()}},updateQnums:function(){this.isValid()&&(this.qnums=this.is51cell()?this.board.normalizeDiv(this.qnum,this.qnum2):[],this.board.roommgr.setExtraData(this.room))},minnum:function(){return this.is51cell()?0:1},maxnum:function(){return this.is51cell()?999:9},isNum:function(){return this.is51cell()}},CellList:{singleQnumCell:!0},Border:{isGrid:function(){return this.sidecell[0].isValid()&&this.sidecell[1].isValid()},isBorder:function(){return 0<this.qans||this.isQuesBorder()},isQuesBorder:function(){return this.sidecell[0].isEmpty()||this.sidecell[1].isEmpty()},prehook:{qans:function(){return!this.isGrid()},qsub:function(){return!this.isGrid()}}},Board:{hasborder:1,cols:8,rows:8,rebuildInfo:function(){this.common.rebuildInfo.call(this),this.cell.each(function(t){t.updateQnums()})},normalizeDiv:function(t,e){if(0===e)return[0,0];if(t<0)return[];if(0===t)return[0,1];if(e<0)return[t,1];for(var i=t,s=e;0!==s;)var n=s,s=i%s,i=n;return[t/i,e/i]}},AreaRoomGraph:{enabled:!0,setExtraData:function(t){var e=t.clist=new this.klass.CellList(t.getnodeobjs()),i=0;e.each(function(t){!t.is51cell()&&0<t.qnum&&(i+=t.qnum)}),t.ansfrac=this.board.normalizeDiv(i,e.length)}},Graphic:{gridcolor_type:"SLIGHT",bordercolor_func:"qans",dotPatterns:[16,257,84,325,341,455,381,495,511],drawDotPatterns:function(){for(var t=this.vinc("cell_dotps","auto"),e=this.range.cells,i=0;i<e.length;i++){var s=e[i],n=!s.is51cell()&&this.dotPatterns[s.qnum-1]||0,r=1===s.qnum?this.cw/4:s.qnum<6?this.cw/5:this.cw/6,u=this.cw/4;t.fillStyle=1===s.error||1===s.qinfo?this.errcolor1:this.quescolor;for(var o,l,h=0;h<9;h++)t.vid="c_dotp_"+s.id+"_"+h,n&1<<h?(o=s.bx*this.bw,l=s.by*this.bh,h%3==0?o-=u:h%3==2&&(o+=u),0==(h/3|0)?l-=u:2==(h/3|0)&&(l+=u),t.fillCircle(o,l,r/2)):t.vhide()}},paint:function(){this.drawBGCells(),this.drawQues51(),this.drawQuesNumbersOn51(),this.drawQuesNumbers(),this.drawDotPatterns(),this.drawDashedGrid(),this.drawQansBorders(),this.drawQuesBorders(),this.drawBorderQsubs(),this.drawChassis(),this.drawTarget()},getQuesBorderColor:function(t){return t.isQuesBorder()?this.quescolor:null},getBGCellColor:function(t){return t.isValid()?this.getBGCellColor_error1(t):"black"},drawSlash51Cells:function(){for(var t=this.vinc("cell_ques51","auto",!0),e=(t.strokeStyle=this.quescolor,t.lineWidth=2,this.bw/3),i=this.bh/3,s=this.range.cells,n=0;n<s.length;n++){var r,u=s[n];t.vid="c_slash51b_"+u.id,u.shouldDraw51cell()?(r=u.bx*this.bw,u=u.by*this.bh,t.strokeLine(r-this.bw+e,u+this.bh-i,r+this.bw-e,u-this.bh+i)):t.vhide()}},drawTriangle1:function(t,e,i){var s=this.context,n=this.bw+1-.5,r=this.bh+1-.5;switch(s.beginPath(),i){case 2:s.setOffsetLinePath(t,e,n,-r,-n,r,n,r,!0);break;case 4:s.setOffsetLinePath(t,e,-n,-r,n,-r,-n,r,!0)}s.fill()},getQuesNumberText:function(t){return!t.is51cell()||t.shouldDraw51cell()?null:this.getNumberText(t,-1===t.qnum?-2:t.qnum)},drawQuesNumbersOn51_1:function(t){var e,i=this.context,s=t.bx*this.bw,n=t.by*this.bh,r={ratio:.45};i.fillStyle=1===t.error||1===t.qinfo?this.errcolor1:this.quescolor,e=t.shouldDraw51cell()?t.qnum:-1,i.vid=[t.group,t.id,"text_ques51_num"].join("_"),0<=e?(r.position=this.TOPLEFT,this.disptext(""+e,s,n,r)):i.vhide(),e=t.shouldDraw51cell()?t.qnum2:-1,i.vid=[t.group,t.id,"text_ques51_div"].join("_"),0<=e?(r.position=this.BOTTOMRIGHT,this.disptext(""+e,s,n,r)):i.vhide()}},Encode:{decodePzpr:function(t){var s=this.board;this.genericDecodeNumber16(2*s.cell.length,function(t,e){var i=s.cell[t>>1];1&t?-2===e?0===i.qnum?(i.ques=7,i.qnum=-1):i.ques=0:(i.qnum2=e,-2===i.qnum&&i.qnum):(i.qnum=e,i.ques=51)})},encodePzpr:function(t){var i=this.board;this.genericEncodeNumber16(2*i.cell.length,function(t){var e=i.cell[t>>1];return 1&t?e.is51cell()?-2===e.qnum2?-1:e.qnum2:-1===e.qnum&&0===e.ques?-1:-2:e.is51cell()&&-1===e.qnum?-2:e.isValid()||e.is51cell()?e.qnum:0})}},FileIO:{decodeData:function(){this.decodeCell(function(t,e){"#"===e?t.ques=7:"d"===e[0]?t.qnum=+e.substring(1):"."!==e&&(e=e.split(","),t.ques=51,t.qnum=+e[0],t.qnum2=+e[1])}),this.decodeBorderAns()},encodeData:function(){this.encodeCell(function(t){return t.isValid()?t.is51cell()?t.qnum+","+t.qnum2+" ":-1!==t.qnum?"d"+t.qnum+" ":". ":"# "}),this.encodeBorderAns()}},AnsCheck:{checklist:["checkNoNumber","checkFractionEqual","checkDoubleNumber","checkBorderDeadend+"],checkFractionEqual:function(){for(var t=this.board.roommgr.components,e=0;e<t.length;e++){var i=t[e],s=i.clist,n=s.getQnumCell();if(!n.isnull&&0!==n.qnums.length&&!this.puzzle.pzpr.util.sameArray(n.qnums,i.ansfrac)){if(this.failcode.add("bkCircleNe"),this.checkOnly)return;s.seterr(1)}}}}});
//# sourceMappingURL=fracdiv.js.map