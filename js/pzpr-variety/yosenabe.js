/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["yosenabe","yajisoko","brownies"],{"MouseEvent@yosenabe":{inputModes:{edit:["nabe","number","clear"],play:["line","peke","completion"]},mouseinput_other:function(){"nabe"===this.inputMode&&this.inputNabe()},mouseinput_auto:function(){this.puzzle.playmode?this.mousestart||this.mousemove?"left"===this.btn?this.inputLine():"right"===this.btn&&this.inputpeke():this.mouseend&&this.notInputted()&&this.inputqcmp():this.puzzle.editmode&&(this.mousestart||this.mousemove?"right"===this.btn&&this.inputNabe():this.mouseend&&this.notInputted()&&this.inputqnum_yosenabe())},inputNabe:function(){var e=this.getcell();if(!e.isnull&&e!==this.mouseCell){if("nabe"!==this.inputMode){if(e.isNum())return void this.inputqnum();if(-1!==e.qnum2)return void this.inputqnum_yosenabe()}null===this.inputData&&(this.inputData=e.ice()?0:6),e.setQues(this.inputData),e.drawaround(),this.mouseCell=e}},inputqnum_yosenabe:function(){var e=this.getcell();e.isnull||e===this.mouseCell||(e!==this.cursor.getc()?this.setcursor(e):this.inputnumber_yosenabe(e),this.mouseCell=e)},inputnumber_yosenabe:function(e){var t,i=e.getmaxnum(),n=-1,s=-1!==e.qnum?(t=e.qnum,1):-1!==e.qnum2?(t=e.qnum2,2):(t=-1,e.ice()?2:1);"left"===this.btn?n=t===i?-1:-1===t?-2:-2===t?1:t+1:"right"===this.btn&&(n=-1===t?i:-2===t?-1:1===t?-2:t-1),1===s?e.setQnum(n):2===s&&e.setQnum2(n),e.draw()}},MouseEvent:{inputqcmp:function(){var e=this.getcell();return!e.isnull&&this.inputdark(e)},inputdark:function(e){var t=this.puzzle.execConfig("dispmove")?e.base:e,i=this.inputPoint.bx-e.bx,n=this.inputPoint.by-e.by;return!(!t.isNum()||!("completion"===this.inputMode||i*i+n*n<.36))&&(t.setQcmp(0===t.qcmp?1:0),e.draw(),!0)}},"MouseEvent@brownies#1":{inputModes:{edit:["number","box","shade","clear"],play:["line","peke","bgcolor","bgcolor1","bgcolor2","completion"]},inputShade:function(){this.inputFixedNumber(-2)},inputqcmp:function(){var e=this.getcell();return!e.isnull&&(-1!==e.qnum2?(e.setQcmp(+!e.qcmp),e.draw(),this.mousereset(),!0):this.inputdark(e))}},"MouseEvent@yajisoko#1":{inputModes:{edit:["number","direc","box","empty","clear"],play:["line","peke","bgcolor","bgcolor1","bgcolor2","completion"]}},"MouseEvent@yajisoko,brownies":{mouseinput_other:function(){"box"===this.inputMode?this.inputFixedNumber(-3):"empty"===this.inputMode&&this.inputFixedNumber(-5)},mouseinput_auto:function(){this.puzzle.playmode?this.mousestart||this.mousemove?"left"===this.btn?this.inputLine():"right"===this.btn&&this.inputdragcross():this.mouseend&&this.notInputted()&&("left"===this.btn&&this.inputqcmp()||this.inputpeke_ifborder()||this.inputBGcolor()):this.puzzle.editmode&&"brownies"===this.pid?this.mousestart&&this.inputqnum():this.puzzle.editmode&&(this.mousestart||this.mousemove?this.notInputted()&&this.inputdirec():this.mouseend&&this.notInputted()&&this.prevPos.getc()===this.getcell()&&this.inputqnum())},inputdragcross:function(){var e;null===this.firstPoint.bx?this.firstPoint.set(this.inputPoint):(null!==this.inputData||.1<(e=this.inputPoint.bx-this.firstPoint.bx)*e+(e=this.inputPoint.by-this.firstPoint.by)*e)&&this.inputFixedQsub(2)},inputdirec:function(){var e,t,i=this.getpos(0);this.prevPos.equals(i)||((e=this.prevPos.getc()).isnull||-1===e.qnum2||(t=this.prevPos.getdir(i,2))!==e.NDIR&&(e.setQdir(e.qdir!==t?t:0),e.draw()),this.prevPos=i)},getNewNumber:function(e,t){return"left"===this.btn&&-1===t?-3:"left"===this.btn&&-2===t?0:"left"===this.btn&&t===e.getmaxnum()?-1:"right"===this.btn&&0===t?-2:"right"===this.btn&&-1===t?e.getmaxnum():(t+="left"===this.btn?1:-1)<-3?-1:t}},"KeyEvent@yosenabe":{enablemake:!0,key_inputqnum_main:function(e,t){this.key_inputqnum_main_yosenabe(e,t)},key_inputqnum_main_yosenabe:function(e,t){var i,n;"q"===t||"q1"===t||"q2"===t?"q1"===(t="q"===t?-1!==e.qnum?"q1":"q2":t)&&-1!==e.qnum?(e.setQnum2(e.qnum),e.setQnum(-1),e.draw()):"q2"===t&&-1!==e.qnum2&&(e.setQnum(e.qnum2),e.setQnum2(-1),e.draw()):"w"===t?(e.setQues(e.ice()?0:6),e.draw()):(i=-1,n=-(n=1)!==e.qnum?(i=e.qnum,1):-1!==e.qnum2?(i=e.qnum2,2):e.ice()?2:1,null!==(t=this.getNewNumber(e,t,i))&&(1===n?e.setQnum(t):2===n&&e.setQnum2(t),e.draw(),this.prev=e))}},"KeyEvent@yajisoko,brownies":{enablemake:!0,getNewNumber:function(e,t,i){t=this.common.getNewNumber.call(this,e,t,i);return this.puzzle.execConfig("dispmove")&&-3===i&&e.lcnt&&null!==t&&-3!==t?-1:t}},"KeyEvent@yajisoko#1":{moveTarget:function(e){return!e.match(/shift/)&&this.moveTCell(e)},keyinput:function(e){this.key_inputdirec(e)||("q"===e||"q1"===e?e="s2":"i"===e?e="s3":"w"===e&&(e="s4"),this.key_inputqnum(e))}},"KeyEvent@brownies#1":{keyinput:function(e){"q"===e||"q1"===e?e="s2":"w"===e&&(e="-"),this.key_inputqnum(e)}},Cell:{isCmp:function(){return 1===(this.puzzle.execConfig("dispmove")?this.base:this).qcmp},posthook:{qnum:function(e){-1===e&&null!==this.path&&this.path.getedgeobjs().forEach(function(e){e.removeLine(),e.draw()})}}},"Cell@yajisoko#1":{maxnum:function(){var e=this.board;return Math.max(e.cols,e.rows)-1},noLP:function(){return-5===this.qnum2}},"Cell@brownies#1":{maxnum:8,noLP:function(e){return-1!==this.qnum2}},"Cell@yajisoko,brownies":{minnum:0,getNum:function(){return-2===this.qnum?-3:this.qnum2},setNum:function(e){-3===e?(e=-2===this.qnum?-1:-2,this.setQnum2(-1),this.setQnum(e)):(e=-2===e&&this.qnum2===e?-1:e,this.setQnum(-1),this.setQnum2(e))}},CellList:{getDeparture:function(){return this.map(function(e){return e.base}).notnull()},getSumOfFilling:function(e){for(var t=0,i=0,n=this.length;i<n;i++)this[i].base.isValidNum()&&(t+=this[i].base.qnum);return t}},Border:{enableLineNG:!0,prehook:{line:function(e){return this.puzzle.execConfig("dispmove")&&(this.checkStableLine(e)||this.checkFormCurve(e))}}},Board:{cols:8,rows:8,hasborder:1,addExtraInfo:function(){this.icegraph=this.addInfoList(this.klass.AreaCrockGraph)}},"BoardExec@yajisoko":{adjustBoardData:function(e,t){this.adjustNumberArrow(e,t)}},LineGraph:{enabled:!0,moveline:!0},"AreaCrockGraph:AreaGraphBase":{enabled:!0,relation:{"cell.ques":"node"},setComponentRefs:function(e,t){e.icebarn=t},getObjNodeList:function(e){return e.icebarnnodes},resetObjNodeList:function(e){e.icebarnnodes=[]},isnodevalid:function(e){return e.ice()}},"Graphic@yosenabe":{hideHatena:!0,gridcolor_type:"LIGHT",bgcellcolor_func:"icebarn",bordercolor_func:"ice",numbercolor_func:"move",circlefillcolor_func:"qcmp",icecolor:"rgb(224,224,224)",paint:function(){this.drawBGCells(),this.drawGrid(),this.drawBorders(),this.drawTip(),this.drawDepartures(),this.drawLines(),this.drawCircledNumbers(),this.drawFillingNumBase(),this.drawFillingNumbers(),this.drawPekes(),this.drawChassis(),this.drawTarget()},drawFillingNumBase:function(){for(var e=this.vinc("cell_filling_back","crispEdges",!0),t=this.puzzle.execConfig("dispmove"),i=this.range.cells,n=0;n<i.length;n++){var s,r=i[n],o=this.getBGCellColor(r);e.vid="c_full_nb_"+r.id,o&&-1!==r.qnum2&&t&&r.isDestination()?(s=(r.bx-.9)*this.bw-.5,r=(r.by-.9)*this.bh-.5,e.fillStyle=o,e.fillRect(s,r,.8*this.bw,.8*this.bh)):e.vhide()}},drawFillingNumbers:function(){for(var e=this.vinc("cell_filling_number","auto"),t=this.puzzle.execConfig("dispmove"),i=this.range.cells,n=0;n<i.length;n++){var s,r=i[n],o=r.qnum2,u=r.bx*this.bw,c=r.by*this.bh;e.vid="cell_fill_text_"+r.id,-1!==o?(o=0<o?""+o:"?",s={style:"bold"},t&&r.isDestination()?(s.position=this.TOPLEFT,s.ratio=.4,s.width=[.5,.33]):s.ratio=.6,e.fillStyle=this.getQuesNumberColor(r),this.disptext(o,u,c,s)):e.vhide()}}},"Graphic@yajisoko":{bgcellcolor_func:"qsub2",fontsizeratio:.75,circlefillcolor_func:"qcmp",circlebasecolor:"#CFCFCF",qcmpcolor:"gray",qsubcolor1:"rgb(224, 224, 255)",qsubcolor2:"rgb(255, 255, 144)",paint:function(){this.drawBGCells(),this.drawGrid(),this.drawTip(),this.drawDepartures(),this.drawLines(),this.drawBoxes(),this.drawArrowNumbers({scale:.75,arrowfontsize:.6,bottom:!0}),this.drawPekes(),this.drawChassis(),this.drawTarget()},getNumberText:function(e,t){return-4===t?"âˆž":this.getNumberTextCore(t)},getQuesNumberColor:function(e){return this.puzzle.execConfig("dispmove")&&1===e.lcnt?"#00000050":this.quescolor},getBGCellColor:function(e){return-5===e.qnum2?e.error?this.errcolor1:"black":this.getBGCellColor_qsub2(e)},drawBoxes:function(){for(var e=this.vinc("cell_boxes","auto",!0),t=this.circleratio,i=this.cw*(t[0]+t[1])/2,n=this.cw*t[0],s=this.range.cells,r=0;r<s.length;r++){var o=s[r],u=this.getCircleFillColor(o);e.vid="c_cirb_"+o.id,u?(e.fillStyle=u,e.fillRectCenter(o.bx*this.bw,o.by*this.bh,n,n)):e.vhide()}(e=this.vinc("cell_boxes_stroke","auto",!0)).lineWidth=Math.max(this.cw*(t[0]-t[1]),1);for(r=0;r<s.length;r++){o=s[r],u=this.getCircleStrokeColor(o);e.vid="c_cira_"+o.id,u?(e.strokeStyle=u,e.strokeRectCenter(o.bx*this.bw,o.by*this.bh,i,i)):e.vhide()}},getQuesNumberText:function(e){return this.getNumberText(e,e.qnum2)}},"Graphic@brownies":{hideHatena:!0,bgcellcolor_func:"qsub2",circlefillcolor_func:"qcmp",qcmpcolor:"gray",qsubcolor1:"rgb(224, 224, 255)",qsubcolor2:"rgb(255, 255, 144)",paint:function(){this.drawBGCells(),this.drawGrid(),this.drawQuesCells(),this.drawQuesNumbers(),this.drawTip(),this.drawDepartures(),this.drawLines(),this.drawCircles(),this.drawPekes(),this.drawChassis(),this.drawTarget()},getQuesCellColor:function(e){return-1===e.qnum2?null:1===(e.error||e.qinfo)?this.errcolor1:this.quescolor},getQuesNumberText:function(e){return this.getNumberText(e,e.qnum2)},getQuesNumberColor:function(e){return 1===e.qcmp?this.qcmpcolor:this.fontShadecolor}},"Encode@yosenabe":{decodePzpr:function(e){this.decodeIce(),this.decodeNumber16_yosenabe()},encodePzpr:function(e){this.encodeIce(),this.encodeNumber16_yosenabe()},decodeNumber16_yosenabe:function(){for(var e=0,t=0,i=this.outbstr,n=this.board,t=0;t<i.length;t++){var s=n.cell[e],r=i.charAt(t);if(this.include(r,"0","9")||this.include(r,"a","f")?s.qnum=parseInt(r,16):"-"===r?(s.qnum=parseInt(i.substr(t+1,2),16),t+=2):"."===r?s.qnum=-2:"i"===r?(s.qnum2=parseInt(i.substr(t+1,1),16),t+=1):"g"===r?(s.qnum2=parseInt(i.substr(t+1,2),16),t+=2):"h"===r?s.qnum2=-2:"j"<=r&&r<="z"&&(e+=parseInt(r,36)-19),e++,!n.cell[e])break}this.outbstr=i.substr(t+1)},encodeNumber16_yosenabe:function(){for(var e=0,t="",i=this.board,n=0;n<i.cell.length;n++){var s="",r=i.cell[n].qnum,o=i.cell[n].qnum2;-2===r?s=".":0<=r&&r<16?s=r.toString(16):16<=r&&r<256?s="-"+r.toString(16):-2===o?s="h":0<=o&&o<16?s="i"+o.toString(16):16<=o&&o<256?s="g"+o.toString(16):e++,0===e?t+=s:!s&&17!==e||(t+=(18+e).toString(36)+s,e=0)}0<e&&(t+=(18+e).toString(36)),this.outbstr+=t}},"Encode@yajisoko":{decodePzpr:function(e){var i=this.board;this.genericDecodeNumber16(i.cell.length,function(e,t){e=i.cell[e];-2===t?e.qnum=-2:-1!==t&&(e.qdir=t%5,e.qnum2=t/5|0,0===e.qnum2?e.qnum2=-4:1===e.qnum2?e.qnum2=-2:e.qnum2-=2)}),this.decodeBinary("qnum2",-5)},encodePzpr:function(e){var t=this.board;this.genericEncodeNumber16(t.cell.length,function(e){e=t.cell[e];return-1===e.qnum2?e.qnum:5*(-4===e.qnum2?0:-2===e.qnum2?1:e.qnum2+2)+e.qdir}),this.encodeBinary("qnum2",-5,!0)}},"Encode@brownies":{decodePzpr:function(e){var i=this.board;this.genericDecodeNumber16(i.cell.length,function(e,t){e=i.cell[e];9===t?e.qnum=-2:-1!==t&&(e.qnum2=t)})},encodePzpr:function(e){var t=this.board;this.genericEncodeNumber16(t.cell.length,function(e){e=t.cell[e];return-2===e.qnum?9:e.qnum2})}},"FileIO@yosenabe":{decodeData:function(){this.decodeCell(function(e,t){"i"===t.charAt(0)&&(e.ques=6,t=t.substr(1)),"o"===t.charAt(0)?(t=t.substr(1),e.qnum=t?+t:-2):t&&"."!==t&&(e.qnum2=+t)}),this.decodeBorderLine(),1<=this.filever&&this.decodeCellQsubQcmp()},encodeData:function(){this.filever=1,this.encodeCell(function(e){var t="";return 6===e.ques&&(t+="i"),-1!==e.qnum?(t+="o",0<=e.qnum&&(t+=""+e.qnum)):0<e.qnum2&&(t+=""+e.qnum2),(t||".")+" "}),this.encodeBorderLine(),this.encodeCellQsubQcmp()}},FileIO:{decodeCellQsubQcmp:function(){this.decodeCell(function(e,t){"0"!==t&&(e.qsub=15&+t,e.qcmp=+t>>4)})},encodeCellQsubQcmp:function(){this.encodeCell(function(e){return e.qsub+(e.qcmp<<4)+" "})}},"FileIO@yajisoko":{decodeData:function(){this.decodeCellDirecQnum(),this.decodeBorderLine(),this.decodeCellQsubQcmp()},encodeData:function(){this.encodeCellDirecQnum(),this.encodeBorderLine(),this.encodeCellQsubQcmp()},decodeCellDirecQnum:function(){this.decodeCell(function(e,t){"#"===t?(e.qdir=0,e.qnum=-2):"."!==t&&(t=t.split(","),e.qdir=+t[0],e.qnum2=+t[1])})},encodeCellDirecQnum:function(){this.encodeCell(function(e){return-2===e.qnum?"# ":-1!==e.qnum2?[""+e.qdir,",",""+e.qnum2," "].join(""):". "})}},"FileIO@brownies":{decodeData:function(){this.decodeCellQnum2(),this.decodeBorderLine(),this.decodeCellQsubQcmp()},encodeData:function(){this.encodeCellQnum2(),this.encodeBorderLine(),this.encodeCellQsubQcmp()},decodeCellQnum2:function(){this.decodeCell(function(e,t){"#"===t?e.qnum=-2:"."!==t&&(e.qnum2=+t)})},encodeCellQnum2:function(){this.encodeCell(function(e){return-2===e.qnum?"# ":-1!==e.qnum2?e.qnum2+" ":". "})}},AnsCheck:{checklist:["checkLineExist+","checkBranchLine","checkCrossLine","checkConnectObject","checkLineOverLetter","checkCurveLine","checkQuesNumber","checkDoubleNumberInNabe","checkFillingCount","checkNoFillingNabe","checkFillingOutOfNabe","checkDisconnectLine"],checkCurveLine:function(){this.checkAllArea(this.board.linegraph,function(e,t,i,n){return 1===e||1===t},"laCurve")},checkQuesNumber:function(){this.checkAllCell(function(e){return!e.ice()&&-1!==e.qnum2},"bnIllegalPos")},checkDoubleNumberInNabe:function(){this.checkAllBlock(this.board.icegraph,function(e){return-1!==e.qnum2},function(e,t,i,n){return i<2},"bkDoubleBn")},checkNoFillingNabe:function(){this.checkNoMovedObjectInRoom(this.board.icegraph)},checkFillingOutOfNabe:function(){this.checkAllCell(function(e){return e.isDestination()&&!e.ice()},"nmOutOfBk")},checkFillingCount:function(){for(var e=this.board.icegraph.components,t=0;t<e.length;t++){for(var i=e[t].clist,n=null,s=0;s<i.length;s++){var r=i[s].qnum2;if(-1!==r){if(null!==n&&n!==r){n=null;break}n=r}}if(null!==n){var o=i.getSumOfFilling();if(0!==o&&n!==o){if(this.failcode.add("bkSumNeBn"),this.checkOnly)break;i.getDeparture().seterr(4),i.seterr(1)}}}}},"AnsCheck@yajisoko":{checklist:["checkBranchLine","checkCrossLine","checkInvalidHasLine","checkConnectObject","checkLineOverLetter","checkCurveLine","checkArrowNumber","checkDisconnectLine","checkNumberHasArrow"],checkArrowNumber:function(){for(var e=this.board,t=0;t<e.cell.length;t++){var i=e.cell[t];if(-1!==i.qnum2&&-2!==i.qnum2&&0!==i.qdir&&1!==i.lcnt){for(var n=i.getaddr(),s=i.qdir,r=new this.klass.CellList;;){n.movedir(s,2);var o=n.getc();if(o.isnull)break;r.add(o)}if(i.qnum2!==r.filter(function(e){return 1===e.lcnt^-1!==e.qnum}).length){if(this.failcode.add("anShadeNe"),this.checkOnly)break;i.seterr(1),r.seterr(1)}}}},checkNumberHasArrow:function(){this.checkAllCell(function(e){return-1!==e.qnum2&&-5!==e.qnum2&&e.qdir===e.NDIR},"anNoArrow")},checkInvalidHasLine:function(){this.checkAllCell(function(e){return-5===e.qnum2&&0<e.lcnt},"laOnBorder")}},"AnsCheck@brownies":{checklist:["checkBranchLine","checkCrossLine","checkInvalidHasLine","checkConnectObject","checkLineOverLetter","checkCurveLine","checkDir8Circle","checkDisconnectLine"],checkDir8Circle:function(){for(var e=0;e<this.board.cell.length;e++){var t=this.board.cell[e],i=t.qnum2;if(!(i<0)){for(var n=0,s=t.getdir8clist(),r=0;r<s.length;r++){var o=s[r][0];1===o.lcnt^-1!==o.qnum&&n++}if(i!==n){if(this.failcode.add("nmCircleNe"),this.checkOnly)break;t.seterr(1)}}}},checkInvalidHasLine:function(){this.checkAllCell(function(e){return-1!==e.qnum2&&0<e.lcnt},"laOnBorder")}},"FailCode@brownies":{nmConnected:"nmConnected.bonsan",laOnNum:"laOnNum.bonsan"}});
//# sourceMappingURL=yosenabe.js.map