/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,o){"object"==typeof module&&module.exports?module.exports=[e,o]:pzpr.classmgr.makeCustom(e,o)}(["heyawake","ayeheya","oneroom","akichi"],{MouseEvent:{RBShadeCell:!0,use:!0,inputModes:{edit:["border","number","clear","info-blk"],play:["shade","unshade","peke","info-blk"]},autoedit_func:"areanum",autoplay_func:"cellpeke"},KeyEvent:{enablemake:!0},Cell:{maxnum:function(){var e,o=this.room.clist.getRectSize(),t=o.cols,o=o.rows;return o<t&&(e=t,t=o,o=e),1===t?o+1>>1:2===t?o:3===t?o%4==0?o/4*5:o%4==1?(o-1)/4*5+2:o%4==2?(o-2)/4*5+3:(o+1)/4*5:Math.log(t+1)/Math.log(2)%1==0&&t===o?(t*o+t+o)/3:1&t&&1&o?(t*o+t+o-1)/3|0:(t*o+t+o-2)/3|0},minnum:0},"Cell@akichi":{maxnum:function(){return this.room.clist.length}},Board:{hasborder:1},"Board@oneroom,akichi":{addExtraInfo:function(){this.unshrgraph=this.addInfoList(this.klass.AreaUnshadeRoomGraph)}},AreaUnshadeGraph:{enabled:!0},AreaRoomGraph:{enabled:!0,hastop:!0,allborderlist:null,setExtraData:function(e){this.common.setExtraData.call(this,e),this.allborderlist=null},getAllBorders:function(){if(this.allborderlist)return this.allborderlist;for(var i=this,n=this.components.length,e=0;e<n;e++)this.components[e].id=e;var r={};return this.board.border.each(function(e){var o,t;e&&!e.isnull&&e.isBorder()&&(o=i.getComponentRefs(e.sidecell[0]),t=i.getComponentRefs(e.sidecell[1]),o&&t&&((t=""+(o.id<t.id?o.id*n+t.id:t.id*n+o.id))in r||(r[t]=new i.klass.BorderList),r[t].add(e)))}),this.allborderlist=r}},"AreaUnshadeRoomGraph:AreaUnshadeGraph@oneroom,akichi":{enabled:!0,relation:{"cell.qans":"node","border.ques":"separator"},setComponentRefs:function(e,o){e.unshr=o},getObjNodeList:function(e){return e.unshrnodes},resetObjNodeList:function(e){e.unshrnodes=[]},isedgevalidbylinkobj:function(e){return!e.isBorder()}},Graphic:{gridcolor_type:"LIGHT",enablebcolor:!0,bgcellcolor_func:"qsub1",paint:function(){this.drawBGCells(),this.drawGrid(),this.drawShadedCells(),this.drawQuesNumbers(),this.drawBorders(),this.drawChassis(),this.drawBoxBorders(!1),this.drawPekes(),this.drawTarget()},getBorderColor:function(e){return e.ques?1===e.error?this.errcolor1:this.quescolor:null}},Encode:{decodePzpr:function(e){this.decodeConfig(),this.decodeBorder(),this.decodeRoomNumber16()},encodePzpr:function(e){this.encodeConfig(),this.encodeBorder(),this.encodeRoomNumber16()},decodeKanpen:function(){this.fio.decodeSquareRoom()},encodeKanpen:function(){this.fio.encodeSquareRoom()},decodeConfig:function(){},encodeConfig:function(){},decodeHeyaApp:function(){for(var e=0,o=[],t=this.board,e=0;e<t.cell.length;e++)o[e]=null;for(var i=new this.puzzle.klass.FileIO,n=0,r=this.outbstr.split("/"),e=0;e<t.cell.length;e++)if(null===o[e]){var c=t.cell[e];if(r[n].match(/((\d+)in)?(\d+)x(\d+)$/)){0<RegExp.$2.length&&(c.qnum=+RegExp.$2);for(var s=c.bx,a=s+2*+RegExp.$3-2,d=c.by,h=d+2*+RegExp.$4-2,l=s;l<=a;l+=2)for(var u=d;u<=h;u+=2)o[t.getc(l,u).id]=n}n++}i.rdata2Border(!0,o)},encodeHeyaApp:function(){for(var e=[],o=this.board,t=o.roommgr.components,i=0;i<t.length;i++){var n=t[i].clist.getRectSize(),r=o.getc(n.x1,n.y1).qnum;e.push((0<=r?r+"in":"")+n.cols+"x"+n.rows)}this.outbstr=e.join("/")}},"Encode@akichi":{decodeConfig:function(){this.puzzle.setConfig("akichi_maximum",this.checkpflag("x"))},encodeConfig:function(){this.outpflag=this.puzzle.getConfig("akichi_maximum")?"x":null}},FileIO:{decodeData:function(){this.decodeConfig(),this.decodeAreaRoom(),this.decodeCellQnum(),this.decodeCellAns(),this.decodeBorderLine()},encodeData:function(){this.encodeConfig(),this.encodeAreaRoom(),this.encodeCellQnum(),this.encodeCellAns(),this.encodeBorderLineIfPresent()},decodeConfig:function(){},encodeConfig:function(){},kanpenOpen:function(){this.decodeSquareRoom(),this.decodeCellAns()},kanpenSave:function(){this.encodeSquareRoom(),this.encodeCellAns()},decodeSquareRoom:function(){for(var e,o=this.board,t=[],i=0,n=+this.readLine();i<n&&(e=this.readLine());i++){for(var r=e.split(" "),c=0;c<4;c++)isNaN(r[c])||(r[c]=2*+r[c]+1);""!==r[4]&&(o.getc(r[1],r[0]).qnum=+r[4]),o.cellinside(r[1],r[0],r[3],r[2]).each(function(e){t[e.id]=i})}this.rdata2Border(!0,t),o.roommgr.rebuild()},encodeSquareRoom:function(){var e=this.board,o=(e.roommgr.rebuild(),e.roommgr.components);this.writeLine(o.length);for(var t=0;t<o.length;t++){var i=o[t].clist.getRectSize(),n=o[t].top.qnum;this.writeLine([i.y1>>1,i.x1>>1,i.y2>>1,i.x2>>1,0<=n?""+n:""].join(" "))}},kanpenOpenXML:function(){this.decodeSquareRoom_XMLBoard(),this.decodeCellAns_XMLAnswer()},kanpenSaveXML:function(){this.encodeSquareRoom_XMLBoard(),this.encodeCellAns_XMLAnswer()},decodeSquareRoom_XMLBoard:function(){for(var e=this.xmldoc.querySelectorAll("board area"),o=this.board,t=[],i=0;i<e.length;i++){var n=e[i],r=2*+n.getAttribute("c0")-1,c=2*+n.getAttribute("r0")-1,s=2*+n.getAttribute("c1")-1,a=2*+n.getAttribute("r1")-1,n=+n.getAttribute("n");0<=n&&(o.getc(r,c).qnum=n);for(var d=r;d<=s;d+=2)for(var h=c;h<=a;h+=2)t[o.getc(d,h).id]=i}this.rdata2Border(!0,t),o.roommgr.rebuild()},encodeSquareRoom_XMLBoard:function(){for(var e=this.xmldoc.querySelector("board"),o=this.board,t=(o.roommgr.rebuild(),o.roommgr.components),i=0;i<t.length;i++){var n=t[i].clist.getRectSize(),r=t[i].top.qnum;e.appendChild(this.createXMLNode("area",{r0:1+(n.y1>>1),c0:1+(n.x1>>1),r1:1+(n.y2>>1),c1:1+(n.x2>>1),n:r}))}}},"FileIO@akichi":{decodeConfig:function(){this.decodeConfigFlag("x","akichi_maximum")},encodeConfig:function(){this.encodeConfigFlag("x","akichi_maximum")}},AnsCheck:{checklist:["checkShadeCellExist","checkAdjacentShadeCell","checkConnectUnshadeRB","checkRegionDivided@oneroom","checkFractal@ayeheya","checkShadeCellCount@!akichi","checkAttainedSize@akichi","checkUnshadedSize@akichi","checkOneDoor@oneroom","checkCountinuousUnshadeCell@!oneroom","checkRoomSymm@ayeheya","doneShadingDecided"],checkFractal:function(){var e=this.board.roommgr.components;e:for(var o=0;o<e.length;o++)for(var t=e[o].clist,i=t.getRectSize(),n=i.x1+i.x2,r=i.y1+i.y2,c=0;c<t.length;c++){var s=t[c],a=this.board.getc(n-s.bx,r-s.by);if(s.isShade()!==a.isShade()){if(this.failcode.add("bkNotSymShade"),this.checkOnly)break e;t.seterr(1)}}},checkRoomSymm:function(){var e=this.board.roommgr.components;e:for(var o=0;o<e.length;o++)for(var t=e[o].clist,i=t.getRectSize(),n=i.x1+i.x2,r=i.y1+i.y2,c=0;c<t.length;c++){var s=t[c],s=this.board.getc(n-s.bx,r-s.by);if(s.room!==e[o]){if(this.failcode.add("bkNotSymRoom"),this.checkOnly)break e;t.seterr(1)}}},checkCountinuousUnshadeCell:function(){var e=this.checkOnly;this.checkOnly=!0,this.checkRowsColsPartly(this.isBorderCount,function(e){return e.isShade()},"bkUnshadeConsecGt3"),this.checkOnly=e},isBorderCount:function(e){var o,t,i=e.getRectSize(),n=0,r=this.board;if(i.x1===i.x2)for(o=i.x1,t=i.y1+1;t<=i.y2-1;t+=2)r.getb(o,t).isBorder()&&n++;else if(i.y1===i.y2)for(t=i.y1,o=i.x1+1;o<=i.x2-1;o+=2)r.getb(o,t).isBorder()&&n++;var c=n<=1;return c||e.seterr(1),c}},"AnsCheck@oneroom":{checkRegionDivided:function(){for(var e=this.board.roommgr.components,o=this.board.unshrgraph.components,t=0;t<e.length;t++)e[t].unshrcount=0;for(t=0;t<o.length;t++)o[t].clist[0].room.unshrcount++;for(t=0;t<e.length;t++)if(!(e[t].unshrcount<=1)){if(this.failcode.add("bkSubdivided"),this.checkOnly)break;e[t].clist.filter(function(e){return!e.isShade()}).seterr(1)}},checkOneDoor:function(){var e,o=this.board.roommgr.getAllBorders();for(e in o){var t=o[e].filter(function(e){return!e.sidecell[0].isShade()&&!e.sidecell[1].isShade()});if(!(t.length<=1)){if(this.failcode.add("bdDoorsGt"),this.checkOnly)break;t.each(function(e){e.seterr(1),e.sidecell[0].seterr(1),e.sidecell[1].seterr(1)})}}}},"AnsCheck@akichi":{checkAttainedSize:function(){if(!this.puzzle.getConfig("akichi_maximum")){for(var e=this.board.roommgr.components,o=this.board.unshrgraph.components,t=0;t<e.length;t++)e[t].isMaxFound=e[t].top.qnum<=0;for(t=0;t<o.length;t++){var i=o[t].clist.length;i&&(i>=(i=o[t].clist[0].room).top.qnum&&(i.isMaxFound=!0))}for(t=0;t<e.length;t++)if(!e[t].isMaxFound){if(this.failcode.add("cuRoomLt"),this.checkOnly)break;e[t].clist.seterr(1)}}},checkUnshadedSize:function(){for(var e=this.board.unshrgraph.components,o=0;o<e.length;o++){var t=e[o].clist.length;if(t){var i=e[o].clist[0].room.top.qnum;if(!(i<0||t<=i)){if(this.failcode.add("cuRoomGt"),this.checkOnly)break;e[o].clist.seterr(1)}}}}}});
//# sourceMappingURL=heyawake.js.map