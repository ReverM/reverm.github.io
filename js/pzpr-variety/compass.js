/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,i){"object"==typeof module&&module.exports?module.exports=[e,i]:pzpr.classmgr.makeCustom(e,i)}(["compass","mukkonn"],{MouseEvent:{inputModes:{edit:["clear"],play:["border","subline"]},mouseinput_clear:function(){this.input51_fixed()},mouseinputAutoEdit:function(){this.mousestart&&this.input51()},autoplay_func:"border"},"MouseEvent@mukkonn":{inputModes:{edit:["clear","empty","info-line"],play:["line","peke","info-line"]},autoplay_func:"line"},KeyEvent:{enablemake:!0,keyinput:function(e){this.inputnumber51(e)}},Cell:{dirs51:4,disInputHatena:!0,isNum:function(){return 51===this.ques},maxnum:function(){return this.board.cols*this.board.rows},minnum:0},"Cell@mukkonn":{maxnum:function(){return Math.max(this.board.cols,this.board.rows)-1},getSegmentDir:function(e){for(var i=new this.klass.PieceList,n=this.getaddr().movedir(e,1);;){var r=n.getb();if(!r||r.isnull)break;if(!r.isLine())break;i.add(r),n.movedir(e,2)}return i},noLP:function(e){return this.isEmpty()}},Border:{isQuesBorder:function(){return this.sidecell[0].isEmpty()||this.sidecell[1].isEmpty()}},"Border@mukkonn":{enableLineNG:!0},"CellList@compass":{singleQnumCell:!0},Board:{cols:8,rows:8,hasborder:1},BoardExec:{adjustBoardData2:function(e,i){for(var n=this.board,r=0;r<n.cell.length;r++){var t=n.cell[r];if(51===t.ques){var s=t.qnum,o=t.qnum2,a=t.qnum3,c=t.qnum4;switch(e){case this.FLIPY:t.qnum2=c,t.qnum4=o;break;case this.FLIPX:t.qnum=a,t.qnum3=s;break;case this.TURNR:t.qnum=c,t.qnum2=s,t.qnum3=o,t.qnum4=a;break;case this.TURNL:t.qnum=o,t.qnum2=a,t.qnum3=c,t.qnum4=s}}}}},"AreaRoomGraph@compass":{enabled:!0},"LineGraph@mukkonn":{enabled:!0},Graphic:{gridcolor_type:"DLIGHT",ttcolor:"rgb(255,255,127)",bordercolor_func:"qans",getBGCellColor:function(e){return 7===e.ques?"black":this.getBGCellColor_error1(e)},paint:function(){this.drawBGCells(),this.drawQues51(),"compass"===this.pid?this.drawDashedGrid():(this.drawGrid(),this.drawPekes(),this.drawLines()),this.drawBorders(),this.drawQuesNumbersOn51(),this.drawBorderQsubs(),this.drawChassis(),this.drawTarget()},getBorderColor:function(e){return e.isQuesBorder()?"black":this.getBorderColor_qans(e)},drawQues51:function(){this.drawTargetTriangle(),this.drawSlash51Cells()}},"Graphic@mukkonn":{irowake:!0},Encode:{decodePzpr:function(){this.decodeCompass()},encodePzpr:function(){this.encodeCompass()},decodeCompass:function(){for(var e=0,i=0,n=this.outbstr,r=this.board;i<n.length&&r.cell[e];){var t=r.cell[e],s=n.charAt(i);if("_"===s)t.ques=7,e++,i++;else if("g"<=s&&s<="z")e+=parseInt(s,36)-15,i++;else{t.ques=51;for(var o=1;o<=4;o++){var a=this.readNumber16(n,i);if(-1===a[0]){i++;break}t.setQnumDir(o,-2===a[0]?-1:a[0]),i+=a[1]}e++}}},encodeCompass:function(){for(var e=0,i="",n=this.board,r=0;r<n.cell.length;r++){var t="",s=n.cell[r];if(s.isEmpty())t+="_";else if(51===s.ques)for(var o=1;o<=4;o++){var a=s.getQnumDir(o);-1===a&&(a=-2),t+=this.writeNumber16(a)}else e++;0===e?i+=t:!t&&20!==e||(i+=(15+e).toString(36)+t,e=0)}0<e&&(i+=(15+e).toString(36)),this.outbstr+=i}},FileIO:{decodeData:function(){this.decodeCellCompass(),this.decodeBorderAns()},encodeData:function(){this.encodeCellCompass(),this.encodeBorderAns()},decodeCellCompass:function(){var e=this.board;e.disableInfo(),this.decodeCell(function(e,i){"#"===i?e.ques=7:"."!==i&&(i=i.split(","),e.set51cell(),e.qnum=+i[0],e.qnum2=+i[1],e.qnum3=+i[2],e.qnum4=+i[3])}),e.enableInfo()},encodeCellCompass:function(){this.encodeCell(function(e){return e.isEmpty()?"# ":51===e.ques?e.qnum+","+e.qnum2+","+e.qnum3+","+e.qnum4+" ":". "})}},"FileIO@mukkonn":{decodeData:function(){this.decodeCellCompass(),this.decodeBorderLine()},encodeData:function(){this.encodeCellCompass(),this.encodeBorderLine()}},"AnsCheck@compass":{checklist:["checkNoNumber","checkDirectionSize","checkDoubleNumber","checkBorderDeadend+"],checkDirectionSize:function(){for(var e=this.board.roommgr.components,i=0;i<e.length;i++){var n=e[i],r=n.clist,t=r.getQnumCell();if(!t.isnull)for(var s=r.getRectSize(),o=1;o<=4;o++){var a,c=t.getQnumDir(o);if(!(c<0)){switch(o){case t.UP:a=this.board.cellinside(s.x1,s.y1,s.x2,t.by-1);break;case t.DN:a=this.board.cellinside(s.x1,t.by+1,s.x2,s.y2);break;case t.RT:a=this.board.cellinside(t.bx+1,s.y1,s.x2,s.y2);break;case t.LT:a=this.board.cellinside(s.x1,s.y1,t.bx-1,s.y2)}if((a=a.filter(function(e){return e.room===n})).length!==c){if(this.failcode.add("ceDirection"),this.checkOnly)return;t.seterr(1),a.seterr(1)}}}}}},"AnsCheck@mukkonn":{checklist:["checkBranchLine","checkCrossLine","checkNumberExit","checkDeadendLine+","checkOneLoop","checkNoLine+"],checkNumberExit:function(){for(var e=0;e<this.board.cell.length;e++){var i=this.board.cell[e];if(i.isNum())for(var n=1;n<=4;n++){var r=i.getQnumDir(n);if(!(r<0)&&i.reldirbd(n,1).isLine()){var t=i.getSegmentDir(n);if(t&&t.length!==r&&(!(t.length<r)||i.getaddr().movedir(n,2*t.length).getc().isLineCurve())){if(this.failcode.add("ceDirection"),this.checkOnly)return;this.board.border.setnoerr(),i.seterr(1),t.seterr(1)}}}}}}});
//# sourceMappingURL=compass.js.map