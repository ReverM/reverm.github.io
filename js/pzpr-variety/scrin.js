/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["scrin","antmill"],{MouseEvent:{use:!0,inputModes:{edit:["number","clear"],play:["shade","unshade"]},autoedit_func:"qnum",autoplay_func:"cell"},"MouseEvent@antmill":{inputModes:{edit:["mark-rect","mark-cross","clear"],play:["shade","unshade"]},shadeCount:0,mousereset:function(){this.shadeCount=0,this.common.mousereset.call(this)},mouseinput_other:function(){switch(this.inputMode){case"mark-rect":this.inputFixedNumber(1);break;case"mark-cross":this.inputFixedNumber(2)}},mouseinput_clear:function(){this.inputFixedNumber(0)},inputFixedNumber:function(e){var t=this.getpos(.33),i=t.getb();t.isinside()&&!i.isnull&&(t=i.ques,null===this.inputData&&(this.inputData=t===e?0:e),t===e&&0!==this.inputData||(i.setQues(this.inputData),i.draw()))},inputcell:function(){var e=this.getcell();e.isnull||e===this.mouseCell||(this.common.inputcell.call(this),1===this.inputData&&(++this.shadeCount,2<=this.shadeCount&&this.mousereset()))},mouseinput_auto:function(){this.puzzle.playmode?(this.mousestart||this.mousemove)&&this.inputcell():this.puzzle.editmode&&this.mousestart&&this.inputmark_antmill()},inputmark_antmill:function(){var e=this.getpos(.33),t=e.getb();e.isinside()&&!t.isnull&&(e=t.ques,"left"===this.btn?2===e?t.setQues(0):t.setQues(e+1):"right"===this.btn&&(0===e?t.setQues(2):t.setQues(e-1)),t.draw())}},"KeyEvent@scrin":{enablemake:!0},"Room:BoardPiece":{group:"room",top:null,getBottomCell:function(){for(var e=this.top.sblk.clist,t=null,i=0,s=0,n=0;n<e.length;n++){var o=e[n];o.bx<i||o.bx===i&&o.by<=s||(i=(t=o).bx,s=o.by)}return t},seterr:function(e){this.top.sblk.clist.seterr(e)},isRoom:function(){if(this.top.isnull)return!1;var e=this.top.sblk;return!!e&&this.top.id===e.clist.getTopCell().id},isRectangle:function(){if(!this.isRoom())return!1;var e=this.top.sblk.clist,t=e.getRectSize();return t.cols*t.rows===e.length},countConn:function(){if(!this.isRectangle())return 0;for(var e=this.top,t=this.getBottomCell(),i=this.board,s=[i.getx(e.bx-1,e.by-1),i.getx(t.bx+1,e.by-1),i.getx(e.bx-1,t.by+1),i.getx(t.bx+1,t.by+1)],n=0,o=0;o<s.length;o++)s[o].isCheckerboard()&&n++;return n}},Cross:{isCheckerboard:function(){var e=this.board,t=this.bx,i=this.by;if(t<=e.minbx||t>=e.maxbx||i<=e.minby||i>=e.maxby)return!1;e=[e.getc(t-1,i-1),e.getc(t-1,i+1),e.getc(t+1,i+1),e.getc(t+1,i-1)],t=[e[0].isShade(),e[1].isShade(),e[2].isShade(),e[3].isShade()];return!(!t[0]||!t[2]||t[1]||t[3])||!(t[0]||t[2]||!t[1]||!t[3])}},Cell:{maxnum:function(){return(this.board.cols-2)*(this.board.rows-2)},minnum:1,setQsub:function(e){-1===this.qnum&&this.common.setQsub.call(this,e)},getRoom:function(){return this.sblk?this.board.room[this.sblk.clist.getTopCell().id]:null},get8clist:function(){for(var e=[],t=-2;t<=2;t++)for(var i,s=-2;s<=2;s++)0===t&&0===s||((i=this.board.getc(this.bx+t,this.by+s)).isnull||"cell"!==i.group||e.push(i));return e}},Border:{hascross:2},"Border@scrin":{isLine:function(){return this.sidecell[0].isShade()!==this.sidecell[1].isShade()}},Board:{hasborder:2,hascross:1,borderAsLine:!0,room:[],addExtraInfo:function(){this.sdblkmgr=this.addInfoList(this.klass.AreaDiagShadeGraph)},createExtraObject:function(){this.room=[]},initExtraObject:function(e,t){this.room=[];for(var i=0;i<this.cell.length;i++){this.room[i]=new this.klass.Room;var s=this.room[i];s.id=i,s.top=this.cell[i],s.isnull=!1}}},"Board@antmill":{hasborder:1},BoardExec:{adjustBoardData2:function(e,t){this.board.createExtraObject(),this.board.initExtraObject(this.board.cols,this.board.rows)}},AreaShadeGraph:{enabled:!0},AreaUnshadeGraph:{enabled:!0},"AreaDiagShadeGraph:AreaGraphBase":{enabled:!0,relation:{"cell.qans":"node"},setComponentRefs:function(e,t){e.sdblk=t},getObjNodeList:function(e){return e.sdblknodes},resetObjNodeList:function(e){e.sdblknodes=[]},isnodevalid:function(e){return e.isShade()},isedgevalidbynodeobj:function(e,t){return!0},getSideObjByNodeObj:function(e){for(var t=e.get8clist(),i=[],s=0;s<t.length;s++){var n=t[s];this.isnodevalid(n)&&i.push(n)}return i}},"Graphic@scrin":{hideHatena:!0,gridcolor_type:"DLIGHT",enablebcolor:!0,shadecolor:"rgb(160,255,160)",trialcolor:"rgb(210,210,210)",linetrialcolor:"gray",getLineColor:function(e){if(e.isLine())return e.sidecell[0].error||e.sidecell[1].error?this.errlinecolor:e.sidecell[0].trial||e.sidecell[1].trial?this.linetrialcolor:this.qanscolor},circleratio:[.45,.4],paint:function(){this.drawBGCells(),this.drawShadedCells(),this.drawLines(),this.drawCircledNumbers(),this.drawCrossMarks(),this.drawBaseMarks(),this.drawTarget()},circlestrokecolor_func:"qnum",numbercolor_func:"qnum",circlefillcolor_func:"qnum",drawCrossMarks:function(){for(var e=this.vinc("cell_cross","auto",!0),t=(e.lineWidth=1,.35*this.cw),i=this.range.cells,s=0;s<i.length;s++){var n,o,r=i[s];e.vid="c_cross_"+r.id,1===r.qsub?(n=r.bx*this.bw,o=r.by*this.bh,e.strokeStyle=r.trial?"rgb(192, 192, 192)":this.mbcolor,e.strokeCross(n,o,t)):e.vhide()}}},"Graphic@antmill":{shadecolor:"#444444",bgcellcolor_func:"qsub1",paint:function(){this.drawBGCells(),this.drawShadedCells(),this.drawGrid(),this.drawChassis(),this.drawBorderClues()},drawBorderClues:function(){for(var e=this.vinc("antmill","auto",!0),t=(e.lineWidth=this.lm,.21*this.cw),i=this.range.borders,s=0;s<i.length;s++){var n=i[s],o=n.bx,r=n.by;e.vid="s_square_"+n.id,1===n.ques?(e.strokeStyle=this.quescolor,e.strokeRect(o*this.bw-t,r*this.bh-t,2*t,2*t)):e.vhide(),e.vid="s_cross_"+n.id,2===n.ques?(e.strokeStyle=this.quescolor,e.strokeCross(o*this.bw,r*this.bh,t)):e.vhide()}}},"Encode@scrin":{decodePzpr:function(e){this.decodeNumber16()},encodePzpr:function(e){this.encodeNumber16()}},"FileIO@scrin":{decodeData:function(){this.decodeCellQnum(),this.decodeCellAns()},encodeData:function(){this.encodeCellQnum(),this.encodeCellAns()}},"Encode@antmill":{decodePzpr:function(e){var i=this.board;this.genericDecodeNumber16(i.cell.length-1,function(e,t){e=i.cell[e];e.adjborder.right.isnull||(e.adjborder.right.ques=t/3|0),e.adjborder.bottom.isnull||(e.adjborder.bottom.ques=t%3)})},encodePzpr:function(e){var i=this.board;this.genericEncodeNumber16(i.cell.length-1,function(e){var e=i.cell[e],t=e.adjborder.right.ques,e=e.adjborder.bottom.ques;return t||e?3*t+e:-1})}},"FileIO@antmill":{decodeData:function(){this.decodeBorder(function(e,t){e.ques=+t}),this.decodeCellAns()},encodeData:function(){this.encodeBorder(function(e){return e.ques+" "}),this.encodeCellAns()}},AnsCheck:{checklist:["checkClueShade","checkDoubleNumberShade","checkNumberAndSize","checkRoomRect","checkConnectShadeDiag","checkIsolatedRoom","checkDeadendRoom","checkBranchRoom","checkInnerRect"],checkClueShade:function(){this.checkAllCell(function(e){return e.isNum()&&!e.isShade()},"bkNumUnshade")},checkDoubleNumberShade:function(){this.checkAllBlock(this.board.sblkmgr,function(e){return e.isNum()},function(e,t,i,s){return i<2},"bkNumGe2")},checkNumberAndSize:function(){this.checkAllArea(this.board.sblkmgr,function(e,t,i,s){return s<=0||s===i},"bkSizeNe")},checkRoomRect:function(){this.checkAllRoom(function(e){return!e.isRectangle()},"bkNotRect")},checkConnectShadeDiag:function(){this.checkOneArea(this.board.sdblkmgr,"csdDivide")},checkIsolatedRoom:function(){this.checkAllRoom(function(e){return 0===e.countConn()},"rmIsolated")},checkDeadendRoom:function(){this.checkAllRoom(function(e){return 1===e.countConn()},"rmDeadend")},checkBranchRoom:function(){this.checkAllRoom(function(e){return 2<e.countConn()},"rmBranch")},checkInnerRect:function(){for(var e=this.board,t=e.ublkmgr.components,i=0;i<t.length;i++){var s=t[i].clist,n=s.getRectSize();if(!(n.x1-1<=e.minbx||n.y1-1<=e.minby||n.x2+1>=e.maxbx||n.y2+1>=e.maxby)&&n.cols*n.rows===s.length){if(this.failcode.add("rmRectUnshade"),this.checkOnly)break;s.seterr(1)}}},checkAllRoom:function(e,t){for(var i=0;i<this.board.room.length;i++){var s=this.board.room[i];if(s.isRoom()&&e(s)){if(this.failcode.add(t),this.checkOnly)break;s.seterr(1)}}}},"AnsCheck@antmill":{checklist:["checkShadeCellExist","checkOverShadeCell","checkEqualSideCell","checkBranchRoom","checkSingleShadeCell","checkUnequalSideCell","checkIsolatedRoom","checkDeadendRoom","checkConnectShadeDiag"],checkOverShadeCell:function(){this.checkAllArea(this.board.sblkmgr,function(e,t,i,s){return i<=2},"csGt2")},checkSingleShadeCell:function(){this.checkAllArea(this.board.sblkmgr,function(e,t,i,s){return 2<=i},"csLt2")},checkEqualSideCell:function(){this.checkSideAreaCell(function(e,t,i){return 1===i.ques&&e.isShade()!==t.isShade()},!1,"bdEqual")},checkUnequalSideCell:function(){this.checkSideAreaCell(function(e,t,i){return 2===i.ques&&e.isShade()===t.isShade()},!1,"bdUnequal")}}});
//# sourceMappingURL=scrin.js.map