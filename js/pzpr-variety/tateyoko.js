/*! @license pzpr.js v7f9addbe (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["tateyoko"],{MouseEvent:{inputModes:{edit:["number","shade","clear"]},mouseinput:function(){"shade"===this.inputMode?this.inputBlock():this.common.mouseinput.call(this)},mouseinput_auto:function(){this.puzzle.playmode?this.inputTateyoko():this.puzzle.editmode&&this.mousestart&&this.inputqnum()},clickTateyoko:function(){var e=this.getcell();e.isnull||1===e.ques||(e.setQans(("left"===this.btn?{0:12,12:13,13:0}:{0:13,12:0,13:12})[e.qans]),e.draw())},inputBlock:function(){var e=this.getcell();e.isnull||e===this.mouseCell||(e.setQues(1===e.ques?0:1),e.draw(),this.mouseCell=e)}},KeyEvent:{enablemake:!0,keyinput:function(e){this.key_inputqnum_tateyoko(e)||this.key_inputqnum(e)},key_inputqnum_tateyoko:function(e){var t=this.cursor.getc();return("q"===e||"q1"===e||"q2"===e)&&("q1"===(e="q"===e?1!==t.ques?"q1":"q2":e)?(t.setQues(1),t.setQans(0),4<t.qnum&&t.setQnum(-1)):"q2"===e&&t.setQues(0),(this.prev=t).draw(),!0)}},Cell:{maxnum:function(){var e=this.board;return 1===this.ques?4:Math.max(e.cols,e.rows)},minnum:0},Board:{disable_subclear:!0,addExtraInfo:function(){this.bargraph=this.addInfoList(this.klass.AreaBarGraph)}},BoardExec:{adjustBoardData:function(e,t){if(e&this.TURN)for(var n={0:0,12:13,13:12},s=this.board.cellinside(t.x1,t.y1,t.x2,t.y2),i=0;i<s.length;i++){var r=s[i];r.qans=n[r.qans]}}},"AreaBarGraph:AreaGraphBase":{enabled:!0,relation:{"cell.qans":"node"},setComponentRefs:function(e,t){e.bar=t},getObjNodeList:function(e){return e.barnodes},resetObjNodeList:function(e){e.barnodes=[]},isnodevalid:function(e){return 0<e.qans},isedgevalidbynodeobj:function(e,t){var n=e.getdir(t,2);return n===e.UP||n===e.DN?12===e.qans&&12===t.qans:(n===e.LT||n===e.RT)&&(13===e.qans&&13===t.qans)}},Graphic:{gridcolor_type:"LIGHT",fontShadecolor:"white",paint:function(){this.drawBGCells(),this.drawDashedGrid(),this.drawTateyokos(),this.drawShadeAtNumber(),this.drawQuesNumbers(),this.drawChassis(),this.drawTarget()},drawShadeAtNumber:function(){for(var e=this.vinc("cell_bcells","crispEdges",!0),t=this.range.cells,n=0;n<t.length;n++){var s=t[n];e.vid="c_full_"+s.id,1===s.ques?(e.fillStyle=1===s.error?this.errcolor1:this.quescolor,e.fillRectCenter(s.bx*this.bw,s.by*this.bh,this.bw+.5,this.bh+.5)):e.vhide()}},getQuesNumberColor:function(e){return 1!==e.ques?this.quescolor:this.fontShadecolor}},Encode:{decodePzpr:function(e){this.decodeTateyoko()},encodePzpr:function(e){this.encodeTateyoko()},decodeTateyoko:function(){for(var e=0,t=0,n=this.outbstr,s=this.board,t=0;t<n.length;t++){var i=n.charAt(t),r=s.cell[e];if("x"===i?r.ques=1:this.include(i,"o","s")?(r.ques=1,r.qnum=parseInt(i,29)-24):this.include(i,"0","9")||this.include(i,"a","f")?r.qnum=parseInt(i,16):"-"===i?(r.qnum=parseInt(n.substr(t+1,2),16),t+=2):"i"===i&&(e+=parseInt(n.charAt(t+1),16)-1,t++),e++,!s.cell[e])break}this.outbstr=n.substr(t)},encodeTateyoko:function(e){for(var t="",n=0,s=this.board,i=0;i<s.cell.length;i++){var r="",o=s.cell[i].ques,a=s.cell[i].qnum;0===o?-1===a?n++:-2===a?r=".":a<16?r=""+a.toString(16):a<256?r="-"+a.toString(16):(r="",n++):1===o&&(r=0<=a?(a+24).toString(29):"x"),0===n?t+=r:!r&&15!==n||(t+=1===n?"n"+r:"i"+n.toString(16)+r,n=0)}1===n?t+="n":1<n&&(t+="i"+n.toString(16)),this.outbstr+=t}},FileIO:{decodeData:function(){this.decodeCell(function(e,t){"a"<=t&&t<="f"?(e.ques=1,e.qnum={a:1,b:2,c:3,d:4,e:0,f:-1}[t]):"?"===t?e.qnum=-2:"."!==t&&(e.qnum=+t)}),this.decodeCell(function(e,t){"1"===t?e.qans=12:"2"===t&&(e.qans=13)})},encodeData:function(){this.encodeCell(function(e){return 1===e.ques?-1===e.qnum||-2===e.qnum?"f ":{0:"e ",1:"a ",2:"b ",3:"c ",4:"d "}[e.qnum]:-2===e.qnum?"? ":0<=e.qnum?e.qnum+" ":". "}),this.encodeCell(function(e){if(1!==e.ques){if(0===e.qans)return"0 ";if(12===e.qans)return"1 ";if(13===e.qans)return"2 "}return". "})}},AnsCheck:{checklist:["checkBarOverNum","checkDoubleNumberInBar","checkSizeAndNumberInBar","checkBarLessNum","checkEmptyCell_tateyoko+"],checkDoubleNumberInBar:function(){var e=this.board.cell,t=this.failcode.length;this.checkAllBlock(this.board.bargraph,function(e){return e.isNum()},function(e,t,n,s){return n<2},"baPlNum"),t!==this.failcode.length&&e.setnoerr()},checkSizeAndNumberInBar:function(){var e=this.board.cell,t=this.failcode.length;this.checkAllArea(this.board.bargraph,function(e,t,n,s){return s<=0||s===n},"bkSizeNe"),t!==this.failcode.length&&e.setnoerr()},checkBarOverNum:function(){this.checkShade(1,"nmConnBarWrong")},checkBarLessNum:function(){this.checkShade(2,"nmConnBarWrong")},checkShade:function(e,t){for(var n=this.board,s=0;s<n.cell.length;s++){var i=n.cell[s],r=i.qnum;if(!(1!==i.ques||r<0)){var o=0,a=0,u=i.adjacent,c=u.top;if(c.isnull||(12===c.qans?o++:13===c.qans&&a++),(c=u.bottom).isnull||(12===c.qans?o++:13===c.qans&&a++),(c=u.left).isnull||(13===c.qans?o++:12===c.qans&&a++),(c=u.right).isnull||(13===c.qans?o++:12===c.qans&&a++),!(1===e&&r<=4-a&&o<=r||2===e&&r===o)){if(this.failcode.add(t),this.checkOnly)break;i.seterr(1)}}}},checkEmptyCell_tateyoko:function(){this.checkAllCell(function(e){return 0===e.ques&&0===e.qans},"ceNoBar")}}});
//# sourceMappingURL=tateyoko.js.map